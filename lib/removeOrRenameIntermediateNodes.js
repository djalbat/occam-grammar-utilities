"use strict";

var ReducedNode = require("./node/reduced"),
    RepeatedNode = require("./node/repeated"),
    classUtilities = require("./utilities/class"),
    ruleNameUtilities = require("./utilities/ruleName");

var isInstanceOf = classUtilities.isInstanceOf,
    ruleNameFromReducedRuleName = ruleNameUtilities.ruleNameFromReducedRuleName,
    checkReducedRuleNameMatchesRuleName = ruleNameUtilities.checkReducedRuleNameMatchesRuleName;

function removeOrRenameIntermediateNodes(node) {
  removeOrRenameReducedNodes(node);
  removeRepeatedNodes(node);
}

module.exports = removeOrRenameIntermediateNodes;

function removeRepeatedNodes(node) {
  var nodeNonTerminalNode = node.isNonTerminalNode();

  if (nodeNonTerminalNode) {
    var nonTerminalNode = node; ///

    var childNodes = nonTerminalNode.getChildNodes();
    childNodes = removeRepeatedChildNodes(childNodes);
    nonTerminalNode.setChildNodes(childNodes);
  }
}

function removeRepeatedChildNodes(childNodes) {
  childNodes = childNodes.reduce(function (childNodes, childNode) {
    var childNodeRepeatedNode = isInstanceOf(childNode, RepeatedNode);

    if (childNodeRepeatedNode) {
      var childNodeChildNodes = childNode.getChildNodes();
      childNodeChildNodes = removeRepeatedChildNodes(childNodeChildNodes);
      childNodes = childNodes.concat(childNodeChildNodes);
    } else {
      removeRepeatedNodes(childNode);
      childNodes.push(childNode);
    }

    return childNodes;
  }, []);
  return childNodes;
}

function removeOrRenameReducedNodes(node) {
  var nodeNonTerminalNode = node.isNonTerminalNode();

  if (nodeNonTerminalNode) {
    var nonTerminalNode = node,
        ///
    ruleName = nonTerminalNode.getRuleName();
    var childNodes = nonTerminalNode.getChildNodes();
    childNodes = removeOrRenameReducedChildNodes(childNodes, ruleName);
    nonTerminalNode.setChildNodes(childNodes);
  }
}

function removeOrRenameReducedChildNodes(childNodes, ruleName) {
  var childNodesLength = childNodes.length;
  childNodes = childNodes.reduce(function (childNodes, childNode) {
    var childNodeReducedNode = isInstanceOf(childNode, ReducedNode);

    if (childNodeReducedNode) {
      var reducedNode = childNode,
          ///
      reducedNodeRuleName = reducedNode.getRuleName(),
          reducedRuleName = reducedNodeRuleName,
          ///
      reducedRuleNameMatchesRuleName = checkReducedRuleNameMatchesRuleName(reducedRuleName, ruleName);

      if (reducedRuleNameMatchesRuleName) {
        if (childNodesLength > 1) {
          var _ruleName = ruleNameFromReducedRuleName(reducedRuleName);

          childNode.setRuleName(_ruleName);
          removeOrRenameReducedNodes(childNode);
          childNodes.push(childNode);
        } else {
          var childNodeChildNodes = childNode.getChildNodes();
          childNodeChildNodes = removeOrRenameReducedChildNodes(childNodeChildNodes);
          childNodes = childNodes.concat(childNodeChildNodes);
        }
      } else {
        var _ruleName2 = ruleNameFromReducedRuleName(reducedRuleName);

        childNode.setRuleName(_ruleName2);
        removeOrRenameReducedNodes(childNode);
        childNodes.push(childNode);
      }
    } else {
      removeOrRenameReducedNodes(childNode);
      childNodes.push(childNode);
    }

    return childNodes;
  }, []);
  return childNodes;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlbW92ZU9yUmVuYW1lSW50ZXJtZWRpYXRlTm9kZXMuanMiXSwibmFtZXMiOlsiUmVkdWNlZE5vZGUiLCJyZXF1aXJlIiwiUmVwZWF0ZWROb2RlIiwiY2xhc3NVdGlsaXRpZXMiLCJydWxlTmFtZVV0aWxpdGllcyIsImlzSW5zdGFuY2VPZiIsInJ1bGVOYW1lRnJvbVJlZHVjZWRSdWxlTmFtZSIsImNoZWNrUmVkdWNlZFJ1bGVOYW1lTWF0Y2hlc1J1bGVOYW1lIiwicmVtb3ZlT3JSZW5hbWVJbnRlcm1lZGlhdGVOb2RlcyIsIm5vZGUiLCJyZW1vdmVPclJlbmFtZVJlZHVjZWROb2RlcyIsInJlbW92ZVJlcGVhdGVkTm9kZXMiLCJtb2R1bGUiLCJleHBvcnRzIiwibm9kZU5vblRlcm1pbmFsTm9kZSIsImlzTm9uVGVybWluYWxOb2RlIiwibm9uVGVybWluYWxOb2RlIiwiY2hpbGROb2RlcyIsImdldENoaWxkTm9kZXMiLCJyZW1vdmVSZXBlYXRlZENoaWxkTm9kZXMiLCJzZXRDaGlsZE5vZGVzIiwicmVkdWNlIiwiY2hpbGROb2RlIiwiY2hpbGROb2RlUmVwZWF0ZWROb2RlIiwiY2hpbGROb2RlQ2hpbGROb2RlcyIsImNvbmNhdCIsInB1c2giLCJydWxlTmFtZSIsImdldFJ1bGVOYW1lIiwicmVtb3ZlT3JSZW5hbWVSZWR1Y2VkQ2hpbGROb2RlcyIsImNoaWxkTm9kZXNMZW5ndGgiLCJsZW5ndGgiLCJjaGlsZE5vZGVSZWR1Y2VkTm9kZSIsInJlZHVjZWROb2RlIiwicmVkdWNlZE5vZGVSdWxlTmFtZSIsInJlZHVjZWRSdWxlTmFtZSIsInJlZHVjZWRSdWxlTmFtZU1hdGNoZXNSdWxlTmFtZSIsInNldFJ1bGVOYW1lIl0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQSxJQUFNQSxXQUFXLEdBQUdDLE9BQU8sQ0FBQyxnQkFBRCxDQUEzQjtBQUFBLElBQ01DLFlBQVksR0FBR0QsT0FBTyxDQUFDLGlCQUFELENBRDVCO0FBQUEsSUFFTUUsY0FBYyxHQUFHRixPQUFP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T0EsVUFBUDtBQUNEIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbmNvbnN0IFJlZHVjZWROb2RlID0gcmVxdWlyZShcIi4vbm9kZS9yZWR1Y2VkXCIpLFxuICAgICAgUmVwZWF0ZWROb2RlID0gcmVxdWlyZShcIi4vbm9kZS9yZXBlYXRlZFwiKSxcbiAgICAgIGNsYXNzVXRpbGl0aWVzID0gcmVxdWlyZShcIi4vdXRpbGl0aWVzL2NsYXNzXCIpLFxuICAgICAgcnVsZU5hbWVVdGlsaXRpZXMgPSByZXF1aXJlKFwiLi91dGlsaXRpZXMvcnVsZU5hbWVcIik7XG5cbmNvbnN0IHsgaXNJbnN0YW5jZU9mIH0gPSBjbGFzc1V0aWxpdGllcyxcbiAgICAgIHsgcnVsZU5hbWVGcm9tUmVkdWNlZFJ1bGVOYW1lLCBjaGVja1JlZHVjZWRSdWxlTmFtZU1hdGNoZXNSdWxlTmFtZSB9ID0gcnVsZU5hbWVVdGlsaXRpZXM7XG5cbmZ1bmN0aW9uIHJlbW92ZU9yUmVuYW1lSW50ZXJtZWRpYXRlTm9kZXMobm9kZSkge1xuICByZW1vdmVPclJlbmFtZVJlZHVjZWROb2Rlcyhub2RlKTtcblxuICByZW1vdmVSZXBlYXRlZE5vZGVzKG5vZGUpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHJlbW92ZU9yUmVuYW1lSW50ZXJtZWRpYXRlTm9kZXM7XG5cbmZ1bmN0aW9uIHJlbW92ZVJlcGVhdGVkTm9kZXMobm9kZSkge1xuICBjb25zdCBub2RlTm9uVGVybWluYWxOb2RlID0gbm9kZS5pc05vblRlcm1pbmFsTm9kZSgpO1xuXG4gIGlmIChub2RlTm9uVGVybWluYWxOb2RlKSB7XG4gICAgY29uc3Qgbm9uVGVybWluYWxOb2RlID0gbm9kZTsgLy8vXG5cbiAgICBsZXQgY2hpbGROb2RlcyA9IG5vblRlcm1pbmFsTm9kZS5nZXRDaGlsZE5vZGVzKCk7XG5cbiAgICBjaGlsZE5vZGVzID0gcmVtb3ZlUmVwZWF0ZWRDaGlsZE5vZGVzKGNoaWxkTm9kZXMpO1xuXG4gICAgbm9uVGVybWluYWxOb2RlLnNldENoaWxkTm9kZXMoY2hpbGROb2RlcylcbiAgfVxufVxuXG5mdW5jdGlvbiByZW1vdmVSZXBlYXRlZENoaWxkTm9kZXMoY2hpbGROb2Rlcykge1xuICBjaGlsZE5vZGVzID0gY2hpbGROb2Rlcy5yZWR1Y2UoKGNoaWxkTm9kZXMsIGNoaWxkTm9kZSkgPT4ge1xuICAgIGNvbnN0IGNoaWxkTm9kZVJlcGVhdGVkTm9kZSA9IGlzSW5zdGFuY2VPZihjaGlsZE5vZGUsIFJlcGVhdGVkTm9kZSk7XG5cbiAgICBpZiAoY2hpbGROb2RlUmVwZWF0ZWROb2RlKSB7XG4gICAgICBsZXQgY2hpbGROb2RlQ2hpbGROb2RlcyA9IGNoaWxkTm9kZS5nZXRDaGlsZE5vZGVzKCk7XG5cbiAgICAgIGNoaWxkTm9kZUNoaWxkTm9kZXMgPSByZW1vdmVSZXBlYXRlZENoaWxkTm9kZXMoY2hpbGROb2RlQ2hpbGROb2Rlcyk7XG5cbiAgICAgIGNoaWxkTm9kZXMgPSBjaGlsZE5vZGVzLmNvbmNhdChjaGlsZE5vZGVDaGlsZE5vZGVzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVtb3ZlUmVwZWF0ZWROb2RlcyhjaGlsZE5vZGUpO1xuXG4gICAgICBjaGlsZE5vZGVzLnB1c2goY2hpbGROb2RlKTtcbiAgICB9XG5cbiAgICByZXR1cm4gY2hpbGROb2RlcztcbiAgfSwgW10pO1xuXG4gIHJldHVybiBjaGlsZE5vZGVzO1xufVxuXG5mdW5jdGlvbiByZW1vdmVPclJlbmFtZVJlZHVjZWROb2Rlcyhub2RlKSB7XG4gIGNvbnN0IG5vZGVOb25UZXJtaW5hbE5vZGUgPSBub2RlLmlzTm9uVGVybWluYWxOb2RlKCk7XG5cbiAgaWYgKG5vZGVOb25UZXJtaW5hbE5vZGUpIHtcbiAgICBjb25zdCBub25UZXJtaW5hbE5vZGUgPSBub2RlLCAvLy9cbiAgICAgICAgICBydWxlTmFtZSA9IG5vblRlcm1pbmFsTm9kZS5nZXRSdWxlTmFtZSgpO1xuXG4gICAgbGV0IGNoaWxkTm9kZXMgPSBub25UZXJtaW5hbE5vZGUuZ2V0Q2hpbGROb2RlcygpO1xuXG4gICAgY2hpbGROb2RlcyA9IHJlbW92ZU9yUmVuYW1lUmVkdWNlZENoaWxkTm9kZXMoY2hpbGROb2RlcywgcnVsZU5hbWUpO1xuXG4gICAgbm9uVGVybWluYWxOb2RlLnNldENoaWxkTm9kZXMoY2hpbGROb2RlcylcbiAgfVxufVxuXG5mdW5jdGlvbiByZW1vdmVPclJlbmFtZVJlZHVjZWRDaGlsZE5vZGVzKGNoaWxkTm9kZXMsIHJ1bGVOYW1lKSB7XG4gIGNvbnN0IGNoaWxkTm9kZXNMZW5ndGggPSBjaGlsZE5vZGVzLmxlbmd0aDtcblxuICBjaGlsZE5vZGVzID0gY2hpbGROb2Rlcy5yZWR1Y2UoKGNoaWxkTm9kZXMsIGNoaWxkTm9kZSkgPT4ge1xuICAgIGNvbnN0IGNoaWxkTm9kZVJlZHVjZWROb2RlID0gaXNJbnN0YW5jZU9mKGNoaWxkTm9kZSwgUmVkdWNlZE5vZGUpO1xuXG4gICAgaWYgKGNoaWxkTm9kZVJlZHVjZWROb2RlKSB7XG4gICAgICBjb25zdCByZWR1Y2VkTm9kZSA9IGNoaWxkTm9kZSwgLy8vXG4gICAgICAgICAgICByZWR1Y2VkTm9kZVJ1bGVOYW1lID0gcmVkdWNlZE5vZGUuZ2V0UnVsZU5hbWUoKSxcbiAgICAgICAgICAgIHJlZHVjZWRSdWxlTmFtZSA9IHJlZHVjZWROb2RlUnVsZU5hbWUsICAvLy9cbiAgICAgICAgICAgIHJlZHVjZWRSdWxlTmFtZU1hdGNoZXNSdWxlTmFtZSA9IGNoZWNrUmVkdWNlZFJ1bGVOYW1lTWF0Y2hlc1J1bGVOYW1lKHJlZHVjZWRSdWxlTmFtZSwgcnVsZU5hbWUpO1xuXG4gICAgICBpZiAocmVkdWNlZFJ1bGVOYW1lTWF0Y2hlc1J1bGVOYW1lKSB7XG4gICAgICAgIGlmIChjaGlsZE5vZGVzTGVuZ3RoID4gMSkge1xuICAgICAgICAgIGNvbnN0IHJ1bGVOYW1lID0gcnVsZU5hbWVGcm9tUmVkdWNlZFJ1bGVOYW1lKHJlZHVjZWRSdWxlTmFtZSk7XG5cbiAgICAgICAgICBjaGlsZE5vZGUuc2V0UnVsZU5hbWUocnVsZU5hbWUpO1xuXG4gICAgICAgICAgcmVtb3ZlT3JSZW5hbWVSZWR1Y2VkTm9kZXMoY2hpbGROb2RlKTtcblxuICAgICAgICAgIGNoaWxkTm9kZXMucHVzaChjaGlsZE5vZGUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGxldCBjaGlsZE5vZGVDaGlsZE5vZGVzID0gY2hpbGROb2RlLmdldENoaWxkTm9kZXMoKTtcblxuICAgICAgICAgIGNoaWxkTm9kZUNoaWxkTm9kZXMgPSByZW1vdmVPclJlbmFtZVJlZHVjZWRDaGlsZE5vZGVzKGNoaWxkTm9kZUNoaWxkTm9kZXMpO1xuXG4gICAgICAgICAgY2hpbGROb2RlcyA9IGNoaWxkTm9kZXMuY29uY2F0KGNoaWxkTm9kZUNoaWxkTm9kZXMpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBydWxlTmFtZSA9IHJ1bGVOYW1lRnJvbVJlZHVjZWRSdWxlTmFtZShyZWR1Y2VkUnVsZU5hbWUpO1xuXG4gICAgICAgIGNoaWxkTm9kZS5zZXRSdWxlTmFtZShydWxlTmFtZSk7XG5cbiAgICAgICAgcmVtb3ZlT3JSZW5hbWVSZWR1Y2VkTm9kZXMoY2hpbGROb2RlKTtcblxuICAgICAgICBjaGlsZE5vZGVzLnB1c2goY2hpbGROb2RlKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgcmVtb3ZlT3JSZW5hbWVSZWR1Y2VkTm9kZXMoY2hpbGROb2RlKTtcblxuICAgICAgY2hpbGROb2Rlcy5wdXNoKGNoaWxkTm9kZSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNoaWxkTm9kZXM7XG4gIH0sIFtdKTtcblxuICByZXR1cm4gY2hpbGROb2Rlcztcbn1cbiJdfQ==