"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.default = eliminateLeftRecursion;
var _necessary = require("necessary");
var _reduced = _interopRequireDefault(require("./rule/reduced"));
var _recursive = _interopRequireDefault(require("./definition/recursive"));
var _left = _interopRequireDefault(require("./definition/recursive/left"));
var _directly = _interopRequireDefault(require("./definition/recursive/left/directly"));
var _indirectly = _interopRequireDefault(require("./definition/recursive/left/indirectly"));
var _class = require("./utilities/class");
var _rule = require("./utilities/rule");
function eliminateLeftRecursion(startRule, ruleMap) {
    var rule = startRule, rewrittenRules = [], recursiveDefinitions = [], leftRecursiveDefinitions = [];
    retrieveLeftRecursiveDefinitions(rule, recursiveDefinitions, leftRecursiveDefinitions, ruleMap);
    eliminateIndirectLeftRecursion(leftRecursiveDefinitions, ruleMap);
    eliminateDirectLeftRecursion(rewrittenRules, ruleMap);
    var startRuleName = startRule.getName();
    startRule = ruleMap[startRuleName]; ///
    return startRule;
}
function _arrayLikeToArray(arr, len) {
    if (len == null || len > arr.length) len = arr.length;
    for(var i = 0, arr2 = new Array(len); i < len; i++)arr2[i] = arr[i];
    return arr2;
}
function _arrayWithoutHoles(arr) {
    if (Array.isArray(arr)) return _arrayLikeToArray(arr);
}
function _interopRequireDefault(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
function _iterableToArray(iter) {
    if (typeof Symbol !== "undefined" && iter[Symbol.iterator] != null || iter["@@iterator"] != null) return Array.from(iter);
}
function _nonIterableSpread() {
    throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
}
function _toConsumableArray(arr) {
    return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();
}
function _unsupportedIterableToArray(o, minLen) {
    if (!o) return;
    if (typeof o === "string") return _arrayLikeToArray(o, minLen);
    var n = Object.prototype.toString.call(o).slice(8, -1);
    if (n === "Object" && o.constructor) n = o.constructor.name;
    if (n === "Map" || n === "Set") return Array.from(n);
    if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);
}
var first = _necessary.arrayUtilities.first;
function eliminateDirectLeftRecursion(rewrittenRules, ruleMap) {
    rewrittenRules.forEach(function(rewrittenRule) {
        return rewrittenRule.rewrite(ruleMap);
    });
}
function eliminateIndirectLeftRecursion(leftRecursiveDefinitions, ruleMap) {
    var indirectlyLeftRecursiveDefinitions = leftRecursiveDefinitions.filter(function(leftRecursiveDefinition) {
        var leftRecursiveDefinitionIndirectlyLeftRecursiveDefinition = (0, _class).isInstanceOf(leftRecursiveDefinition, _indirectly.default);
        if (leftRecursiveDefinitionIndirectlyLeftRecursiveDefinition) {
            return true;
        }
    });
    indirectlyLeftRecursiveDefinitions.forEach(function(indirectlyLeftRecursiveDefinition) {
        var implicitlyLeftRecursiveDefinition = indirectlyLeftRecursiveDefinition.getImplicitlyLeftRecursiveDefinition(), indirectlyLeftRecursiveRule = (0, _rule).ruleFromLeftRecursiveDefinition(indirectlyLeftRecursiveDefinition, ruleMap), implicitlyLeftRecursiveRule = (0, _rule).ruleFromLeftRecursiveDefinition(implicitlyLeftRecursiveDefinition, ruleMap), indirectlyLeftRecursiveRuleDirectlyLeftRecursive = (0, _rule).isRuleDirectlyLeftRecursive(indirectlyLeftRecursiveRule), implicitlyLeftRecursiveRuleDirectlyLeftRecursive = (0, _rule).isRuleDirectlyLeftRecursive(implicitlyLeftRecursiveRule);
        if (indirectlyLeftRecursiveRuleDirectlyLeftRecursive && implicitlyLeftRecursiveRuleDirectlyLeftRecursive) {
            var indirectlyLeftRecursiveDefinitionString = indirectlyLeftRecursiveDefinition.asString(), implicitlyLeftRecursiveDefinitionString = implicitlyLeftRecursiveDefinition.asString();
            throw new Error("The rules containing the '".concat(indirectlyLeftRecursiveDefinitionString, "' indirectly left recursive and ").concat(implicitlyLeftRecursiveDefinitionString, " implicitly left recursive definitions are both additionally directly recursive and therefore cannot be rewritten."));
        }
        var rule;
        var directlyLeftRecursiveRule = indirectlyLeftRecursiveRuleDirectlyLeftRecursive ? indirectlyLeftRecursiveRule : implicitlyLeftRecursiveRule, nonDirectlyLeftRecursiveRule = indirectlyLeftRecursiveRuleDirectlyLeftRecursive ? implicitlyLeftRecursiveRule : indirectlyLeftRecursiveRule; ///
        rule = nonDirectlyLeftRecursiveRule; ///
        var ruleName = rule.getName(), reducedRule = _reduced.default.fromRule(rule), reducedRuleName = reducedRule.getName(), leftRecursiveRuleName = ruleName; ///
        ruleMap[reducedRuleName] = reducedRule;
        rule = directlyLeftRecursiveRule; ///
        var _$leftRecursiveDefinitions = leftRecursiveDefinitionsFromRuleAndLeftRecursiveRuleName(rule, leftRecursiveRuleName);
        debugger;
    });
}
function retrieveLeftRecursiveDefinition(rule, definition, recursiveDefinitions, leftRecursiveDefinitions, ruleMap) {
    var recursiveDefinition;
    var ruleName = rule.getName(), definitionRecursiveDefinition = (0, _class).isInstanceOf(definition, _recursive.default);
    if (definitionRecursiveDefinition) {
        recursiveDefinition = definition; ///
    } else {
        var leftRecursiveDefinition = _indirectly.default.fromRuleNameDefinitionAndRecursiveDefinitions(ruleName, definition, recursiveDefinitions) || _directly.default.fromRuleNameAndDefinition(ruleName, definition) || _left.default.fromRuleNameAndDefinition(ruleName, definition);
        if (leftRecursiveDefinition !== null) {
            leftRecursiveDefinitions.push(leftRecursiveDefinition);
            recursiveDefinition = leftRecursiveDefinition; ///
        } else {
            recursiveDefinition = _recursive.default.fromRuleNameAndDefinition(ruleName, definition);
        }
        if (recursiveDefinition !== null) {
            var replacedDefinition = definition, replacementDefinition = recursiveDefinition; ///
            rule.replaceDefinition(replacedDefinition, replacementDefinition);
            var recursiveDefinitionIndirectlyLeftRecursiveDefinition = (0, _class).isInstanceOf(recursiveDefinition, _indirectly.default);
            if (recursiveDefinitionIndirectlyLeftRecursiveDefinition) {
                var indirectlyLeftRecursiveDefinition = recursiveDefinition, implicitlyLeftRecursiveDefinition = indirectlyLeftRecursiveDefinition.getImplicitlyLeftRecursiveDefinition(), leftRecursiveDefinition1 = implicitlyLeftRecursiveDefinition.getLeftRecursiveDefinition(), ruleName1 = implicitlyLeftRecursiveDefinition.getRuleName(), replacedDefinition1 = leftRecursiveDefinition1, replacementDefinition1 = implicitlyLeftRecursiveDefinition; ///
                rule = ruleMap[ruleName1];
                rule.replaceDefinition(replacedDefinition1, replacementDefinition1);
            }
        }
    }
    return recursiveDefinition;
}
function retrieveLeftRecursiveDefinitions(rule, recursiveDefinitions, leftRecursiveDefinitions, ruleMap) {
    var definitions = rule.getDefinitions();
    definitions.forEach(function(definition) {
        var recursiveDefinition = retrieveLeftRecursiveDefinition(rule, definition, recursiveDefinitions, leftRecursiveDefinitions, ruleMap);
        if (recursiveDefinition !== null) {
            var previousRecursiveDefinitions = _toConsumableArray(recursiveDefinitions).concat([
                recursiveDefinition
            ]), previousRecursiveRuleNames = previousRecursiveDefinitions.map(function(previousRecursiveDefinition) {
                var previousRecursiveDefinitionRuleName = previousRecursiveDefinition.getRuleName(), previousRecursiveRuleName = previousRecursiveDefinitionRuleName; ///
                return previousRecursiveRuleName;
            }), recursiveRuleNames = recursiveDefinition.getRecursiveRuleNames();
            recursiveRuleNames.forEach(function(recursiveRuleName) {
                var previousRecursiveRuleNamesIncludesRecursiveRuleName = previousRecursiveRuleNames.includes(recursiveRuleName);
                if (!previousRecursiveRuleNamesIncludesRecursiveRuleName) {
                    var ruleName = recursiveRuleName, _$rule = ruleMap[ruleName] || null; ///
                    if (_$rule !== null) {
                        var _$recursiveDefinitions = previousRecursiveDefinitions; ///
                        retrieveLeftRecursiveDefinitions(_$rule, _$recursiveDefinitions, leftRecursiveDefinitions, ruleMap);
                    }
                }
            });
        }
    });
}
function leftRecursiveDefinitionsFromRuleAndLeftRecursiveRuleName(rule, leftRecursiveRuleName) {
    var definitions = rule.getDefinitions(), leftRecursiveDefinitions = definitions.filter(function(definition) {
        var definitionLeftRecursiveDefinition = (0, _class).isInstanceOf(definition, _left.default);
        if (definitionLeftRecursiveDefinition) {
            var leftRecursiveDefinition = definition, leftRecursiveRuleNames = leftRecursiveDefinition.getLeftRecursiveRuleNames(), firstLeftRecursiveRuleName = first(leftRecursiveRuleNames);
            if (firstLeftRecursiveRuleName === leftRecursiveRuleName) {
                return true;
            }
        }
    });
    return leftRecursiveDefinitions;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9lbGltaW5hdGVMZWZ0UmVjdXJzaW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG5pbXBvcnQgeyBhcnJheVV0aWxpdGllcyB9IGZyb20gXCJuZWNlc3NhcnlcIjtcblxuaW1wb3J0IFJlZHVjZWRSdWxlIGZyb20gXCIuL3J1bGUvcmVkdWNlZFwiO1xuaW1wb3J0IFJlY3Vyc2l2ZURlZmluaXRpb24gZnJvbSBcIi4vZGVmaW5pdGlvbi9yZWN1cnNpdmVcIjtcbmltcG9ydCBMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiBmcm9tIFwiLi9kZWZpbml0aW9uL3JlY3Vyc2l2ZS9sZWZ0XCI7XG5pbXBvcnQgRGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiBmcm9tIFwiLi9kZWZpbml0aW9uL3JlY3Vyc2l2ZS9sZWZ0L2RpcmVjdGx5XCI7XG5pbXBvcnQgSW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uIGZyb20gXCIuL2RlZmluaXRpb24vcmVjdXJzaXZlL2xlZnQvaW5kaXJlY3RseVwiO1xuXG5pbXBvcnQgeyBpc0luc3RhbmNlT2YgfSBmcm9tIFwiLi91dGlsaXRpZXMvY2xhc3NcIjtcbmltcG9ydCB7IGlzUnVsZURpcmVjdGx5TGVmdFJlY3Vyc2l2ZSwgcnVsZUZyb21MZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiB9IGZyb20gXCIuL3V0aWxpdGllcy9ydWxlXCI7XG5cbmNvbnN0IHsgZmlyc3QgfSA9IGFycmF5VXRpbGl0aWVzO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBlbGltaW5hdGVMZWZ0UmVjdXJzaW9uKHN0YXJ0UnVsZSwgcnVsZU1hcCkge1xuICBjb25zdCBydWxlID0gc3RhcnRSdWxlLCAvLy9cbiAgICAgICAgcmV3cml0dGVuUnVsZXMgPSBbXSxcbiAgICAgICAgcmVjdXJzaXZlRGVmaW5pdGlvbnMgPSBbXSxcbiAgICAgICAgbGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zID0gW107XG5cbiAgcmV0cmlldmVMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMocnVsZSwgcmVjdXJzaXZlRGVmaW5pdGlvbnMsIGxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucywgcnVsZU1hcCk7XG5cbiAgZWxpbWluYXRlSW5kaXJlY3RMZWZ0UmVjdXJzaW9uKGxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucywgcnVsZU1hcCk7XG5cbiAgZWxpbWluYXRlRGlyZWN0TGVmdFJlY3Vyc2lvbihyZXdyaXR0ZW5SdWxlcywgcnVsZU1hcCk7XG5cbiAgY29uc3Qgc3RhcnRSdWxlTmFtZSA9IHN0YXJ0UnVsZS5nZXROYW1lKCk7XG5cbiAgc3RhcnRSdWxlID0gcnVsZU1hcFtzdGFydFJ1bGVOYW1lXTsgLy8vXG5cbiAgcmV0dXJuIHN0YXJ0UnVsZTtcbn1cblxuZnVuY3Rpb24gZWxpbWluYXRlRGlyZWN0TGVmdFJlY3Vyc2lvbihyZXdyaXR0ZW5SdWxlcywgcnVsZU1hcCkge1xuICByZXdyaXR0ZW5SdWxlcy5mb3JFYWNoKChyZXdyaXR0ZW5SdWxlKSA9PiByZXdyaXR0ZW5SdWxlLnJld3JpdGUocnVsZU1hcCkpO1xufVxuXG5mdW5jdGlvbiBlbGltaW5hdGVJbmRpcmVjdExlZnRSZWN1cnNpb24obGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zLCBydWxlTWFwKSB7XG4gIGNvbnN0IGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMgPSBsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMuZmlsdGVyKChsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbikgPT4ge1xuICAgIGNvbnN0IGxlZnRSZWN1cnNpdmVEZWZpbml0aW9uSW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uID0gaXNJbnN0YW5jZU9mKGxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCBJbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24pO1xuXG4gICAgaWYgKGxlZnRSZWN1cnNpdmVEZWZpbml0aW9uSW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH0pO1xuXG4gIGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMuZm9yRWFjaCgoaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uKSA9PiB7XG4gICAgY29uc3QgaW1wbGljaXRseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uID0gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLmdldEltcGxpY2l0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbigpLFxuICAgICAgICAgIGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlUnVsZSA9IHJ1bGVGcm9tTGVmdFJlY3Vyc2l2ZURlZmluaXRpb24oaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCBydWxlTWFwKSxcbiAgICAgICAgICBpbXBsaWNpdGx5TGVmdFJlY3Vyc2l2ZVJ1bGUgPSBydWxlRnJvbUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uKGltcGxpY2l0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiwgcnVsZU1hcCksXG4gICAgICAgICAgaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVSdWxlRGlyZWN0bHlMZWZ0UmVjdXJzaXZlID0gaXNSdWxlRGlyZWN0bHlMZWZ0UmVjdXJzaXZlKGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlUnVsZSksXG4gICAgICAgICAgaW1wbGljaXRseUxlZnRSZWN1cnNpdmVSdWxlRGlyZWN0bHlMZWZ0UmVjdXJzaXZlID0gaXNSdWxlRGlyZWN0bHlMZWZ0UmVjdXJzaXZlKGltcGxpY2l0bHlMZWZ0UmVjdXJzaXZlUnVsZSk7XG5cbiAgICBpZiAoaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVSdWxlRGlyZWN0bHlMZWZ0UmVjdXJzaXZlICYmIGltcGxpY2l0bHlMZWZ0UmVjdXJzaXZlUnVsZURpcmVjdGx5TGVmdFJlY3Vyc2l2ZSkge1xuICAgICAgY29uc3QgaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uU3RyaW5nID0gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLmFzU3RyaW5nKCksXG4gICAgICAgICAgICBpbXBsaWNpdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25TdHJpbmcgPSBpbXBsaWNpdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24uYXNTdHJpbmcoKTtcblxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBUaGUgcnVsZXMgY29udGFpbmluZyB0aGUgJyR7aW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uU3RyaW5nfScgaW5kaXJlY3RseSBsZWZ0IHJlY3Vyc2l2ZSBhbmQgJHtpbXBsaWNpdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25TdHJpbmd9IGltcGxpY2l0bHkgbGVmdCByZWN1cnNpdmUgZGVmaW5pdGlvbnMgYXJlIGJvdGggYWRkaXRpb25hbGx5IGRpcmVjdGx5IHJlY3Vyc2l2ZSBhbmQgdGhlcmVmb3JlIGNhbm5vdCBiZSByZXdyaXR0ZW4uYCk7XG4gICAgfVxuXG4gICAgbGV0IHJ1bGU7XG5cbiAgICBjb25zdCBkaXJlY3RseUxlZnRSZWN1cnNpdmVSdWxlID0gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVSdWxlRGlyZWN0bHlMZWZ0UmVjdXJzaXZlID9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZVJ1bGUgOiAvLy9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGltcGxpY2l0bHlMZWZ0UmVjdXJzaXZlUnVsZSwgIC8vL1xuICAgICAgICAgIG5vbkRpcmVjdGx5TGVmdFJlY3Vyc2l2ZVJ1bGUgPSBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZVJ1bGVEaXJlY3RseUxlZnRSZWN1cnNpdmUgP1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGltcGxpY2l0bHlMZWZ0UmVjdXJzaXZlUnVsZSA6ICAvLy9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlUnVsZTsgLy8vXG5cbiAgICBydWxlID0gbm9uRGlyZWN0bHlMZWZ0UmVjdXJzaXZlUnVsZTsgIC8vL1xuXG4gICAgY29uc3QgcnVsZU5hbWUgPSBydWxlLmdldE5hbWUoKSxcbiAgICAgICAgICByZWR1Y2VkUnVsZSA9IFJlZHVjZWRSdWxlLmZyb21SdWxlKHJ1bGUpLFxuICAgICAgICAgIHJlZHVjZWRSdWxlTmFtZSA9IHJlZHVjZWRSdWxlLmdldE5hbWUoKSxcbiAgICAgICAgICBsZWZ0UmVjdXJzaXZlUnVsZU5hbWUgPSBydWxlTmFtZTsgLy8vXG5cbiAgICBydWxlTWFwW3JlZHVjZWRSdWxlTmFtZV0gPSByZWR1Y2VkUnVsZTtcblxuICAgIHJ1bGUgPSBkaXJlY3RseUxlZnRSZWN1cnNpdmVSdWxlOyAvLy9cblxuICAgIGNvbnN0IGxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyA9IGxlZnRSZWN1cnNpdmVEZWZpbml0aW9uc0Zyb21SdWxlQW5kTGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lKHJ1bGUsIGxlZnRSZWN1cnNpdmVSdWxlTmFtZSk7XG5cbiAgICBkZWJ1Z2dlclxuICB9KTtcbn1cblxuZnVuY3Rpb24gcmV0cmlldmVMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbihydWxlLCBkZWZpbml0aW9uLCByZWN1cnNpdmVEZWZpbml0aW9ucywgbGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zLCBydWxlTWFwKSB7XG4gIGxldCByZWN1cnNpdmVEZWZpbml0aW9uO1xuXG4gIGNvbnN0IHJ1bGVOYW1lID0gcnVsZS5nZXROYW1lKCksXG4gICAgICAgIGRlZmluaXRpb25SZWN1cnNpdmVEZWZpbml0aW9uID0gaXNJbnN0YW5jZU9mKGRlZmluaXRpb24sIFJlY3Vyc2l2ZURlZmluaXRpb24pO1xuXG4gIGlmIChkZWZpbml0aW9uUmVjdXJzaXZlRGVmaW5pdGlvbikge1xuICAgIHJlY3Vyc2l2ZURlZmluaXRpb24gPSBkZWZpbml0aW9uOyAvLy9cbiAgfSBlbHNlIHtcbiAgICBjb25zdCBsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiA9IEluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbi5mcm9tUnVsZU5hbWVEZWZpbml0aW9uQW5kUmVjdXJzaXZlRGVmaW5pdGlvbnMocnVsZU5hbWUsIGRlZmluaXRpb24sIHJlY3Vyc2l2ZURlZmluaXRpb25zKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbi5mcm9tUnVsZU5hbWVBbmREZWZpbml0aW9uKHJ1bGVOYW1lLCBkZWZpbml0aW9uKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTGVmdFJlY3Vyc2l2ZURlZmluaXRpb24uZnJvbVJ1bGVOYW1lQW5kRGVmaW5pdGlvbihydWxlTmFtZSwgZGVmaW5pdGlvbik7XG5cbiAgICBpZiAobGVmdFJlY3Vyc2l2ZURlZmluaXRpb24gIT09IG51bGwpIHtcbiAgICAgIGxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucy5wdXNoKGxlZnRSZWN1cnNpdmVEZWZpbml0aW9uKTtcblxuICAgICAgcmVjdXJzaXZlRGVmaW5pdGlvbiA9IGxlZnRSZWN1cnNpdmVEZWZpbml0aW9uOyAgLy8vXG4gICAgfSBlbHNlIHtcbiAgICAgIHJlY3Vyc2l2ZURlZmluaXRpb24gPSBSZWN1cnNpdmVEZWZpbml0aW9uLmZyb21SdWxlTmFtZUFuZERlZmluaXRpb24ocnVsZU5hbWUsIGRlZmluaXRpb24pO1xuICAgIH1cblxuICAgIGlmIChyZWN1cnNpdmVEZWZpbml0aW9uICE9PSBudWxsKSB7XG4gICAgICBjb25zdCByZXBsYWNlZERlZmluaXRpb24gPSBkZWZpbml0aW9uLCAvLy9cbiAgICAgICAgICAgIHJlcGxhY2VtZW50RGVmaW5pdGlvbiA9IHJlY3Vyc2l2ZURlZmluaXRpb247ICAvLy9cblxuICAgICAgcnVsZS5yZXBsYWNlRGVmaW5pdGlvbihyZXBsYWNlZERlZmluaXRpb24sIHJlcGxhY2VtZW50RGVmaW5pdGlvbik7XG5cbiAgICAgIGNvbnN0IHJlY3Vyc2l2ZURlZmluaXRpb25JbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24gPSBpc0luc3RhbmNlT2YocmVjdXJzaXZlRGVmaW5pdGlvbiwgSW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uKTtcblxuICAgICAgaWYgKHJlY3Vyc2l2ZURlZmluaXRpb25JbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24pIHtcbiAgICAgICAgY29uc3QgaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uID0gcmVjdXJzaXZlRGVmaW5pdGlvbiwgLy8vXG4gICAgICAgICAgICAgIGltcGxpY2l0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiA9IGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbi5nZXRJbXBsaWNpdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24oKSxcbiAgICAgICAgICAgICAgbGVmdFJlY3Vyc2l2ZURlZmluaXRpb24gPSBpbXBsaWNpdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24uZ2V0TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24oKSxcbiAgICAgICAgICAgICAgcnVsZU5hbWUgPSBpbXBsaWNpdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24uZ2V0UnVsZU5hbWUoKSxcbiAgICAgICAgICAgICAgcmVwbGFjZWREZWZpbml0aW9uID0gbGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sIC8vL1xuICAgICAgICAgICAgICByZXBsYWNlbWVudERlZmluaXRpb24gPSBpbXBsaWNpdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb247ICAvLy9cblxuICAgICAgICBydWxlID0gcnVsZU1hcFtydWxlTmFtZV07XG5cbiAgICAgICAgcnVsZS5yZXBsYWNlRGVmaW5pdGlvbihyZXBsYWNlZERlZmluaXRpb24sIHJlcGxhY2VtZW50RGVmaW5pdGlvbik7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHJlY3Vyc2l2ZURlZmluaXRpb247XG59XG5cbmZ1bmN0aW9uIHJldHJpZXZlTGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zKHJ1bGUsIHJlY3Vyc2l2ZURlZmluaXRpb25zLCBsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMsIHJ1bGVNYXApIHtcbiAgY29uc3QgZGVmaW5pdGlvbnMgPSBydWxlLmdldERlZmluaXRpb25zKCk7XG5cbiAgZGVmaW5pdGlvbnMuZm9yRWFjaCgoZGVmaW5pdGlvbikgPT4ge1xuICAgIGNvbnN0IHJlY3Vyc2l2ZURlZmluaXRpb24gPSByZXRyaWV2ZUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uKHJ1bGUsIGRlZmluaXRpb24sIHJlY3Vyc2l2ZURlZmluaXRpb25zLCBsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMsIHJ1bGVNYXApO1xuXG4gICAgaWYgKHJlY3Vyc2l2ZURlZmluaXRpb24gIT09IG51bGwpIHtcbiAgICAgIGNvbnN0IHByZXZpb3VzUmVjdXJzaXZlRGVmaW5pdGlvbnMgPSBbIC4uLnJlY3Vyc2l2ZURlZmluaXRpb25zLCByZWN1cnNpdmVEZWZpbml0aW9uIF0sXG4gICAgICAgICAgICBwcmV2aW91c1JlY3Vyc2l2ZVJ1bGVOYW1lcyA9IHByZXZpb3VzUmVjdXJzaXZlRGVmaW5pdGlvbnMubWFwKChwcmV2aW91c1JlY3Vyc2l2ZURlZmluaXRpb24pID0+IHtcbiAgICAgICAgICAgICAgY29uc3QgcHJldmlvdXNSZWN1cnNpdmVEZWZpbml0aW9uUnVsZU5hbWUgPSBwcmV2aW91c1JlY3Vyc2l2ZURlZmluaXRpb24uZ2V0UnVsZU5hbWUoKSxcbiAgICAgICAgICAgICAgICAgICAgcHJldmlvdXNSZWN1cnNpdmVSdWxlTmFtZSA9IHByZXZpb3VzUmVjdXJzaXZlRGVmaW5pdGlvblJ1bGVOYW1lOyAgLy8vXG5cbiAgICAgICAgICAgICAgcmV0dXJuIHByZXZpb3VzUmVjdXJzaXZlUnVsZU5hbWU7XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIHJlY3Vyc2l2ZVJ1bGVOYW1lcyA9IHJlY3Vyc2l2ZURlZmluaXRpb24uZ2V0UmVjdXJzaXZlUnVsZU5hbWVzKCk7XG5cbiAgICAgIHJlY3Vyc2l2ZVJ1bGVOYW1lcy5mb3JFYWNoKChyZWN1cnNpdmVSdWxlTmFtZSkgPT4ge1xuICAgICAgICBjb25zdCBwcmV2aW91c1JlY3Vyc2l2ZVJ1bGVOYW1lc0luY2x1ZGVzUmVjdXJzaXZlUnVsZU5hbWUgPSBwcmV2aW91c1JlY3Vyc2l2ZVJ1bGVOYW1lcy5pbmNsdWRlcyhyZWN1cnNpdmVSdWxlTmFtZSk7XG5cbiAgICAgICAgaWYgKCFwcmV2aW91c1JlY3Vyc2l2ZVJ1bGVOYW1lc0luY2x1ZGVzUmVjdXJzaXZlUnVsZU5hbWUpIHtcbiAgICAgICAgICBjb25zdCBydWxlTmFtZSA9IHJlY3Vyc2l2ZVJ1bGVOYW1lLCAgLy8vXG4gICAgICAgICAgICAgICAgcnVsZSA9IHJ1bGVNYXBbcnVsZU5hbWVdIHx8IG51bGw7IC8vL1xuXG4gICAgICAgICAgaWYgKHJ1bGUgIT09IG51bGwpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlY3Vyc2l2ZURlZmluaXRpb25zID0gcHJldmlvdXNSZWN1cnNpdmVEZWZpbml0aW9uczsgIC8vL1xuXG4gICAgICAgICAgICByZXRyaWV2ZUxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyhydWxlLCByZWN1cnNpdmVEZWZpbml0aW9ucywgbGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zLCBydWxlTWFwKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGxlZnRSZWN1cnNpdmVEZWZpbml0aW9uc0Zyb21SdWxlQW5kTGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lKHJ1bGUsIGxlZnRSZWN1cnNpdmVSdWxlTmFtZSkge1xuICBjb25zdCBkZWZpbml0aW9ucyA9IHJ1bGUuZ2V0RGVmaW5pdGlvbnMoKSxcbiAgICAgICAgbGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zID0gZGVmaW5pdGlvbnMuZmlsdGVyKChkZWZpbml0aW9uKSA9PiB7XG4gICAgICAgICAgY29uc3QgZGVmaW5pdGlvbkxlZnRSZWN1cnNpdmVEZWZpbml0aW9uID0gaXNJbnN0YW5jZU9mKGRlZmluaXRpb24sIExlZnRSZWN1cnNpdmVEZWZpbml0aW9uKTtcblxuICAgICAgICAgIGlmIChkZWZpbml0aW9uTGVmdFJlY3Vyc2l2ZURlZmluaXRpb24pIHtcbiAgICAgICAgICAgIGNvbnN0IGxlZnRSZWN1cnNpdmVEZWZpbml0aW9uID0gZGVmaW5pdGlvbiwgLy8vXG4gICAgICAgICAgICAgICAgICBsZWZ0UmVjdXJzaXZlUnVsZU5hbWVzID0gbGVmdFJlY3Vyc2l2ZURlZmluaXRpb24uZ2V0TGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lcygpLFxuICAgICAgICAgICAgICAgICAgZmlyc3RMZWZ0UmVjdXJzaXZlUnVsZU5hbWUgPSBmaXJzdChsZWZ0UmVjdXJzaXZlUnVsZU5hbWVzKTtcblxuICAgICAgICAgICAgaWYgKGZpcnN0TGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lID09PSBsZWZ0UmVjdXJzaXZlUnVsZU5hbWUpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICByZXR1cm4gbGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zO1xufVxuXG4iXSwibmFtZXMiOlsiZWxpbWluYXRlTGVmdFJlY3Vyc2lvbiIsInN0YXJ0UnVsZSIsInJ1bGVNYXAiLCJydWxlIiwicmV3cml0dGVuUnVsZXMiLCJyZWN1cnNpdmVEZWZpbml0aW9ucyIsImxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyIsInJldHJpZXZlTGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zIiwiZWxpbWluYXRlSW5kaXJlY3RMZWZ0UmVjdXJzaW9uIiwiZWxpbWluYXRlRGlyZWN0TGVmdFJlY3Vyc2lvbiIsInN0YXJ0UnVsZU5hbWUiLCJnZXROYW1lIiwiZmlyc3QiLCJhcnJheVV0aWxpdGllcyIsImZvckVhY2giLCJyZXdyaXR0ZW5SdWxlIiwicmV3cml0ZSIsImluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMiLCJmaWx0ZXIiLCJsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiIsImxlZnRSZWN1cnNpdmVEZWZpbml0aW9uSW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uIiwiaXNJbnN0YW5jZU9mIiwiSW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uIiwiaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uIiwiaW1wbGljaXRseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uIiwiZ2V0SW1wbGljaXRseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uIiwiaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVSdWxlIiwicnVsZUZyb21MZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiIsImltcGxpY2l0bHlMZWZ0UmVjdXJzaXZlUnVsZSIsImluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlUnVsZURpcmVjdGx5TGVmdFJlY3Vyc2l2ZSIsImlzUnVsZURpcmVjdGx5TGVmdFJlY3Vyc2l2ZSIsImltcGxpY2l0bHlMZWZ0UmVjdXJzaXZlUnVsZURpcmVjdGx5TGVmdFJlY3Vyc2l2ZSIsImluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvblN0cmluZyIsImFzU3RyaW5nIiwiaW1wbGljaXRseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uU3RyaW5nIiwiRXJyb3IiLCJkaXJlY3RseUxlZnRSZWN1cnNpdmVSdWxlIiwibm9uRGlyZWN0bHlMZWZ0UmVjdXJzaXZlUnVsZSIsInJ1bGVOYW1lIiwicmVkdWNlZFJ1bGUiLCJSZWR1Y2VkUnVsZSIsImZyb21SdWxlIiwicmVkdWNlZFJ1bGVOYW1lIiwibGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lIiwibGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zRnJvbVJ1bGVBbmRMZWZ0UmVjdXJzaXZlUnVsZU5hbWUiLCJyZXRyaWV2ZUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uIiwiZGVmaW5pdGlvbiIsInJlY3Vyc2l2ZURlZmluaXRpb24iLCJkZWZpbml0aW9uUmVjdXJzaXZlRGVmaW5pdGlvbiIsIlJlY3Vyc2l2ZURlZmluaXRpb24iLCJmcm9tUnVsZU5hbWVEZWZpbml0aW9uQW5kUmVjdXJzaXZlRGVmaW5pdGlvbnMiLCJEaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uIiwiZnJvbVJ1bGVOYW1lQW5kRGVmaW5pdGlvbiIsIkxlZnRSZWN1cnNpdmVEZWZpbml0aW9uIiwicHVzaCIsInJlcGxhY2VkRGVmaW5pdGlvbiIsInJlcGxhY2VtZW50RGVmaW5pdGlvbiIsInJlcGxhY2VEZWZpbml0aW9uIiwicmVjdXJzaXZlRGVmaW5pdGlvbkluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiIsImdldExlZnRSZWN1cnNpdmVEZWZpbml0aW9uIiwiZ2V0UnVsZU5hbWUiLCJkZWZpbml0aW9ucyIsImdldERlZmluaXRpb25zIiwicHJldmlvdXNSZWN1cnNpdmVEZWZpbml0aW9ucyIsInByZXZpb3VzUmVjdXJzaXZlUnVsZU5hbWVzIiwibWFwIiwicHJldmlvdXNSZWN1cnNpdmVEZWZpbml0aW9uIiwicHJldmlvdXNSZWN1cnNpdmVEZWZpbml0aW9uUnVsZU5hbWUiLCJwcmV2aW91c1JlY3Vyc2l2ZVJ1bGVOYW1lIiwicmVjdXJzaXZlUnVsZU5hbWVzIiwiZ2V0UmVjdXJzaXZlUnVsZU5hbWVzIiwicmVjdXJzaXZlUnVsZU5hbWUiLCJwcmV2aW91c1JlY3Vyc2l2ZVJ1bGVOYW1lc0luY2x1ZGVzUmVjdXJzaXZlUnVsZU5hbWUiLCJpbmNsdWRlcyIsImRlZmluaXRpb25MZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiIsImxlZnRSZWN1cnNpdmVSdWxlTmFtZXMiLCJnZXRMZWZ0UmVjdXJzaXZlUnVsZU5hbWVzIiwiZmlyc3RMZWZ0UmVjdXJzaXZlUnVsZU5hbWUiXSwibWFwcGluZ3MiOiJBQUFBLFlBQVksQ0FBQzs7OztrQkFlV0Esc0JBQXNCO0FBYmYsSUFBQSxVQUFXLFdBQVgsV0FBVyxDQUFBO0FBRWxC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