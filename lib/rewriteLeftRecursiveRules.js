"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "default", {
    enumerable: true,
    get: function() {
        return rewriteLeftRecursiveRules;
    }
});
var _rewritten = /*#__PURE__*/ _interop_require_default(require("./definition/rewritten"));
var _directedGraph = require("./utilities/directedGraph");
var _path = require("./utilities/path");
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
function rewriteLeftRecursiveRules(ruleMap, directedGraph) {
    var cycles = directedGraph.findCycles(), ruleNames = (0, _directedGraph.ruleNamesFromCycles)(cycles);
    ruleNames.forEach(function(ruleName) {
        var rule = ruleMap[ruleName];
        rewriteRecursiveRule(rule, cycles);
    });
}
function rewriteRecursiveRule(rule, cycles) {
    var ruleName = rule.getName();
    rule.removeAllDefinitions();
    var paths = (0, _path.pathsFromRuleNameAndCycles)(ruleName, cycles), rewrittenDefinition = _rewritten.default.fromRuleName(ruleName), definition = rewrittenDefinition; ///
    rule.addDefinition(definition);
    paths.forEach(function(path) {
        var rewrittenDefinition = _rewritten.default.fromPath(path), definition = rewrittenDefinition; ///
        rule.addDefinition(definition);
    });
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9yZXdyaXRlTGVmdFJlY3Vyc2l2ZVJ1bGVzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG5pbXBvcnQgUmV3cml0dGVuRGVmaW5pdGlvbiBmcm9tIFwiLi9kZWZpbml0aW9uL3Jld3JpdHRlblwiO1xuXG5pbXBvcnQgeyBydWxlTmFtZXNGcm9tQ3ljbGVzIH0gZnJvbSBcIi4vdXRpbGl0aWVzL2RpcmVjdGVkR3JhcGhcIjtcbmltcG9ydCB7IHBhdGhzRnJvbVJ1bGVOYW1lQW5kQ3ljbGVzIH0gZnJvbSBcIi4vdXRpbGl0aWVzL3BhdGhcIjtcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gcmV3cml0ZUxlZnRSZWN1cnNpdmVSdWxlcyhydWxlTWFwLCBkaXJlY3RlZEdyYXBoKSB7XG4gIGNvbnN0IGN5Y2xlcyA9IGRpcmVjdGVkR3JhcGguZmluZEN5Y2xlcygpLFxuICAgICAgICBydWxlTmFtZXMgPSBydWxlTmFtZXNGcm9tQ3ljbGVzKGN5Y2xlcyk7XG5cbiAgcnVsZU5hbWVzLmZvckVhY2goKHJ1bGVOYW1lKSA9PiB7XG4gICAgY29uc3QgcnVsZSA9IHJ1bGVNYXBbcnVsZU5hbWVdO1xuXG4gICAgcmV3cml0ZVJlY3Vyc2l2ZVJ1bGUocnVsZSwgY3ljbGVzKTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIHJld3JpdGVSZWN1cnNpdmVSdWxlKHJ1bGUsIGN5Y2xlcykge1xuICBjb25zdCBydWxlTmFtZSA9IHJ1bGUuZ2V0TmFtZSgpO1xuXG4gIHJ1bGUucmVtb3ZlQWxsRGVmaW5pdGlvbnMoKTtcblxuICBjb25zdCBwYXRocyA9IHBhdGhzRnJvbVJ1bGVOYW1lQW5kQ3ljbGVzKHJ1bGVOYW1lLCBjeWNsZXMpLFxuICAgICAgICByZXdyaXR0ZW5EZWZpbml0aW9uID0gUmV3cml0dGVuRGVmaW5pdGlvbi5mcm9tUnVsZU5hbWUocnVsZU5hbWUpLFxuICAgICAgICBkZWZpbml0aW9uID0gcmV3cml0dGVuRGVmaW5pdGlvbjsgLy8vXG5cbiAgcnVsZS5hZGREZWZpbml0aW9uKGRlZmluaXRpb24pO1xuXG4gIHBhdGhzLmZvckVhY2goKHBhdGgpID0+IHtcbiAgICBjb25zdCByZXdyaXR0ZW5EZWZpbml0aW9uID0gUmV3cml0dGVuRGVmaW5pdGlvbi5mcm9tUGF0aChwYXRoKSxcbiAgICAgICAgICBkZWZpbml0aW9uID0gcmV3cml0dGVuRGVmaW5pdGlvbjsgLy8vXG5cbiAgICBydWxlLmFkZERlZmluaXRpb24oZGVmaW5pdGlvbik7XG4gIH0pO1xufVxuIl0sIm5hbWVzIjpbInJld3JpdGVMZWZ0UmVjdXJzaXZlUnVsZXMiLCJydWxlTWFwIiwiZGlyZWN0ZWRHcmFwaCIsImN5Y2xlcyIsImZpbmRDeWNsZXMiLCJydWxlTmFtZXMiLCJydWxlTmFtZXNGcm9tQ3ljbGVzIiwiZm9yRWFjaCIsInJ1bGVOYW1lIiwicnVsZSIsInJld3JpdGVSZWN1cnNpdmVSdWxlIiwiZ2V0TmFtZSIsInJlbW92ZUFsbERlZmluaXRpb25zIiwicGF0aHMiLCJwYXRoc0Zyb21SdWxlTmFtZUFuZEN5Y2xlcyIsInJld3JpdHRlbkRlZmluaXRpb24iLCJSZXdyaXR0ZW5EZWZpbml0aW9uIiwiZnJvbVJ1bGVOYW1lIiwiZGVmaW5pdGlvbiIsImFkZERlZmluaXRpb24iLCJwYXRoIiwiZnJvbVBhdGgiXSwibWFwcGluZ3MiOiJBQUFBOzs7OytCQU9BOzs7ZUFBd0JBOzs7Z0VBTFE7NkJBRUk7b0JBQ087Ozs7OztBQUU1QixTQUFTQSwwQkFBMEJDLE9BQU8sRUFBRUMsYUFBYSxFQUFFO0lBQ3hFLElBQU1DLFNBQVNELGNBQWNFLFVBQVUsSUFDakNDLFlBQVlDLElBQUFBLGtDQUFtQixFQUFDSDtJQUV0Q0UsVUFBVUUsT0FBTyxDQUFDLFNBQUNDLFVBQWE7UUFDOUIsSUFBTUMsT0FBT1IsT0FBTyxDQUFDTyxTQUFTO1FBRTlCRSxxQkFBcUJELE1BQU1OO0lBQzdCO0FBQ0Y7QUFFQSxTQUFTTyxxQkFBcUJELElBQUksRUFBRU4sTUFBTSxFQUFFO0lBQzFDLElBQU1LLFdBQVdDLEtBQUtFLE9BQU87SUFFN0JGLEtBQUtHLG9CQUFvQjtJQUV6QixJQUFNQyxRQUFRQyxJQUFBQSxnQ0FBMEIsRUFBQ04sVUFBVUwsU0FDN0NZLHNCQUFzQkMsa0JBQW1CLENBQUNDLFlBQVksQ0FBQ1QsV0FDdkRVLGFBQWFILHFCQUFxQixHQUFHO0lBRTNDTixLQUFLVSxhQUFhLENBQUNEO0lBRW5CTCxNQUFNTixPQUFPLENBQUMsU0FBQ2EsTUFBUztRQUN0QixJQUFNTCxzQkFBc0JDLGtCQUFtQixDQUFDSyxRQUFRLENBQUNELE9BQ25ERixhQUFhSCxxQkFBcUIsR0FBRztRQUUzQ04sS0FBS1UsYUFBYSxDQUFDRDtJQUNyQjtBQUNGIn0=