"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "default", {
    enumerable: true,
    get: function() {
        return rewriteLeftRecursiveRules;
    }
});
var _rewritten = /*#__PURE__*/ _interop_require_default(require("./definition/rewritten"));
var _ruleNames = require("./utilities/ruleNames");
var _path = require("./utilities/path");
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
function rewriteLeftRecursiveRules(ruleMap, directedGraph) {
    var cycles = directedGraph.findCycles(), ruleNames = (0, _ruleNames.ruleNamesFromCycles)(cycles);
    ruleNames.forEach(function(ruleName) {
        var rule = ruleMap[ruleName];
        rewriteRecursiveRule(rule, cycles);
    });
}
function rewriteRecursiveRule(rule, cycles) {
    var ruleName = rule.getName();
    rule.removeAllDefinitions();
    var paths = (0, _path.pathsFromRuleNameAndCycles)(ruleName, cycles), rewrittenDefinition = _rewritten.default.fromRuleName(ruleName), definition = rewrittenDefinition; ///
    rule.addDefinition(definition);
    paths.forEach(function(path) {
        var rewrittenDefinition = _rewritten.default.fromPath(path), definition = rewrittenDefinition; ///
        rule.addDefinition(definition);
    });
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9yZXdyaXRlTGVmdFJlY3Vyc2l2ZVJ1bGVzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG5pbXBvcnQgUmV3cml0dGVuRGVmaW5pdGlvbiBmcm9tIFwiLi9kZWZpbml0aW9uL3Jld3JpdHRlblwiO1xuXG5pbXBvcnQgeyBydWxlTmFtZXNGcm9tQ3ljbGVzIH0gZnJvbSBcIi4vdXRpbGl0aWVzL3J1bGVOYW1lc1wiO1xuaW1wb3J0IHsgcGF0aHNGcm9tUnVsZU5hbWVBbmRDeWNsZXMgfSBmcm9tIFwiLi91dGlsaXRpZXMvcGF0aFwiO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiByZXdyaXRlTGVmdFJlY3Vyc2l2ZVJ1bGVzKHJ1bGVNYXAsIGRpcmVjdGVkR3JhcGgpIHtcbiAgY29uc3QgY3ljbGVzID0gZGlyZWN0ZWRHcmFwaC5maW5kQ3ljbGVzKCksXG4gICAgICAgIHJ1bGVOYW1lcyA9IHJ1bGVOYW1lc0Zyb21DeWNsZXMoY3ljbGVzKTtcblxuICBydWxlTmFtZXMuZm9yRWFjaCgocnVsZU5hbWUpID0+IHtcbiAgICBjb25zdCBydWxlID0gcnVsZU1hcFtydWxlTmFtZV07XG5cbiAgICByZXdyaXRlUmVjdXJzaXZlUnVsZShydWxlLCBjeWNsZXMpO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gcmV3cml0ZVJlY3Vyc2l2ZVJ1bGUocnVsZSwgY3ljbGVzKSB7XG4gIGNvbnN0IHJ1bGVOYW1lID0gcnVsZS5nZXROYW1lKCk7XG5cbiAgcnVsZS5yZW1vdmVBbGxEZWZpbml0aW9ucygpO1xuXG4gIGNvbnN0IHBhdGhzID0gcGF0aHNGcm9tUnVsZU5hbWVBbmRDeWNsZXMocnVsZU5hbWUsIGN5Y2xlcyksXG4gICAgICAgIHJld3JpdHRlbkRlZmluaXRpb24gPSBSZXdyaXR0ZW5EZWZpbml0aW9uLmZyb21SdWxlTmFtZShydWxlTmFtZSksXG4gICAgICAgIGRlZmluaXRpb24gPSByZXdyaXR0ZW5EZWZpbml0aW9uOyAvLy9cblxuICBydWxlLmFkZERlZmluaXRpb24oZGVmaW5pdGlvbik7XG5cbiAgcGF0aHMuZm9yRWFjaCgocGF0aCkgPT4ge1xuICAgIGNvbnN0IHJld3JpdHRlbkRlZmluaXRpb24gPSBSZXdyaXR0ZW5EZWZpbml0aW9uLmZyb21QYXRoKHBhdGgpLFxuICAgICAgICAgIGRlZmluaXRpb24gPSByZXdyaXR0ZW5EZWZpbml0aW9uOyAvLy9cblxuICAgIHJ1bGUuYWRkRGVmaW5pdGlvbihkZWZpbml0aW9uKTtcbiAgfSk7XG59XG4iXSwibmFtZXMiOlsicmV3cml0ZUxlZnRSZWN1cnNpdmVSdWxlcyIsInJ1bGVNYXAiLCJkaXJlY3RlZEdyYXBoIiwiY3ljbGVzIiwiZmluZEN5Y2xlcyIsInJ1bGVOYW1lcyIsInJ1bGVOYW1lc0Zyb21DeWNsZXMiLCJmb3JFYWNoIiwicnVsZU5hbWUiLCJydWxlIiwicmV3cml0ZVJlY3Vyc2l2ZVJ1bGUiLCJnZXROYW1lIiwicmVtb3ZlQWxsRGVmaW5pdGlvbnMiLCJwYXRocyIsInBhdGhzRnJvbVJ1bGVOYW1lQW5kQ3ljbGVzIiwicmV3cml0dGVuRGVmaW5pdGlvbiIsIlJld3JpdHRlbkRlZmluaXRpb24iLCJmcm9tUnVsZU5hbWUiLCJkZWZpbml0aW9uIiwiYWRkRGVmaW5pdGlvbiIsInBhdGgiLCJmcm9tUGF0aCJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7K0JBT0E7OztlQUF3QkE7OztnRUFMUTt5QkFFSTtvQkFDTzs7Ozs7O0FBRTVCLFNBQVNBLDBCQUEwQkMsT0FBTyxFQUFFQyxhQUFhLEVBQUU7SUFDeEUsSUFBTUMsU0FBU0QsY0FBY0UsVUFBVSxJQUNqQ0MsWUFBWUMsSUFBQUEsOEJBQW1CLEVBQUNIO0lBRXRDRSxVQUFVRSxPQUFPLENBQUMsU0FBQ0MsVUFBYTtRQUM5QixJQUFNQyxPQUFPUixPQUFPLENBQUNPLFNBQVM7UUFFOUJFLHFCQUFxQkQsTUFBTU47SUFDN0I7QUFDRjtBQUVBLFNBQVNPLHFCQUFxQkQsSUFBSSxFQUFFTixNQUFNLEVBQUU7SUFDMUMsSUFBTUssV0FBV0MsS0FBS0UsT0FBTztJQUU3QkYsS0FBS0csb0JBQW9CO0lBRXpCLElBQU1DLFFBQVFDLElBQUFBLGdDQUEwQixFQUFDTixVQUFVTCxTQUM3Q1ksc0JBQXNCQyxrQkFBbUIsQ0FBQ0MsWUFBWSxDQUFDVCxXQUN2RFUsYUFBYUgscUJBQXFCLEdBQUc7SUFFM0NOLEtBQUtVLGFBQWEsQ0FBQ0Q7SUFFbkJMLE1BQU1OLE9BQU8sQ0FBQyxTQUFDYSxNQUFTO1FBQ3RCLElBQU1MLHNCQUFzQkMsa0JBQW1CLENBQUNLLFFBQVEsQ0FBQ0QsT0FDbkRGLGFBQWFILHFCQUFxQixHQUFHO1FBRTNDTixLQUFLVSxhQUFhLENBQUNEO0lBQ3JCO0FBQ0YifQ==