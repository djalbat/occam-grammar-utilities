"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "default", {
    enumerable: true,
    get: function() {
        return rewriteLeftRecursiveRules;
    }
});
var _rewritten = /*#__PURE__*/ _interop_require_default(require("./definition/rewritten"));
var _ruleNames = require("./utilities/ruleNames");
var _path = require("./utilities/path");
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
function rewriteLeftRecursiveRules(cycles, ruleMap) {
    var ruleNames = (0, _ruleNames.ruleNamesFromCycles)(cycles);
    ruleNames.forEach(function(ruleName) {
        var rule = ruleMap[ruleName];
        rewriteRecursiveRule(rule, cycles, ruleMap);
    });
}
function rewriteRecursiveRule(rule, cycles, ruleMap) {
    var ruleName = rule.getName();
    rule.removeAllDefinitions();
    var paths = (0, _path.pathsFromRuleNameAndCycles)(ruleName, cycles), rewrittenDefinition = _rewritten.default.fromRuleName(ruleName, ruleMap), definition = rewrittenDefinition; ///
    rule.addDefinition(definition);
    paths.forEach(function(path) {
        var rewrittenDefinition = _rewritten.default.fromPath(path, ruleMap), definition = rewrittenDefinition; ///
        rule.addDefinition(definition);
    });
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9yZXdyaXRlTGVmdFJlY3Vyc2l2ZVJ1bGVzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG5pbXBvcnQgUmV3cml0dGVuRGVmaW5pdGlvbiBmcm9tIFwiLi9kZWZpbml0aW9uL3Jld3JpdHRlblwiO1xuXG5pbXBvcnQgeyBydWxlTmFtZXNGcm9tQ3ljbGVzIH0gZnJvbSBcIi4vdXRpbGl0aWVzL3J1bGVOYW1lc1wiO1xuaW1wb3J0IHsgcGF0aHNGcm9tUnVsZU5hbWVBbmRDeWNsZXMgfSBmcm9tIFwiLi91dGlsaXRpZXMvcGF0aFwiO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiByZXdyaXRlTGVmdFJlY3Vyc2l2ZVJ1bGVzKGN5Y2xlcywgcnVsZU1hcCkge1xuICBjb25zdCBydWxlTmFtZXMgPSBydWxlTmFtZXNGcm9tQ3ljbGVzKGN5Y2xlcyk7XG5cbiAgcnVsZU5hbWVzLmZvckVhY2goKHJ1bGVOYW1lKSA9PiB7XG4gICAgY29uc3QgcnVsZSA9IHJ1bGVNYXBbcnVsZU5hbWVdO1xuXG4gICAgcmV3cml0ZVJlY3Vyc2l2ZVJ1bGUocnVsZSwgY3ljbGVzLCBydWxlTWFwKTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIHJld3JpdGVSZWN1cnNpdmVSdWxlKHJ1bGUsIGN5Y2xlcywgcnVsZU1hcCkge1xuICBjb25zdCBydWxlTmFtZSA9IHJ1bGUuZ2V0TmFtZSgpO1xuXG4gIHJ1bGUucmVtb3ZlQWxsRGVmaW5pdGlvbnMoKTtcblxuICBjb25zdCBwYXRocyA9IHBhdGhzRnJvbVJ1bGVOYW1lQW5kQ3ljbGVzKHJ1bGVOYW1lLCBjeWNsZXMpLFxuICAgICAgICByZXdyaXR0ZW5EZWZpbml0aW9uID0gUmV3cml0dGVuRGVmaW5pdGlvbi5mcm9tUnVsZU5hbWUocnVsZU5hbWUsIHJ1bGVNYXApLFxuICAgICAgICBkZWZpbml0aW9uID0gcmV3cml0dGVuRGVmaW5pdGlvbjsgLy8vXG5cbiAgcnVsZS5hZGREZWZpbml0aW9uKGRlZmluaXRpb24pO1xuXG4gIHBhdGhzLmZvckVhY2goKHBhdGgpID0+IHtcbiAgICBjb25zdCByZXdyaXR0ZW5EZWZpbml0aW9uID0gUmV3cml0dGVuRGVmaW5pdGlvbi5mcm9tUGF0aChwYXRoLCBydWxlTWFwKSxcbiAgICAgICAgICBkZWZpbml0aW9uID0gcmV3cml0dGVuRGVmaW5pdGlvbjsgLy8vXG5cbiAgICBydWxlLmFkZERlZmluaXRpb24oZGVmaW5pdGlvbik7XG4gIH0pO1xufVxuIl0sIm5hbWVzIjpbInJld3JpdGVMZWZ0UmVjdXJzaXZlUnVsZXMiLCJjeWNsZXMiLCJydWxlTWFwIiwicnVsZU5hbWVzIiwicnVsZU5hbWVzRnJvbUN5Y2xlcyIsImZvckVhY2giLCJydWxlTmFtZSIsInJ1bGUiLCJyZXdyaXRlUmVjdXJzaXZlUnVsZSIsImdldE5hbWUiLCJyZW1vdmVBbGxEZWZpbml0aW9ucyIsInBhdGhzIiwicGF0aHNGcm9tUnVsZU5hbWVBbmRDeWNsZXMiLCJyZXdyaXR0ZW5EZWZpbml0aW9uIiwiUmV3cml0dGVuRGVmaW5pdGlvbiIsImZyb21SdWxlTmFtZSIsImRlZmluaXRpb24iLCJhZGREZWZpbml0aW9uIiwicGF0aCIsImZyb21QYXRoIl0sIm1hcHBpbmdzIjoiQUFBQTs7OzsrQkFPQTs7O2VBQXdCQTs7O2dFQUxRO3lCQUVJO29CQUNPOzs7Ozs7QUFFNUIsU0FBU0EsMEJBQTBCQyxNQUFNLEVBQUVDLE9BQU8sRUFBRTtJQUNqRSxJQUFNQyxZQUFZQyxJQUFBQSw4QkFBbUIsRUFBQ0g7SUFFdENFLFVBQVVFLE9BQU8sQ0FBQyxTQUFDQyxVQUFhO1FBQzlCLElBQU1DLE9BQU9MLE9BQU8sQ0FBQ0ksU0FBUztRQUU5QkUscUJBQXFCRCxNQUFNTixRQUFRQztJQUNyQztBQUNGO0FBRUEsU0FBU00scUJBQXFCRCxJQUFJLEVBQUVOLE1BQU0sRUFBRUMsT0FBTyxFQUFFO0lBQ25ELElBQU1JLFdBQVdDLEtBQUtFLE9BQU87SUFFN0JGLEtBQUtHLG9CQUFvQjtJQUV6QixJQUFNQyxRQUFRQyxJQUFBQSxnQ0FBMEIsRUFBQ04sVUFBVUwsU0FDN0NZLHNCQUFzQkMsa0JBQW1CLENBQUNDLFlBQVksQ0FBQ1QsVUFBVUosVUFDakVjLGFBQWFILHFCQUFxQixHQUFHO0lBRTNDTixLQUFLVSxhQUFhLENBQUNEO0lBRW5CTCxNQUFNTixPQUFPLENBQUMsU0FBQ2EsTUFBUztRQUN0QixJQUFNTCxzQkFBc0JDLGtCQUFtQixDQUFDSyxRQUFRLENBQUNELE1BQU1oQixVQUN6RGMsYUFBYUgscUJBQXFCLEdBQUc7UUFFM0NOLEtBQUtVLGFBQWEsQ0FBQ0Q7SUFDckI7QUFDRiJ9