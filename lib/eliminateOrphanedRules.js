'use strict';

var partUtilities = require('./utilities/part');

var ruleNamesFromParts = partUtilities.ruleNamesFromParts;


function eliminateOrphanedRules(rules) {
  var ruleNames = [];

  rules.forEach(function (rule) {
    var definitions = rule.getDefinitions();

    definitions.forEach(function (definition) {
      var parts = definition.getParts();

      ruleNamesFromParts(parts, ruleNames);
    });
  });

  rules = rules.filter(function (rule, index) {
    var ruleName = rule.getName(),
        ruleFirstRule = index === 0,
        ruleNamesIncludesRuleName = ruleNames.includes(ruleName);

    if (ruleFirstRule || ruleNamesIncludesRuleName) {
      return true;
    }
  });

  return rules;
}

module.exports = eliminateOrphanedRules;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL2VzNi9lbGltaW5hdGVPcnBoYW5lZFJ1bGVzLmpzIl0sIm5hbWVzIjpbInBhcnRVdGlsaXRpZXMiLCJyZXF1aXJlIiwicnVsZU5hbWVzRnJvbVBhcnRzIiwiZWxpbWluYXRlT3JwaGFuZWRSdWxlcyIsInJ1bGVzIiwicnVsZU5hbWVzIiwiZm9yRWFjaCIsInJ1bGUiLCJkZWZpbml0aW9ucyIsImdldERlZmluaXRpb25zIiwiZGVmaW5pdGlvbiIsInBhcnRzIiwiZ2V0UGFydHMiLCJmaWx0ZXIiLCJpbmRleCIsInJ1bGVOYW1lIiwiZ2V0TmFtZSIsInJ1bGVGaXJzdFJ1bGUiLCJydWxlTmFtZXNJbmNsdWRlc1J1bGVOYW1lIiwiaW5jbHVkZXMiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQSxJQUFNQSxnQkFBZ0JDLFFBQVEsa0JBQVIsQ0FBdEI7O0lBRVFDLGtCLEdBQXVCRixhLENBQXZCRSxrQjs7O0FBRVIsU0FBU0Msc0JBQVQsQ0FBZ0NDLEtBQWhDLEVBQXVDO0FBQ3JDLE1BQU1DLFlBQVksRUFBbEI7O0FBRUFELFFBQU1FLE9BQU4sQ0FBYyxVQUFTQyxJQUFULEVBQWU7QUFDM0IsUUFBTUMsY0FBY0QsS0FBS0UsY0FBTCxFQUFwQjs7QUFFQUQsZ0JBQVlGLE9BQVosQ0FBb0IsVUFBU0ksVUFBVCxFQUFxQjtBQUN2QyxVQUFNQyxRQUFRRCxXQUFXRSxRQUFYLEVBQWQ7O0FBRUFWLHlCQUFtQlMsS0FBbkIsRUFBMEJOLFNBQTFCO0FBQ0QsS0FKRDtBQUtELEdBUkQ7O0FBVUFELFVBQVFBLE1BQU1TLE1BQU4sQ0FBYSxVQUFTTixJQUFULEVBQWVPLEtBQWYsRUFBc0I7QUFDekMsUUFBTUMsV0FBV1IsS0FBS1MsT0FBTCxFQUFqQjtBQUFBLFFBQ01DLGdCQUFpQkgsVUFBVSxDQURqQztBQUFBLFFBRU1JLDRCQUE0QmIsVUFBVWMsUUFBVixDQUFtQkosUUFBbkIsQ0FGbEM7O0FBSUEsUUFBSUUsaUJBQWlCQyx5QkFBckIsRUFBZ0Q7QUFDOUMsYUFBTyxJQUFQO0FBQ0Q7QUFDRixHQVJPLENBQVI7O0FBVUEsU0FBT2QsS0FBUDtBQUNEOztBQUVEZ0IsT0FBT0MsT0FBUCxHQUFpQmxCLHNCQUFqQiIsImZpbGUiOiJlbGltaW5hdGVPcnBoYW5lZFJ1bGVzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5jb25zdCBwYXJ0VXRpbGl0aWVzID0gcmVxdWlyZSgnLi91dGlsaXRpZXMvcGFydCcpO1xuXG5jb25zdCB7IHJ1bGVOYW1lc0Zyb21QYXJ0cyB9ID0gcGFydFV0aWxpdGllcztcblxuZnVuY3Rpb24gZWxpbWluYXRlT3JwaGFuZWRSdWxlcyhydWxlcykge1xuICBjb25zdCBydWxlTmFtZXMgPSBbXTtcblxuICBydWxlcy5mb3JFYWNoKGZ1bmN0aW9uKHJ1bGUpIHtcbiAgICBjb25zdCBkZWZpbml0aW9ucyA9IHJ1bGUuZ2V0RGVmaW5pdGlvbnMoKTtcblxuICAgIGRlZmluaXRpb25zLmZvckVhY2goZnVuY3Rpb24oZGVmaW5pdGlvbikge1xuICAgICAgY29uc3QgcGFydHMgPSBkZWZpbml0aW9uLmdldFBhcnRzKCk7XG5cbiAgICAgIHJ1bGVOYW1lc0Zyb21QYXJ0cyhwYXJ0cywgcnVsZU5hbWVzKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgcnVsZXMgPSBydWxlcy5maWx0ZXIoZnVuY3Rpb24ocnVsZSwgaW5kZXgpIHtcbiAgICBjb25zdCBydWxlTmFtZSA9IHJ1bGUuZ2V0TmFtZSgpLFxuICAgICAgICAgIHJ1bGVGaXJzdFJ1bGUgPSAoaW5kZXggPT09IDApLFxuICAgICAgICAgIHJ1bGVOYW1lc0luY2x1ZGVzUnVsZU5hbWUgPSBydWxlTmFtZXMuaW5jbHVkZXMocnVsZU5hbWUpO1xuXG4gICAgaWYgKHJ1bGVGaXJzdFJ1bGUgfHwgcnVsZU5hbWVzSW5jbHVkZXNSdWxlTmFtZSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gcnVsZXM7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gZWxpbWluYXRlT3JwaGFuZWRSdWxlcztcbiJdfQ==