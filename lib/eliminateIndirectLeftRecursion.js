"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "default", {
    enumerable: true,
    get: function() {
        return eliminateIndirectLeftRecursion;
    }
});
var _directlyReduced = /*#__PURE__*/ _interopRequireDefault(require("./operation/rule/directlyReduced"));
var _directlyRepeated = /*#__PURE__*/ _interopRequireDefault(require("./operation/rule/directlyRepeated"));
var _implicitlyReduced = /*#__PURE__*/ _interopRequireDefault(require("./operation/rule/implicitlyReduced"));
var _indirectlyReduced = /*#__PURE__*/ _interopRequireDefault(require("./operation/rule/indirectlyReduced"));
var _indirectlyRepeated = /*#__PURE__*/ _interopRequireDefault(require("./operation/rule/indirectlyRepeated"));
var _leftRecursive = /*#__PURE__*/ _interopRequireDefault(require("./operation/definition/leftRecursive"));
var _directlyLeftRecursive = /*#__PURE__*/ _interopRequireDefault(require("./operation/definition/directlyLeftRecursive"));
var _indirectlyLeftRecursive = /*#__PURE__*/ _interopRequireDefault(require("./operation/definition/indirectlyLeftRecursive"));
var _context = require("./utilities/context");
function _interopRequireDefault(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
var count = 0;
var maxCount = Infinity;
function eliminateIndirectLeftRecursion(context) {
    var greatestIndirectlyLeftRecursiveDefinition = count++ >= maxCount ? null : (0, _context.retrieveGreatestIndirectlyLeftRecursiveDefinition)(context);
    while(greatestIndirectlyLeftRecursiveDefinition !== null){
        var indirectlyLeftRecursiveDefinition = greatestIndirectlyLeftRecursiveDefinition; ///
        //       rule = indirectlyLeftRecursiveDefinition.getRule();
        //       directlyLeftRecursiveDefinition = findDirectlyLeftRecursiveDefinition(rule, context);
        //
        // if (directlyLeftRecursiveDefinition !== null) {
        //   rewriteDirectLeftRecursion(directlyLeftRecursiveDefinition, indirectlyLeftRecursiveDefinition, context);
        // } else {
        var depth = indirectlyLeftRecursiveDefinition.getDepth();
        depth > 1 ? reduceIndirectLeftRecursion(indirectlyLeftRecursiveDefinition, context) : rewriteIndirectLeftRecursion(indirectlyLeftRecursiveDefinition, context);
        // }
        greatestIndirectlyLeftRecursiveDefinition = count++ >= maxCount ? null : (0, _context.retrieveGreatestIndirectlyLeftRecursiveDefinition)(context);
    }
}
// function rewriteDirectLeftRecursion(directlyLeftRecursiveDefinition, indirectlyLeftRecursiveDefinition, context) {
//   const allowIsolated = true,
//         directlyReducedRule = DirectlyReducedRuleOperation.execute(directlyLeftRecursiveDefinition, allowIsolated, context),
//         directlyRepeatedRule = DirectlyRepeatedRuleOperation.execute(directlyLeftRecursiveDefinition, context);
//
//   const rule = directlyLeftRecursiveDefinition.getRule();
//
//   let indirectlyLeftRecursiveDefinitions = findIndirectlyLeftRecursiveDefinitions(rule, context);
//
//   const directlyLeftRecursiveDefinitions = findDirectlyLeftRecursiveDefinitions(rule, context),
//         removedLeftRecursiveDefinitions = [
//           ...directlyLeftRecursiveDefinitions,
//           ...indirectlyLeftRecursiveDefinitions
//         ];
//
//   indirectlyLeftRecursiveDefinitions = DirectlyLeftRecursiveDefinitionOperation.execute(directlyLeftRecursiveDefinition, directlyRepeatedRule, directlyReducedRule, context);
//
//   const addedLeftRecursiveDefinitions = indirectlyLeftRecursiveDefinitions; ///
//
//   removeLeftRecursiveDefinitions(removedLeftRecursiveDefinitions, context);
//
//   addLeftRecursiveDefinitions(addedLeftRecursiveDefinitions, context);
// }
function reduceIndirectLeftRecursion(indirectlyLeftRecursiveDefinition, context) {
    var rule = indirectlyLeftRecursiveDefinition.getRule(), definition = indirectlyLeftRecursiveDefinition.getDefinition(), definitions = rule.getDefinitions(), definitionsIncludesDefinition = definitions.includes(definition);
    if (definitionsIncludesDefinition) {
        var indirectlyReducedRule = _indirectlyReduced.default.execute(indirectlyLeftRecursiveDefinition, context), indirectlyRepeatedRule = _indirectlyRepeated.default.execute(indirectlyLeftRecursiveDefinition, context);
        _indirectlyLeftRecursive.default.execute(indirectlyLeftRecursiveDefinition, context);
        var leftRecursiveDefinition = indirectlyLeftRecursiveDefinition.getLeftRecursiveDefinition();
        var leftRecursiveRuleName = indirectlyLeftRecursiveDefinition.getLeftRecursiveRuleName(), indirectlyLeftRecursiveDefinitions = (0, _context.findIndirectlyLeftRecursiveDefinitions)(rule, function(indirectlyLeftRecursiveDefinition) {
            var indirectlyLeftRecursiveDefinitionLeftRecursiveRuleName = indirectlyLeftRecursiveDefinition.getLeftRecursiveRuleName(), indirectlyLeftRecursiveDefinitionLeftRecursiveDefinition = indirectlyLeftRecursiveDefinition.getLeftRecursiveDefinition();
            if (leftRecursiveDefinition === indirectlyLeftRecursiveDefinitionLeftRecursiveDefinition && leftRecursiveRuleName === indirectlyLeftRecursiveDefinitionLeftRecursiveRuleName) {
                return true;
            }
        }, context);
        indirectlyLeftRecursiveDefinition = _leftRecursive.default.execute(indirectlyLeftRecursiveDefinition, indirectlyRepeatedRule, indirectlyReducedRule, context); ///
        var addedLeftRecursiveDefinition = indirectlyLeftRecursiveDefinition, removedLeftRecursiveDefinitions = indirectlyLeftRecursiveDefinitions; ///
        (0, _context.removeLeftRecursiveDefinitions)(removedLeftRecursiveDefinitions, context);
        (0, _context.addLeftRecursiveDefinition)(addedLeftRecursiveDefinition, context);
    } else {
        var removedLeftRecursiveDefinitions1 = [
            indirectlyLeftRecursiveDefinition
        ];
        (0, _context.removeLeftRecursiveDefinitions)(removedLeftRecursiveDefinitions1, context);
    }
}
function rewriteIndirectLeftRecursion(indirectlyLeftRecursiveDefinition, context) {
    var indirectlyReducedRule = _indirectlyReduced.default.execute(indirectlyLeftRecursiveDefinition, context), indirectlyRepeatedRule = _indirectlyRepeated.default.execute(indirectlyLeftRecursiveDefinition, context);
    _indirectlyLeftRecursive.default.execute(indirectlyLeftRecursiveDefinition, context);
    var rule = indirectlyLeftRecursiveDefinition.getRule();
    var leftRecursiveDefinition = indirectlyLeftRecursiveDefinition.getLeftRecursiveDefinition();
    var leftRecursiveRuleName = indirectlyLeftRecursiveDefinition.getLeftRecursiveRuleName(), indirectlyLeftRecursiveDefinitions = (0, _context.findIndirectlyLeftRecursiveDefinitions)(rule, function(indirectlyLeftRecursiveDefinition) {
        var indirectlyLeftRecursiveDefinitionLeftRecursiveRuleName = indirectlyLeftRecursiveDefinition.getLeftRecursiveRuleName(), indirectlyLeftRecursiveDefinitionLeftRecursiveDefinition = indirectlyLeftRecursiveDefinition.getLeftRecursiveDefinition();
        if (leftRecursiveDefinition === indirectlyLeftRecursiveDefinitionLeftRecursiveDefinition && leftRecursiveRuleName === indirectlyLeftRecursiveDefinitionLeftRecursiveRuleName) {
            return true;
        }
    }, context);
    var directlyLeftRecursiveDefinition = _leftRecursive.default.execute(indirectlyLeftRecursiveDefinition, indirectlyRepeatedRule, indirectlyReducedRule, context);
    _implicitlyReduced.default.execute(directlyLeftRecursiveDefinition, rule, context);
    var addedLeftRecursiveDefinition = directlyLeftRecursiveDefinition, removedLeftRecursiveDefinitions = indirectlyLeftRecursiveDefinitions; ///
    (0, _context.removeLeftRecursiveDefinitions)(removedLeftRecursiveDefinitions, context);
    (0, _context.addLeftRecursiveDefinition)(addedLeftRecursiveDefinition, context);
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9lbGltaW5hdGVJbmRpcmVjdExlZnRSZWN1cnNpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbmltcG9ydCBEaXJlY3RseVJlZHVjZWRSdWxlT3BlcmF0aW9uIGZyb20gXCIuL29wZXJhdGlvbi9ydWxlL2RpcmVjdGx5UmVkdWNlZFwiO1xuaW1wb3J0IERpcmVjdGx5UmVwZWF0ZWRSdWxlT3BlcmF0aW9uIGZyb20gXCIuL29wZXJhdGlvbi9ydWxlL2RpcmVjdGx5UmVwZWF0ZWRcIjtcbmltcG9ydCBJbXBsaWNpdGx5UmVkdWNlZFJ1bGVPcGVyYXRpb24gZnJvbSBcIi4vb3BlcmF0aW9uL3J1bGUvaW1wbGljaXRseVJlZHVjZWRcIjtcbmltcG9ydCBJbmRpcmVjdGx5UmVkdWNlZFJ1bGVPcGVyYXRpb24gZnJvbSBcIi4vb3BlcmF0aW9uL3J1bGUvaW5kaXJlY3RseVJlZHVjZWRcIjtcbmltcG9ydCBJbmRpcmVjdGx5UmVwZWF0ZWRSdWxlT3BlcmF0aW9uIGZyb20gXCIuL29wZXJhdGlvbi9ydWxlL2luZGlyZWN0bHlSZXBlYXRlZFwiO1xuaW1wb3J0IExlZnRSZWN1cnNpdmVEZWZpbml0aW9uT3BlcmF0aW9uIGZyb20gXCIuL29wZXJhdGlvbi9kZWZpbml0aW9uL2xlZnRSZWN1cnNpdmVcIjtcbmltcG9ydCBEaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uT3BlcmF0aW9uIGZyb20gXCIuL29wZXJhdGlvbi9kZWZpbml0aW9uL2RpcmVjdGx5TGVmdFJlY3Vyc2l2ZVwiO1xuaW1wb3J0IEluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbk9wZXJhdGlvbiBmcm9tIFwiLi9vcGVyYXRpb24vZGVmaW5pdGlvbi9pbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZVwiO1xuXG5pbXBvcnQgeyBhZGRMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbixcbiAgICAgICAgIGFkZExlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyxcbiAgICAgICAgIHJlbW92ZUxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyxcbiAgICAgICAgIGZpbmREaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLFxuICAgICAgICAgZmluZERpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zLFxuICAgICAgICAgZmluZEluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMsXG4gICAgICAgICByZXRyaWV2ZUdyZWF0ZXN0SW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uIH0gZnJvbSBcIi4vdXRpbGl0aWVzL2NvbnRleHRcIlxuXG5sZXQgY291bnQgPSAwO1xuXG5jb25zdCBtYXhDb3VudCA9IEluZmluaXR5O1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBlbGltaW5hdGVJbmRpcmVjdExlZnRSZWN1cnNpb24oY29udGV4dCkge1xuICBsZXQgZ3JlYXRlc3RJbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24gPSBjb3VudCsrID49IG1heENvdW50ID8gbnVsbCA6IHJldHJpZXZlR3JlYXRlc3RJbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24oY29udGV4dCk7XG5cbiAgd2hpbGUgKGdyZWF0ZXN0SW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uICE9PSBudWxsKSB7XG4gICAgY29uc3QgaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uID0gZ3JlYXRlc3RJbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb247IC8vL1xuICAgIC8vICAgICAgIHJ1bGUgPSBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24uZ2V0UnVsZSgpO1xuICAgIC8vICAgICAgIGRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24gPSBmaW5kRGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbihydWxlLCBjb250ZXh0KTtcbiAgICAvL1xuICAgIC8vIGlmIChkaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uICE9PSBudWxsKSB7XG4gICAgLy8gICByZXdyaXRlRGlyZWN0TGVmdFJlY3Vyc2lvbihkaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sIGNvbnRleHQpO1xuICAgIC8vIH0gZWxzZSB7XG4gICAgY29uc3QgZGVwdGggPSBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24uZ2V0RGVwdGgoKTtcblxuICAgIChkZXB0aCA+IDEpID9cbiAgICAgIHJlZHVjZUluZGlyZWN0TGVmdFJlY3Vyc2lvbihpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sIGNvbnRleHQpIDpcbiAgICAgICAgcmV3cml0ZUluZGlyZWN0TGVmdFJlY3Vyc2lvbihpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sIGNvbnRleHQpO1xuICAgIC8vIH1cblxuICAgIGdyZWF0ZXN0SW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uID0gY291bnQrKyA+PSBtYXhDb3VudCA/IG51bGwgOiByZXRyaWV2ZUdyZWF0ZXN0SW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uKGNvbnRleHQpO1xuICB9XG59XG5cbi8vIGZ1bmN0aW9uIHJld3JpdGVEaXJlY3RMZWZ0UmVjdXJzaW9uKGRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sIGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiwgY29udGV4dCkge1xuLy8gICBjb25zdCBhbGxvd0lzb2xhdGVkID0gdHJ1ZSxcbi8vICAgICAgICAgZGlyZWN0bHlSZWR1Y2VkUnVsZSA9IERpcmVjdGx5UmVkdWNlZFJ1bGVPcGVyYXRpb24uZXhlY3V0ZShkaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCBhbGxvd0lzb2xhdGVkLCBjb250ZXh0KSxcbi8vICAgICAgICAgZGlyZWN0bHlSZXBlYXRlZFJ1bGUgPSBEaXJlY3RseVJlcGVhdGVkUnVsZU9wZXJhdGlvbi5leGVjdXRlKGRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sIGNvbnRleHQpO1xuLy9cbi8vICAgY29uc3QgcnVsZSA9IGRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24uZ2V0UnVsZSgpO1xuLy9cbi8vICAgbGV0IGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMgPSBmaW5kSW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyhydWxlLCBjb250ZXh0KTtcbi8vXG4vLyAgIGNvbnN0IGRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zID0gZmluZERpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zKHJ1bGUsIGNvbnRleHQpLFxuLy8gICAgICAgICByZW1vdmVkTGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zID0gW1xuLy8gICAgICAgICAgIC4uLmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zLFxuLy8gICAgICAgICAgIC4uLmluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnNcbi8vICAgICAgICAgXTtcbi8vXG4vLyAgIGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMgPSBEaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uT3BlcmF0aW9uLmV4ZWN1dGUoZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiwgZGlyZWN0bHlSZXBlYXRlZFJ1bGUsIGRpcmVjdGx5UmVkdWNlZFJ1bGUsIGNvbnRleHQpO1xuLy9cbi8vICAgY29uc3QgYWRkZWRMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMgPSBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zOyAvLy9cbi8vXG4vLyAgIHJlbW92ZUxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyhyZW1vdmVkTGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zLCBjb250ZXh0KTtcbi8vXG4vLyAgIGFkZExlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyhhZGRlZExlZnRSZWN1cnNpdmVEZWZpbml0aW9ucywgY29udGV4dCk7XG4vLyB9XG5cbmZ1bmN0aW9uIHJlZHVjZUluZGlyZWN0TGVmdFJlY3Vyc2lvbihpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sIGNvbnRleHQpIHtcbiAgY29uc3QgcnVsZSA9IGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbi5nZXRSdWxlKCksXG4gICAgICAgIGRlZmluaXRpb24gPSBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24uZ2V0RGVmaW5pdGlvbigpLFxuICAgICAgICBkZWZpbml0aW9ucyA9IHJ1bGUuZ2V0RGVmaW5pdGlvbnMoKSxcbiAgICAgICAgZGVmaW5pdGlvbnNJbmNsdWRlc0RlZmluaXRpb24gPSBkZWZpbml0aW9ucy5pbmNsdWRlcyhkZWZpbml0aW9uKTtcblxuICBpZiAoZGVmaW5pdGlvbnNJbmNsdWRlc0RlZmluaXRpb24pIHtcbiAgICBjb25zdCBpbmRpcmVjdGx5UmVkdWNlZFJ1bGUgPSBJbmRpcmVjdGx5UmVkdWNlZFJ1bGVPcGVyYXRpb24uZXhlY3V0ZShpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sIGNvbnRleHQpLFxuICAgICAgICAgIGluZGlyZWN0bHlSZXBlYXRlZFJ1bGUgPSBJbmRpcmVjdGx5UmVwZWF0ZWRSdWxlT3BlcmF0aW9uLmV4ZWN1dGUoaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCBjb250ZXh0KTtcblxuICAgIEluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbk9wZXJhdGlvbi5leGVjdXRlKGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiwgY29udGV4dCk7XG5cbiAgICBsZXQgbGVmdFJlY3Vyc2l2ZURlZmluaXRpb24gPSBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24uZ2V0TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24oKTtcblxuICAgIGNvbnN0IGxlZnRSZWN1cnNpdmVSdWxlTmFtZSA9IGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbi5nZXRMZWZ0UmVjdXJzaXZlUnVsZU5hbWUoKSxcbiAgICAgICAgICBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zID0gZmluZEluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMocnVsZSwgKGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbikgPT4ge1xuICAgICAgICAgICAgY29uc3QgaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uTGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lID0gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLmdldExlZnRSZWN1cnNpdmVSdWxlTmFtZSgpLFxuICAgICAgICAgICAgICBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25MZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiA9IGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbi5nZXRMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbigpO1xuXG4gICAgICAgICAgICBpZiAoKGxlZnRSZWN1cnNpdmVEZWZpbml0aW9uID09PSBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25MZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbikgJiYgKGxlZnRSZWN1cnNpdmVSdWxlTmFtZSA9PT0gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uTGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lKSkge1xuICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LCBjb250ZXh0KTtcblxuICAgIGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiA9IExlZnRSZWN1cnNpdmVEZWZpbml0aW9uT3BlcmF0aW9uLmV4ZWN1dGUoaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCBpbmRpcmVjdGx5UmVwZWF0ZWRSdWxlLCBpbmRpcmVjdGx5UmVkdWNlZFJ1bGUsIGNvbnRleHQpOyAgLy8vXG5cbiAgICBjb25zdCBhZGRlZExlZnRSZWN1cnNpdmVEZWZpbml0aW9uID0gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCAvLy9cbiAgICAgICAgICByZW1vdmVkTGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zID0gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uczsgLy8vXG5cbiAgICByZW1vdmVMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMocmVtb3ZlZExlZnRSZWN1cnNpdmVEZWZpbml0aW9ucywgY29udGV4dCk7XG5cbiAgICBhZGRMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbihhZGRlZExlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCBjb250ZXh0KTtcbiAgfSBlbHNlIHtcbiAgICBjb25zdCByZW1vdmVkTGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zID0gW1xuICAgICAgaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uXG4gICAgXTtcblxuICAgIHJlbW92ZUxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyhyZW1vdmVkTGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zLCBjb250ZXh0KTtcbiAgfVxufVxuXG5mdW5jdGlvbiByZXdyaXRlSW5kaXJlY3RMZWZ0UmVjdXJzaW9uKGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiwgY29udGV4dCkge1xuICBjb25zdCBpbmRpcmVjdGx5UmVkdWNlZFJ1bGUgPSBJbmRpcmVjdGx5UmVkdWNlZFJ1bGVPcGVyYXRpb24uZXhlY3V0ZShpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sIGNvbnRleHQpLFxuICAgICAgICBpbmRpcmVjdGx5UmVwZWF0ZWRSdWxlID0gSW5kaXJlY3RseVJlcGVhdGVkUnVsZU9wZXJhdGlvbi5leGVjdXRlKGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiwgY29udGV4dCk7XG5cbiAgSW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uT3BlcmF0aW9uLmV4ZWN1dGUoaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCBjb250ZXh0KTtcblxuICBjb25zdCBydWxlID0gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLmdldFJ1bGUoKTtcblxuICBsZXQgbGVmdFJlY3Vyc2l2ZURlZmluaXRpb24gPSBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24uZ2V0TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24oKTtcblxuICBjb25zdCBsZWZ0UmVjdXJzaXZlUnVsZU5hbWUgPSBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24uZ2V0TGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lKCksXG4gICAgICAgIGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMgPSBmaW5kSW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyhydWxlLCAoaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uKSA9PiB7XG4gICAgICAgICAgY29uc3QgaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uTGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lID0gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLmdldExlZnRSZWN1cnNpdmVSdWxlTmFtZSgpLFxuICAgICAgICAgICAgICAgIGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbkxlZnRSZWN1cnNpdmVEZWZpbml0aW9uID0gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLmdldExlZnRSZWN1cnNpdmVEZWZpbml0aW9uKCk7XG5cbiAgICAgICAgICBpZiAoKGxlZnRSZWN1cnNpdmVEZWZpbml0aW9uID09PSBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25MZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbikgJiYgKGxlZnRSZWN1cnNpdmVSdWxlTmFtZSA9PT0gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uTGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICB9LCBjb250ZXh0KTtcblxuICBjb25zdCBkaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uID0gTGVmdFJlY3Vyc2l2ZURlZmluaXRpb25PcGVyYXRpb24uZXhlY3V0ZShpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sIGluZGlyZWN0bHlSZXBlYXRlZFJ1bGUsIGluZGlyZWN0bHlSZWR1Y2VkUnVsZSwgY29udGV4dCk7XG5cbiAgSW1wbGljaXRseVJlZHVjZWRSdWxlT3BlcmF0aW9uLmV4ZWN1dGUoZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiwgcnVsZSwgY29udGV4dCk7XG5cbiAgY29uc3QgYWRkZWRMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiA9IGRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sIC8vL1xuICAgICAgICByZW1vdmVkTGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zID0gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uczsgLy8vXG5cbiAgcmVtb3ZlTGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zKHJlbW92ZWRMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMsIGNvbnRleHQpO1xuXG4gIGFkZExlZnRSZWN1cnNpdmVEZWZpbml0aW9uKGFkZGVkTGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sIGNvbnRleHQpO1xufVxuIl0sIm5hbWVzIjpbImVsaW1pbmF0ZUluZGlyZWN0TGVmdFJlY3Vyc2lvbiIsImNvdW50IiwibWF4Q291bnQiLCJJbmZpbml0eSIsImNvbnRleHQiLCJncmVhdGVzdEluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiIsInJldHJpZXZlR3JlYXRlc3RJbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24iLCJpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24iLCJkZXB0aCIsImdldERlcHRoIiwicmVkdWNlSW5kaXJlY3RMZWZ0UmVjdXJzaW9uIiwicmV3cml0ZUluZGlyZWN0TGVmdFJlY3Vyc2lvbiIsInJ1bGUiLCJnZXRSdWxlIiwiZGVmaW5pdGlvbiIsImdldERlZmluaXRpb24iLCJkZWZpbml0aW9ucyIsImdldERlZmluaXRpb25zIiwiZGVmaW5pdGlvbnNJbmNsdWRlc0RlZmluaXRpb24iLCJpbmNsdWRlcyIsImluZGlyZWN0bHlSZWR1Y2VkUnVsZSIsIkluZGlyZWN0bHlSZWR1Y2VkUnVsZU9wZXJhdGlvbiIsImV4ZWN1dGUiLCJpbmRpcmVjdGx5UmVwZWF0ZWRSdWxlIiwiSW5kaXJlY3RseVJlcGVhdGVkUnVsZU9wZXJhdGlvbiIsIkluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbk9wZXJhdGlvbiIsImxlZnRSZWN1cnNpdmVEZWZpbml0aW9uIiwiZ2V0TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24iLCJsZWZ0UmVjdXJzaXZlUnVsZU5hbWUiLCJnZXRMZWZ0UmVjdXJzaXZlUnVsZU5hbWUiLCJpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zIiwiZmluZEluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMiLCJpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25MZWZ0UmVjdXJzaXZlUnVsZU5hbWUiLCJpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25MZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiIsIkxlZnRSZWN1cnNpdmVEZWZpbml0aW9uT3BlcmF0aW9uIiwiYWRkZWRMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiIsInJlbW92ZWRMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMiLCJyZW1vdmVMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMiLCJhZGRMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiIsImRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24iLCJJbXBsaWNpdGx5UmVkdWNlZFJ1bGVPcGVyYXRpb24iXSwibWFw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