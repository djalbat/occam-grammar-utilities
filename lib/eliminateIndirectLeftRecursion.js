"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "default", {
    enumerable: true,
    get: function() {
        return eliminateIndirectLeftRecursion;
    }
});
var _directlyReduced = /*#__PURE__*/ _interopRequireDefault(require("./operation/rule/directlyReduced"));
var _directlyRepeated = /*#__PURE__*/ _interopRequireDefault(require("./operation/rule/directlyRepeated"));
var _implicitlyReduced = /*#__PURE__*/ _interopRequireDefault(require("./operation/rule/implicitlyReduced"));
var _indirectlyReduced = /*#__PURE__*/ _interopRequireDefault(require("./operation/rule/indirectlyReduced"));
var _indirectlyRepeated = /*#__PURE__*/ _interopRequireDefault(require("./operation/rule/indirectlyRepeated"));
var _leftRecursive = /*#__PURE__*/ _interopRequireDefault(require("./operation/definition/leftRecursive"));
var _directlyLeftRecursive = /*#__PURE__*/ _interopRequireDefault(require("./operation/definition/directlyLeftRecursive"));
var _indirectlyLeftRecursive = /*#__PURE__*/ _interopRequireDefault(require("./operation/definition/indirectlyLeftRecursive"));
var _context = require("./utilities/context");
function _interopRequireDefault(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
var count = 0;
function eliminateIndirectLeftRecursion(context) {
    var greatestIndirectlyLeftRecursiveDefinition = (0, _context.retrieveGreatestIndirectlyLeftRecursiveDefinition)(context);
    while(greatestIndirectlyLeftRecursiveDefinition !== null){
        var indirectlyLeftRecursiveDefinition = greatestIndirectlyLeftRecursiveDefinition; ///
        //       rule = indirectlyLeftRecursiveDefinition.getRule();
        //       directlyLeftRecursiveDefinition = findDirectlyLeftRecursiveDefinition(rule, context);
        //
        // if (directlyLeftRecursiveDefinition !== null) {
        //   rewriteDirectLeftRecursion(directlyLeftRecursiveDefinition, indirectlyLeftRecursiveDefinition, context);
        // } else {
        var depth = indirectlyLeftRecursiveDefinition.getDepth();
        depth > 1 ? reduceIndirectLeftRecursion(indirectlyLeftRecursiveDefinition, context) : rewriteIndirectLeftRecursion(indirectlyLeftRecursiveDefinition, context);
        // }
        greatestIndirectlyLeftRecursiveDefinition = ++count > Infinity ? null : (0, _context.retrieveGreatestIndirectlyLeftRecursiveDefinition)(context);
    }
}
// function rewriteDirectLeftRecursion(directlyLeftRecursiveDefinition, indirectlyLeftRecursiveDefinition, context) {
//   const allowIsolated = true,
//         directlyReducedRule = DirectlyReducedRuleOperation.execute(directlyLeftRecursiveDefinition, allowIsolated, context),
//         directlyRepeatedRule = DirectlyRepeatedRuleOperation.execute(directlyLeftRecursiveDefinition, context);
//
//   const rule = directlyLeftRecursiveDefinition.getRule();
//
//   let indirectlyLeftRecursiveDefinitions = findIndirectlyLeftRecursiveDefinitions(rule, context);
//
//   const directlyLeftRecursiveDefinitions = findDirectlyLeftRecursiveDefinitions(rule, context),
//         removedLeftRecursiveDefinitions = [
//           ...directlyLeftRecursiveDefinitions,
//           ...indirectlyLeftRecursiveDefinitions
//         ];
//
//   indirectlyLeftRecursiveDefinitions = DirectlyLeftRecursiveDefinitionOperation.execute(directlyLeftRecursiveDefinition, directlyRepeatedRule, directlyReducedRule, context);
//
//   const addedLeftRecursiveDefinitions = indirectlyLeftRecursiveDefinitions; ///
//
//   removeLeftRecursiveDefinitions(removedLeftRecursiveDefinitions, context);
//
//   addLeftRecursiveDefinitions(addedLeftRecursiveDefinitions, context);
// }
function reduceIndirectLeftRecursion(indirectlyLeftRecursiveDefinition, context) {
    var indirectlyReducedRule = _indirectlyReduced.default.execute(indirectlyLeftRecursiveDefinition, context), indirectlyRepeatedRule = _indirectlyRepeated.default.execute(indirectlyLeftRecursiveDefinition, context);
    _indirectlyLeftRecursive.default.execute(indirectlyLeftRecursiveDefinition, context);
    var rule = indirectlyLeftRecursiveDefinition.getRule();
    var leftRecursiveDefinition = indirectlyLeftRecursiveDefinition.getLeftRecursiveDefinition();
    var leftRecursiveRuleName = indirectlyLeftRecursiveDefinition.getLeftRecursiveRuleName(), indirectlyLeftRecursiveDefinitions = (0, _context.findIndirectlyLeftRecursiveDefinitions)(rule, function(indirectlyLeftRecursiveDefinition) {
        var indirectlyLeftRecursiveDefinitionLeftRecursiveRuleName = indirectlyLeftRecursiveDefinition.getLeftRecursiveRuleName(), indirectlyLeftRecursiveDefinitionLeftRecursiveDefinition = indirectlyLeftRecursiveDefinition.getLeftRecursiveDefinition();
        if (leftRecursiveDefinition === indirectlyLeftRecursiveDefinitionLeftRecursiveDefinition && leftRecursiveRuleName === indirectlyLeftRecursiveDefinitionLeftRecursiveRuleName) {
            return true;
        }
    }, context);
    indirectlyLeftRecursiveDefinition = _leftRecursive.default.execute(indirectlyLeftRecursiveDefinition, indirectlyRepeatedRule, indirectlyReducedRule, context); ///
    var addedLeftRecursiveDefinition = indirectlyLeftRecursiveDefinition, removedLeftRecursiveDefinitions = indirectlyLeftRecursiveDefinitions; ///
    (0, _context.removeLeftRecursiveDefinitions)(removedLeftRecursiveDefinitions, context);
    (0, _context.addLeftRecursiveDefinition)(addedLeftRecursiveDefinition, context);
}
function rewriteIndirectLeftRecursion(indirectlyLeftRecursiveDefinition, context) {
    var indirectlyReducedRule = _indirectlyReduced.default.execute(indirectlyLeftRecursiveDefinition, context), indirectlyRepeatedRule = _indirectlyRepeated.default.execute(indirectlyLeftRecursiveDefinition, context);
    _indirectlyLeftRecursive.default.execute(indirectlyLeftRecursiveDefinition, context);
    var rule = indirectlyLeftRecursiveDefinition.getRule();
    var leftRecursiveDefinition = indirectlyLeftRecursiveDefinition.getLeftRecursiveDefinition();
    var leftRecursiveRuleName = indirectlyLeftRecursiveDefinition.getLeftRecursiveRuleName(), indirectlyLeftRecursiveDefinitions = (0, _context.findIndirectlyLeftRecursiveDefinitions)(rule, function(indirectlyLeftRecursiveDefinition) {
        var indirectlyLeftRecursiveDefinitionLeftRecursiveRuleName = indirectlyLeftRecursiveDefinition.getLeftRecursiveRuleName(), indirectlyLeftRecursiveDefinitionLeftRecursiveDefinition = indirectlyLeftRecursiveDefinition.getLeftRecursiveDefinition();
        if (leftRecursiveDefinition === indirectlyLeftRecursiveDefinitionLeftRecursiveDefinition && leftRecursiveRuleName === indirectlyLeftRecursiveDefinitionLeftRecursiveRuleName) {
            return true;
        }
    }, context);
    var directlyLeftRecursiveDefinition = _leftRecursive.default.execute(indirectlyLeftRecursiveDefinition, indirectlyRepeatedRule, indirectlyReducedRule, context);
    _implicitlyReduced.default.execute(directlyLeftRecursiveDefinition, rule, context);
    var addedLeftRecursiveDefinition = directlyLeftRecursiveDefinition, removedLeftRecursiveDefinitions = indirectlyLeftRecursiveDefinitions; ///
    (0, _context.removeLeftRecursiveDefinitions)(removedLeftRecursiveDefinitions, context);
    (0, _context.addLeftRecursiveDefinition)(addedLeftRecursiveDefinition, context);
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9lbGltaW5hdGVJbmRpcmVjdExlZnRSZWN1cnNpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbmltcG9ydCBEaXJlY3RseVJlZHVjZWRSdWxlT3BlcmF0aW9uIGZyb20gXCIuL29wZXJhdGlvbi9ydWxlL2RpcmVjdGx5UmVkdWNlZFwiO1xuaW1wb3J0IERpcmVjdGx5UmVwZWF0ZWRSdWxlT3BlcmF0aW9uIGZyb20gXCIuL29wZXJhdGlvbi9ydWxlL2RpcmVjdGx5UmVwZWF0ZWRcIjtcbmltcG9ydCBJbXBsaWNpdGx5UmVkdWNlZFJ1bGVPcGVyYXRpb24gZnJvbSBcIi4vb3BlcmF0aW9uL3J1bGUvaW1wbGljaXRseVJlZHVjZWRcIjtcbmltcG9ydCBJbmRpcmVjdGx5UmVkdWNlZFJ1bGVPcGVyYXRpb24gZnJvbSBcIi4vb3BlcmF0aW9uL3J1bGUvaW5kaXJlY3RseVJlZHVjZWRcIjtcbmltcG9ydCBJbmRpcmVjdGx5UmVwZWF0ZWRSdWxlT3BlcmF0aW9uIGZyb20gXCIuL29wZXJhdGlvbi9ydWxlL2luZGlyZWN0bHlSZXBlYXRlZFwiO1xuaW1wb3J0IExlZnRSZWN1cnNpdmVEZWZpbml0aW9uT3BlcmF0aW9uIGZyb20gXCIuL29wZXJhdGlvbi9kZWZpbml0aW9uL2xlZnRSZWN1cnNpdmVcIjtcbmltcG9ydCBEaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uT3BlcmF0aW9uIGZyb20gXCIuL29wZXJhdGlvbi9kZWZpbml0aW9uL2RpcmVjdGx5TGVmdFJlY3Vyc2l2ZVwiO1xuaW1wb3J0IEluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbk9wZXJhdGlvbiBmcm9tIFwiLi9vcGVyYXRpb24vZGVmaW5pdGlvbi9pbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZVwiO1xuXG5pbXBvcnQgeyBhZGRMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbixcbiAgICAgICAgIGFkZExlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyxcbiAgICAgICAgIHJlbW92ZUxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyxcbiAgICAgICAgIGZpbmREaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLFxuICAgICAgICAgZmluZERpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zLFxuICAgICAgICAgZmluZEluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMsXG4gICAgICAgICByZXRyaWV2ZUdyZWF0ZXN0SW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uIH0gZnJvbSBcIi4vdXRpbGl0aWVzL2NvbnRleHRcIlxuXG5sZXQgY291bnQgPSAwO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBlbGltaW5hdGVJbmRpcmVjdExlZnRSZWN1cnNpb24oY29udGV4dCkge1xuICBsZXQgZ3JlYXRlc3RJbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24gPSByZXRyaWV2ZUdyZWF0ZXN0SW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uKGNvbnRleHQpO1xuXG4gIHdoaWxlIChncmVhdGVzdEluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiAhPT0gbnVsbCkge1xuICAgIGNvbnN0IGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiA9IGdyZWF0ZXN0SW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uOyAvLy9cbiAgICAvLyAgICAgICBydWxlID0gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLmdldFJ1bGUoKTtcbiAgICAvLyAgICAgICBkaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uID0gZmluZERpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24ocnVsZSwgY29udGV4dCk7XG4gICAgLy9cbiAgICAvLyBpZiAoZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiAhPT0gbnVsbCkge1xuICAgIC8vICAgcmV3cml0ZURpcmVjdExlZnRSZWN1cnNpb24oZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiwgaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCBjb250ZXh0KTtcbiAgICAvLyB9IGVsc2Uge1xuICAgIGNvbnN0IGRlcHRoID0gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLmdldERlcHRoKCk7XG5cbiAgICAoZGVwdGggPiAxKSA/XG4gICAgICByZWR1Y2VJbmRpcmVjdExlZnRSZWN1cnNpb24oaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCBjb250ZXh0KSA6XG4gICAgICAgIHJld3JpdGVJbmRpcmVjdExlZnRSZWN1cnNpb24oaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCBjb250ZXh0KTtcbiAgICAvLyB9XG5cbiAgICBncmVhdGVzdEluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiA9ICsrY291bnQgPiBJbmZpbml0eSA/IG51bGwgOiByZXRyaWV2ZUdyZWF0ZXN0SW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uKGNvbnRleHQpO1xuICB9XG59XG5cbi8vIGZ1bmN0aW9uIHJld3JpdGVEaXJlY3RMZWZ0UmVjdXJzaW9uKGRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sIGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiwgY29udGV4dCkge1xuLy8gICBjb25zdCBhbGxvd0lzb2xhdGVkID0gdHJ1ZSxcbi8vICAgICAgICAgZGlyZWN0bHlSZWR1Y2VkUnVsZSA9IERpcmVjdGx5UmVkdWNlZFJ1bGVPcGVyYXRpb24uZXhlY3V0ZShkaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCBhbGxvd0lzb2xhdGVkLCBjb250ZXh0KSxcbi8vICAgICAgICAgZGlyZWN0bHlSZXBlYXRlZFJ1bGUgPSBEaXJlY3RseVJlcGVhdGVkUnVsZU9wZXJhdGlvbi5leGVjdXRlKGRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sIGNvbnRleHQpO1xuLy9cbi8vICAgY29uc3QgcnVsZSA9IGRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24uZ2V0UnVsZSgpO1xuLy9cbi8vICAgbGV0IGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMgPSBmaW5kSW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyhydWxlLCBjb250ZXh0KTtcbi8vXG4vLyAgIGNvbnN0IGRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zID0gZmluZERpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zKHJ1bGUsIGNvbnRleHQpLFxuLy8gICAgICAgICByZW1vdmVkTGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zID0gW1xuLy8gICAgICAgICAgIC4uLmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zLFxuLy8gICAgICAgICAgIC4uLmluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnNcbi8vICAgICAgICAgXTtcbi8vXG4vLyAgIGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMgPSBEaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uT3BlcmF0aW9uLmV4ZWN1dGUoZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiwgZGlyZWN0bHlSZXBlYXRlZFJ1bGUsIGRpcmVjdGx5UmVkdWNlZFJ1bGUsIGNvbnRleHQpO1xuLy9cbi8vICAgY29uc3QgYWRkZWRMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMgPSBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zOyAvLy9cbi8vXG4vLyAgIHJlbW92ZUxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyhyZW1vdmVkTGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zLCBjb250ZXh0KTtcbi8vXG4vLyAgIGFkZExlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyhhZGRlZExlZnRSZWN1cnNpdmVEZWZpbml0aW9ucywgY29udGV4dCk7XG4vLyB9XG5cbmZ1bmN0aW9uIHJlZHVjZUluZGlyZWN0TGVmdFJlY3Vyc2lvbihpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sIGNvbnRleHQpIHtcbiAgY29uc3QgaW5kaXJlY3RseVJlZHVjZWRSdWxlID0gSW5kaXJlY3RseVJlZHVjZWRSdWxlT3BlcmF0aW9uLmV4ZWN1dGUoaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCBjb250ZXh0KSxcbiAgICAgICAgaW5kaXJlY3RseVJlcGVhdGVkUnVsZSA9IEluZGlyZWN0bHlSZXBlYXRlZFJ1bGVPcGVyYXRpb24uZXhlY3V0ZShpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sIGNvbnRleHQpO1xuXG4gIEluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbk9wZXJhdGlvbi5leGVjdXRlKGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiwgY29udGV4dCk7XG5cbiAgY29uc3QgcnVsZSA9IGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbi5nZXRSdWxlKCk7XG5cbiAgbGV0IGxlZnRSZWN1cnNpdmVEZWZpbml0aW9uID0gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLmdldExlZnRSZWN1cnNpdmVEZWZpbml0aW9uKCk7XG5cbiAgY29uc3QgbGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lID0gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLmdldExlZnRSZWN1cnNpdmVSdWxlTmFtZSgpLFxuICAgICAgICBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zID0gZmluZEluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMocnVsZSwgKGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbikgPT4ge1xuICAgICAgICAgIGNvbnN0IGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbkxlZnRSZWN1cnNpdmVSdWxlTmFtZSA9IGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbi5nZXRMZWZ0UmVjdXJzaXZlUnVsZU5hbWUoKSxcbiAgICAgICAgICAgICAgICBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25MZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiA9IGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbi5nZXRMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbigpO1xuXG4gICAgICAgICAgaWYgKChsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiA9PT0gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uTGVmdFJlY3Vyc2l2ZURlZmluaXRpb24pICYmIChsZWZ0UmVjdXJzaXZlUnVsZU5hbWUgPT09IGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbkxlZnRSZWN1cnNpdmVSdWxlTmFtZSkpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSwgY29udGV4dCk7XG5cbiAgaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uID0gTGVmdFJlY3Vyc2l2ZURlZmluaXRpb25PcGVyYXRpb24uZXhlY3V0ZShpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sIGluZGlyZWN0bHlSZXBlYXRlZFJ1bGUsIGluZGlyZWN0bHlSZWR1Y2VkUnVsZSwgY29udGV4dCk7ICAvLy9cblxuICBjb25zdCBhZGRlZExlZnRSZWN1cnNpdmVEZWZpbml0aW9uID0gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCAvLy9cbiAgICAgICAgcmVtb3ZlZExlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyA9IGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnM7IC8vL1xuXG4gIHJlbW92ZUxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyhyZW1vdmVkTGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zLCBjb250ZXh0KTtcblxuICBhZGRMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbihhZGRlZExlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCBjb250ZXh0KTtcbn1cblxuZnVuY3Rpb24gcmV3cml0ZUluZGlyZWN0TGVmdFJlY3Vyc2lvbihpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sIGNvbnRleHQpIHtcbiAgY29uc3QgaW5kaXJlY3RseVJlZHVjZWRSdWxlID0gSW5kaXJlY3RseVJlZHVjZWRSdWxlT3BlcmF0aW9uLmV4ZWN1dGUoaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCBjb250ZXh0KSxcbiAgICAgICAgaW5kaXJlY3RseVJlcGVhdGVkUnVsZSA9IEluZGlyZWN0bHlSZXBlYXRlZFJ1bGVPcGVyYXRpb24uZXhlY3V0ZShpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sIGNvbnRleHQpO1xuXG4gIEluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbk9wZXJhdGlvbi5leGVjdXRlKGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiwgY29udGV4dCk7XG5cbiAgY29uc3QgcnVsZSA9IGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbi5nZXRSdWxlKCk7XG5cbiAgbGV0IGxlZnRSZWN1cnNpdmVEZWZpbml0aW9uID0gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLmdldExlZnRSZWN1cnNpdmVEZWZpbml0aW9uKCk7XG5cbiAgY29uc3QgbGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lID0gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLmdldExlZnRSZWN1cnNpdmVSdWxlTmFtZSgpLFxuICAgICAgICBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zID0gZmluZEluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMocnVsZSwgKGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbikgPT4ge1xuICAgICAgICAgIGNvbnN0IGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbkxlZnRSZWN1cnNpdmVSdWxlTmFtZSA9IGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbi5nZXRMZWZ0UmVjdXJzaXZlUnVsZU5hbWUoKSxcbiAgICAgICAgICAgICAgICBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25MZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiA9IGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbi5nZXRMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbigpO1xuXG4gICAgICAgICAgaWYgKChsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiA9PT0gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uTGVmdFJlY3Vyc2l2ZURlZmluaXRpb24pICYmIChsZWZ0UmVjdXJzaXZlUnVsZU5hbWUgPT09IGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbkxlZnRSZWN1cnNpdmVSdWxlTmFtZSkpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSwgY29udGV4dCk7XG5cbiAgY29uc3QgZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiA9IExlZnRSZWN1cnNpdmVEZWZpbml0aW9uT3BlcmF0aW9uLmV4ZWN1dGUoaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCBpbmRpcmVjdGx5UmVwZWF0ZWRSdWxlLCBpbmRpcmVjdGx5UmVkdWNlZFJ1bGUsIGNvbnRleHQpO1xuXG4gIEltcGxpY2l0bHlSZWR1Y2VkUnVsZU9wZXJhdGlvbi5leGVjdXRlKGRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sIHJ1bGUsIGNvbnRleHQpO1xuXG4gIGNvbnN0IGFkZGVkTGVmdFJlY3Vyc2l2ZURlZmluaXRpb24gPSBkaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCAvLy9cbiAgICAgICAgcmVtb3ZlZExlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyA9IGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnM7IC8vL1xuXG4gIHJlbW92ZUxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyhyZW1vdmVkTGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zLCBjb250ZXh0KTtcblxuICBhZGRMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbihhZGRlZExlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCBjb250ZXh0KTtcbn1cbiJdLCJuYW1lcyI6WyJlbGltaW5hdGVJbmRpcmVjdExlZnRSZWN1cnNpb24iLCJjb3VudCIsImNvbnRleHQiLCJncmVhdGVzdEluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiIsInJldHJpZXZlR3JlYXRlc3RJbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24iLCJpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24iLCJkZXB0aCIsImdldERlcHRoIiwicmVkdWNlSW5kaXJlY3RMZWZ0UmVjdXJzaW9uIiwicmV3cml0ZUluZGlyZWN0TGVmdFJlY3Vyc2lvbiIsIkluZmluaXR5IiwiaW5kaXJlY3RseVJlZHVjZWRSdWxlIiwiSW5kaXJlY3RseVJlZHVjZWRSdWxlT3BlcmF0aW9uIiwiZXhlY3V0ZSIsImluZGlyZWN0bHlSZXBlYXRlZFJ1bGUiLCJJbmRpcmVjdGx5UmVwZWF0ZWRSdWxlT3BlcmF0aW9uIiwiSW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uT3BlcmF0aW9uIiwicnVsZSIsImdldFJ1bGUiLCJsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiIsImdldExlZnRSZWN1cnNpdmVEZWZpbml0aW9uIiwibGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lIiwiZ2V0TGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lIiwiaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyIsImZpbmRJbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zIiwiaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uTGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lIiwiaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uTGVmdFJlY3Vyc2l2ZURlZmluaXRpb24iLCJMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbk9wZXJhdGlvbiIsImFkZGVkTGVmdFJlY3Vyc2l2ZURlZmluaXRpb24iLCJyZW1vdmVkTGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zIiwicmVtb3ZlTGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zIiwiYWRkTGVmdFJlY3Vyc2l2ZURlZmluaXRpb24iLCJkaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uIiwiSW1wbGljaXRseVJlZHVjZWRSdWxlT3BlcmF0aW9uIl0sIm1hcHBpbmdzIjoiQUFBQTs7OzsrQkFxQkE7OztlQUF3QkE7OztvRUFuQmlCO3FFQUNDO3NFQUNDO3NFQUNBO3VFQUNDO2tFQUNDOzBFQUNROzRFQUNFO3VCQVFXOzs7Ozs7QUFFbEUsSUFBSUMsUUFBUTtBQUVHLFNBQVNELCtCQUErQkUsT0FBTyxFQUFFO0lBQzlELElBQUlDLDRDQUE0Q0MsSUFBQUEsMERBQWlELEVBQUNGO0lBRWxHLE1BQU9DLDhDQUE4QyxJQUFJLENBQUU7UUFDekQsSUFBTUUsb0NBQW9DRiwyQ0FBMkMsR0FBRztRQUN4Riw0REFBNEQ7UUFDNUQsOEZBQThGO1FBQzlGLEVBQUU7UUFDRixrREFBa0Q7UUFDbEQsNkdBQTZHO1FBQzdHLFdBQVc7UUFDWCxJQUFNRyxRQUFRRCxrQ0FBa0NFLFFBQVE7UUFFdkRELFFBQVEsSUFDUEUsNEJBQTRCSCxtQ0FBbUNILFdBQzdETyw2QkFBNkJKLG1DQUFtQ0gsUUFBUTtRQUM1RSxJQUFJO1FBRUpDLDRDQUE0QyxFQUFFRixRQUFRUyxXQUFXLElBQUksR0FBR04sSUFBQUEsMERBQWlELEVBQUNGLFFBQVE7SUFDcEk7QUFDRjtBQUVBLHFIQUFxSDtBQUNySCxnQ0FBZ0M7QUFDaEMsK0hBQStIO0FBQy9ILGtIQUFrSDtBQUNsSCxFQUFFO0FBQ0YsNERBQTREO0FBQzVELEVBQUU7QUFDRixvR0FBb0c7QUFDcEcsRUFBRTtBQUNGLGtHQUFrRztBQUNsRyw4Q0FBOEM7QUFDOUMs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