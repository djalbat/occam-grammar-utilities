"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "default", {
    enumerable: true,
    get: function() {
        return eliminateIndirectLeftRecursion;
    }
});
var _necessary = require("necessary");
var _directly = /*#__PURE__*/ _interopRequireDefault(require("./rule/reduced/directly"));
var _directly1 = /*#__PURE__*/ _interopRequireDefault(require("./rule/repeated/directly"));
var _replacementDefinition = /*#__PURE__*/ _interopRequireDefault(require("./replacementDefinition"));
var _indirectly = /*#__PURE__*/ _interopRequireDefault(require("./rule/reduced/indirectly"));
var _indirectly1 = /*#__PURE__*/ _interopRequireDefault(require("./rule/repeated/indirectly"));
var _directly2 = /*#__PURE__*/ _interopRequireDefault(require("./recursiveDefinition/left/directly"));
var _indirectly2 = /*#__PURE__*/ _interopRequireDefault(require("./recursiveDefinition/left/indirectly"));
var _ruleName = require("./utilities/ruleName");
function _arrayLikeToArray(arr, len) {
    if (len == null || len > arr.length) len = arr.length;
    for(var i = 0, arr2 = new Array(len); i < len; i++)arr2[i] = arr[i];
    return arr2;
}
function _arrayWithoutHoles(arr) {
    if (Array.isArray(arr)) return _arrayLikeToArray(arr);
}
function _instanceof(left, right) {
    if (right != null && typeof Symbol !== "undefined" && right[Symbol.hasInstance]) {
        return !!right[Symbol.hasInstance](left);
    } else {
        return left instanceof right;
    }
}
function _interopRequireDefault(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
function _iterableToArray(iter) {
    if (typeof Symbol !== "undefined" && iter[Symbol.iterator] != null || iter["@@iterator"] != null) return Array.from(iter);
}
function _nonIterableSpread() {
    throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
}
function _toConsumableArray(arr) {
    return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();
}
function _unsupportedIterableToArray(o, minLen) {
    if (!o) return;
    if (typeof o === "string") return _arrayLikeToArray(o, minLen);
    var n = Object.prototype.toString.call(o).slice(8, -1);
    if (n === "Object" && o.constructor) n = o.constructor.name;
    if (n === "Map" || n === "Set") return Array.from(n);
    if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);
}
var find = _necessary.arrayUtilities.find, push = _necessary.arrayUtilities.push, filter = _necessary.arrayUtilities.filter;
var count = 0;
function eliminateIndirectLeftRecursion(leftRecursiveDefinitions, ruleMap) {
    var greatestIndirectlyLeftRecursiveDefinition = retrieveGreatestIndirectlyLeftRecursiveDefinition(leftRecursiveDefinitions);
    while(greatestIndirectlyLeftRecursiveDefinition !== null){
        var indirectlyLeftRecursiveDefinition = greatestIndirectlyLeftRecursiveDefinition, rule = indirectlyLeftRecursiveDefinition.getRule(), directlyLeftRecursiveDefinition = findDirectlyLeftRecursiveDefinition(rule, leftRecursiveDefinitions);
        directlyLeftRecursiveDefinition !== null ? rewriteDirectLeftRecursion(directlyLeftRecursiveDefinition, indirectlyLeftRecursiveDefinition, leftRecursiveDefinitions, ruleMap) : rewriteIndirectLeftRecursion(indirectlyLeftRecursiveDefinition, leftRecursiveDefinitions, ruleMap);
        greatestIndirectlyLeftRecursiveDefinition = ++count > Infinity ? null : retrieveGreatestIndirectlyLeftRecursiveDefinition(leftRecursiveDefinitions);
    }
}
function rewriteDirectLeftRecursion(directlyLeftRecursiveDefinition, indirectlyLeftRecursiveDefinition, leftRecursiveDefinitions, ruleMap) {
    directlyRepeatRule(directlyLeftRecursiveDefinition, leftRecursiveDefinitions, ruleMap);
    directlyReduceRule(indirectlyLeftRecursiveDefinition, leftRecursiveDefinitions, ruleMap);
    var directlyLeftRecursiveDefinitions = rewriteDirectlyLeftRecursiveDefinitions(directlyLeftRecursiveDefinition, leftRecursiveDefinitions);
// const definitions = rule.getDefinitions(),
//       directlyLeftRecursiveDefinitions = findDirectlyLeftRecursiveDefinitions(definitions);
//
// let indirectlyLeftRecursiveDefinitions = findIndirectlyLeftRecursiveDefinitions(definitions);
//
// const removedLeftRecursiveDefinitions = [
//   ...directlyLeftRecursiveDefinitions,
//   ...indirectlyLeftRecursiveDefinitions
// ];
//
// indirectlyLeftRecursiveDefinitions = indirectlyLeftRecursiveDefinitions.map((indirectlyLeftRecursiveDefinition) => {
//   indirectlyLeftRecursiveDefinition = IndirectlyLeftRecursiveDefinition.fromIndirectlyLeftRecursiveDefinitionAndDirectlyRepeatedRuleName(indirectlyLeftRecursiveDefinition, directlyRepeatedRuleName);  ///
//
//   return indirectlyLeftRecursiveDefinition;
// });
//
// let replacementDefinitions = [
//   ...indirectlyLeftRecursiveDefinitions
// ];
//
// if (directlyReducedRuleName !== null) {
//   const leftRecursiveDefinition = LeftRecursiveDefinition.fromDirectlyReducedRuleNameAndDirectlyRepeatedRuleName(directlyReducedRuleName, directlyRepeatedRuleName);
//
//   replacementDefinitions = [
//     ...replacementDefinitions,
//     leftRecursiveDefinition
//   ];
// }
//
// rule.replaceAllDefinitions(...replacementDefinitions);
//
// const addedLeftRecursiveDefinitions = indirectlyLeftRecursiveDefinitions; ///
//
// amendLeftRecursiveDefinitions(leftRecursiveDefinitions, removedLeftRecursiveDefinitions, ...addedLeftRecursiveDefinitions);
}
function rewriteIndirectLeftRecursion(indirectlyLeftRecursiveDefinition, leftRecursiveDefinitions, ruleMap) {
    var leftRecursiveDefinition = indirectlyLeftRecursiveDefinition.getLeftRecursiveDefinition();
    indirectlyReduceRule(indirectlyLeftRecursiveDefinition, leftRecursiveDefinitions, ruleMap);
    var indirectlyRepeatedRule = indirectlyRepeatRule(indirectlyLeftRecursiveDefinition, leftRecursiveDefinitions, ruleMap), indirectlyLeftRecursiveDefinitions = rewriteIndirectlyLeftRecursiveDefinitions(indirectlyLeftRecursiveDefinition, leftRecursiveDefinitions), addedLeftRecursiveDefinition = rewriteLeftRecursiveDefinition(indirectlyLeftRecursiveDefinition, indirectlyRepeatedRule), removedLeftRecursiveDefinitions = [
        leftRecursiveDefinition
    ].concat(_toConsumableArray(indirectlyLeftRecursiveDefinitions));
    amendLeftRecursiveDefinitions(leftRecursiveDefinitions, removedLeftRecursiveDefinitions, addedLeftRecursiveDefinition);
}
function directlyReduceRule(indirectlyLeftRecursiveDefinition, leftRecursiveDefinitions, ruleMap) {
    var rule = indirectlyLeftRecursiveDefinition.getRule(), disallowIsolated = false, directlyReducedRule = _directly.default.fromRuleAndLeftRecursiveDefinitions(rule, leftRecursiveDefinitions, disallowIsolated);
    if (directlyReducedRule !== null) {
        var directlyReducedRuleName = directlyReducedRule.getName();
        ruleMap[directlyReducedRuleName] = directlyReducedRule;
    }
}
function directlyRepeatRule(directlyLeftRecursiveDefinition, leftRecursiveDefinitions, ruleMap) {
    var rule = directlyLeftRecursiveDefinition.getRule(), directlyRepeatedRule = _directly1.default.fromRuleAndLeftRecursiveDefinitions(rule, leftRecursiveDefinitions), directlyRepeatedRuleName = directlyRepeatedRule.getName();
    ruleMap[directlyRepeatedRuleName] = directlyRepeatedRule;
}
function indirectlyReduceRule(indirectlyLeftRecursiveDefinition, leftRecursiveDefinitions, ruleMap) {
    var rule = indirectlyLeftRecursiveDefinition.getRule(), ruleName = rule.getName(), indirectlyReducedRuleName = (0, _ruleName.indirectlyReducedRuleNameFromRuleName)(ruleName), indirectlyReducedRule = ruleMap[indirectlyReducedRuleName] || _indirectly.default.fromRuleAndLeftRecursiveDefinitions(rule, leftRecursiveDefinitions); ///
    if (indirectlyReducedRule !== null) {
        var replacementDefinition = _replacementDefinition.default.fromIndirectlyLeftRecursiveDefinitionAndIndirectlyReducedRule(indirectlyLeftRecursiveDefinition, indirectlyReducedRule), leftRecursiveDefinition = indirectlyLeftRecursiveDefinition.getLeftRecursiveDefinition(), rule1 = leftRecursiveDefinition.getRule(), definition = replacementDefinition; ///
        ruleMap[indirectlyReducedRuleName] = indirectlyReducedRule;
        rule1.addDefinition(definition);
    }
}
function indirectlyRepeatRule(indirectlyLeftRecursiveDefinition, leftRecursiveDefinitions, ruleMap) {
    var rule = indirectlyLeftRecursiveDefinition.getRule(), leftRecursiveRuleName = indirectlyLeftRecursiveDefinition.getLeftRecursiveRuleName(), indirectlyRepeatedRule = _indirectly1.default.fromRuleLeftRecursiveRuleNameAndLeftRecursiveDefinitions(rule, leftRecursiveRuleName, leftRecursiveDefinitions), indirectlyRepeatedRuleName = indirectlyRepeatedRule.getName();
    ruleMap[indirectlyRepeatedRuleName] = indirectlyRepeatedRule;
    return indirectlyRepeatedRule;
}
function amendLeftRecursiveDefinitions(leftRecursiveDefinitions, removedLeftRecursiveDefinitions) {
    for(var _len = arguments.length, addedLeftRecursiveDefinitions = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++){
        addedLeftRecursiveDefinitions[_key - 2] = arguments[_key];
    }
    filter(leftRecursiveDefinitions, function(leftRecursiveDefinition) {
        var removedLeftRecursiveDefinitionsIncludesLeftRecursiveDefinition = removedLeftRecursiveDefinitions.includes(leftRecursiveDefinition);
        if (!removedLeftRecursiveDefinitionsIncludesLeftRecursiveDefinition) {
            return true;
        }
    });
    push(leftRecursiveDefinitions, addedLeftRecursiveDefinitions);
}
function rewriteLeftRecursiveDefinition(indirectlyLeftRecursiveDefinition, indirectlyRepeatedRule) {
    var leftRecursiveDefinition = indirectlyLeftRecursiveDefinition.getLeftRecursiveDefinition();
    var least = indirectlyLeftRecursiveDefinition.isLeast(), replacedDefinition = leftRecursiveDefinition.getDefinition(), replacementDefinition = _replacementDefinition.default.fromIndirectlyLeftRecursiveDefinitionAndIndirectlyRepeatedRule(indirectlyLeftRecursiveDefinition, indirectlyRepeatedRule), rule = leftRecursiveDefinition.getRule(), definition = replacementDefinition; ///
    leftRecursiveDefinition = least ? _directly2.default.fromRuleAndDefinition(rule, definition) : _indirectly2.default.fromIndirectlyLeftRecursiveDefinitionAndDefinition(indirectlyLeftRecursiveDefinition, definition);
    var definitions = rule.getDefinitions(), definitionsIncludesReplacedDefinition = definitions.includes(replacedDefinition);
    definitionsIncludesReplacedDefinition ? rule.replaceDefinition(replacedDefinition, replacementDefinition) : rule.addDefinition(definition);
    return leftRecursiveDefinition;
}
function findDirectlyLeftRecursiveDefinition(rule, leftRecursiveDefinitions) {
    var directlyLeftRecursiveDefinitions = leftRecursiveDefinitions.find(function(leftRecursiveDefinition) {
        var leftRecursiveDefinitionRule = leftRecursiveDefinition.getRule();
        if (leftRecursiveDefinitionRule === rule) {
            var leftRecursiveDefinitionDirectlyLeftRecursiveDefinition = _instanceof(leftRecursiveDefinition, _directly2.default);
            if (leftRecursiveDefinitionDirectlyLeftRecursiveDefinition) {
                return true;
            }
        }
    }) || null;
    return directlyLeftRecursiveDefinitions;
}
function findDirectlyLeftRecursiveDefinitions(rule, leftRecursiveDefinitions) {
    var directlyLeftRecursiveDefinitions = find(leftRecursiveDefinitions, function(leftRecursiveDefinition) {
        var leftRecursiveDefinitionRule = leftRecursiveDefinition.getRule();
        if (leftRecursiveDefinitionRule === rule) {
            var leftRecursiveDefinitionDirectlyLeftRecursiveDefinition = _instanceof(leftRecursiveDefinition, _directly2.default);
            if (leftRecursiveDefinitionDirectlyLeftRecursiveDefinition) {
                return true;
            }
        }
    });
    return directlyLeftRecursiveDefinitions;
}
function findIndirectlyLeftRecursiveDefinitions(rule, leftRecursiveDefinitions) {
    var leftRecursiveRuleName = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : null;
    var indirectlyLeftRecursiveDefinitions = find(leftRecursiveDefinitions, function(leftRecursiveDefinition) {
        var leftRecursiveDefinitionRule = leftRecursiveDefinition.getRule();
        if (leftRecursiveDefinitionRule === rule) {
            var leftRecursiveDefinitionIndirectlyLeftRecursiveDefinition = _instanceof(leftRecursiveDefinition, _indirectly2.default);
            if (leftRecursiveDefinitionIndirectlyLeftRecursiveDefinition) {
                if (leftRecursiveRuleName === null) {
                    return true;
                }
                var indirectlyLeftRecursiveDefinition = leftRecursiveDefinition, indirectlyLeftRecursiveDefinitionLeftRecursiveRuleName = indirectlyLeftRecursiveDefinition.getLeftRecursiveRuleName();
                if (indirectlyLeftRecursiveDefinitionLeftRecursiveRuleName === leftRecursiveRuleName) {
                    return true;
                }
            }
        }
    });
    return indirectlyLeftRecursiveDefinitions;
}
function rewriteDirectlyLeftRecursiveDefinitions(directlyLeftRecursiveDefinition, leftRecursiveDefinitions) {
    var rule = directlyLeftRecursiveDefinition.getRule(), directlyLeftRecursiveDefinitions = findDirectlyLeftRecursiveDefinitions(rule, leftRecursiveDefinitions), definitions = directlyLeftRecursiveDefinitions.map(function(directlyLeftRecursiveDefinition) {
        var definition = directlyLeftRecursiveDefinition.getDefinition();
        return definition;
    });
    rule.removeDefinitions(definitions);
    return directlyLeftRecursiveDefinitions;
}
function rewriteIndirectlyLeftRecursiveDefinitions(indirectlyLeftRecursiveDefinition, leftRecursiveDefinitions) {
    var rule = indirectlyLeftRecursiveDefinition.getRule(), replacedDefinition = indirectlyLeftRecursiveDefinition.getDefinition(), leftRecursiveRuleName = indirectlyLeftRecursiveDefinition.getLeftRecursiveRuleName(), indirectlyLeftRecursiveDefinitions = findIndirectlyLeftRecursiveDefinitions(rule, leftRecursiveDefinitions, leftRecursiveRuleName), definitions = indirectlyLeftRecursiveDefinitions.map(function(indirectlyLeftRecursiveDefinition) {
        var definition = indirectlyLeftRecursiveDefinition.getDefinition();
        return definition;
    }), replacementDefinition = _replacementDefinition.default.fromIndirectlyLeftRecursiveDefinition(indirectlyLeftRecursiveDefinition, leftRecursiveRuleName); ///
    rule.replaceDefinition(replacedDefinition, replacementDefinition);
    rule.removeDefinitions(definitions);
    return indirectlyLeftRecursiveDefinitions;
}
function retrieveGreatestIndirectlyLeftRecursiveDefinition(leftRecursiveDefinitions) {
    var greatestIndirectlyLeftRecursiveDefinition = null;
    var indirectlyLeftRecursiveDefinitions = find(leftRecursiveDefinitions, function(leftRecursiveDefinition) {
        var leftRecursiveDefinitionIndirectlyLeftRecursiveDefinition = _instanceof(leftRecursiveDefinition, _indirectly2.default);
        if (leftRecursiveDefinitionIndirectlyLeftRecursiveDefinition) {
            return true;
        }
    });
    indirectlyLeftRecursiveDefinitions.forEach(function(indirectlyLeftRecursiveDefinition) {
        if (greatestIndirectlyLeftRecursiveDefinition === null) {
            greatestIndirectlyLeftRecursiveDefinition = indirectlyLeftRecursiveDefinition; ///
        } else {
            var indirectlyLeftRecursiveDefinitionGreaterThanGreatestIndirectlyLeftRecursiveDefinition = indirectlyLeftRecursiveDefinition.isGreaterThan(greatestIndirectlyLeftRecursiveDefinition);
            if (indirectlyLeftRecursiveDefinitionGreaterThanGreatestIndirectlyLeftRecursiveDefinition) {
                greatestIndirectlyLeftRecursiveDefinition = indirectlyLeftRecursiveDefinition; ///
            }
        }
    });
    return greatestIndirectlyLeftRecursiveDefinition;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9lbGltaW5hdGVJbmRpcmVjdExlZnRSZWN1cnNpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbmltcG9ydCB7IGFycmF5VXRpbGl0aWVzIH0gZnJvbSBcIm5lY2Vzc2FyeVwiO1xuXG5pbXBvcnQgRGlyZWN0bHlSZWR1Y2VkUnVsZSBmcm9tIFwiLi9ydWxlL3JlZHVjZWQvZGlyZWN0bHlcIjtcbmltcG9ydCBEaXJlY3RseVJlcGVhdGVkUnVsZSBmcm9tIFwiLi9ydWxlL3JlcGVhdGVkL2RpcmVjdGx5XCI7XG5pbXBvcnQgUmVwbGFjZW1lbnREZWZpbml0aW9uIGZyb20gXCIuL3JlcGxhY2VtZW50RGVmaW5pdGlvblwiO1xuaW1wb3J0IEluZGlyZWN0bHlSZWR1Y2VkUnVsZSBmcm9tIFwiLi9ydWxlL3JlZHVjZWQvaW5kaXJlY3RseVwiO1xuaW1wb3J0IEluZGlyZWN0bHlSZXBlYXRlZFJ1bGUgZnJvbSBcIi4vcnVsZS9yZXBlYXRlZC9pbmRpcmVjdGx5XCI7XG5pbXBvcnQgRGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiBmcm9tIFwiLi9yZWN1cnNpdmVEZWZpbml0aW9uL2xlZnQvZGlyZWN0bHlcIjtcbmltcG9ydCBJbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24gZnJvbSBcIi4vcmVjdXJzaXZlRGVmaW5pdGlvbi9sZWZ0L2luZGlyZWN0bHlcIjtcblxuaW1wb3J0IHsgaW5kaXJlY3RseVJlZHVjZWRSdWxlTmFtZUZyb21SdWxlTmFtZSB9IGZyb20gXCIuL3V0aWxpdGllcy9ydWxlTmFtZVwiO1xuXG5jb25zdCB7IGZpbmQsIHB1c2gsIGZpbHRlciB9ID0gYXJyYXlVdGlsaXRpZXM7XG5cbmxldCBjb3VudCA9IDA7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGVsaW1pbmF0ZUluZGlyZWN0TGVmdFJlY3Vyc2lvbihsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMsIHJ1bGVNYXApIHtcbiAgbGV0IGdyZWF0ZXN0SW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uID0gcmV0cmlldmVHcmVhdGVzdEluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbihsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMpO1xuXG4gIHdoaWxlIChncmVhdGVzdEluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiAhPT0gbnVsbCkge1xuICAgIGNvbnN0IGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiA9IGdyZWF0ZXN0SW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCAvLy9cbiAgICAgICAgICBydWxlID0gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLmdldFJ1bGUoKSxcbiAgICAgICAgICBkaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uID0gZmluZERpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24ocnVsZSwgbGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zKTtcblxuICAgIChkaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uICE9PSBudWxsKSA/XG4gICAgICByZXdyaXRlRGlyZWN0TGVmdFJlY3Vyc2lvbihkaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sIGxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucywgcnVsZU1hcCkgOlxuICAgICAgICByZXdyaXRlSW5kaXJlY3RMZWZ0UmVjdXJzaW9uKGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiwgbGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zLCBydWxlTWFwKTtcblxuICAgIGdyZWF0ZXN0SW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uID0gKytjb3VudCA+IEluZmluaXR5ID8gbnVsbCA6IHJldHJpZXZlR3JlYXRlc3RJbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24obGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zKTtcbiAgfVxufVxuXG5mdW5jdGlvbiByZXdyaXRlRGlyZWN0TGVmdFJlY3Vyc2lvbihkaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sIGxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucywgcnVsZU1hcCkge1xuICBkaXJlY3RseVJlcGVhdFJ1bGUoZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiwgbGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zLCBydWxlTWFwKTtcblxuICBkaXJlY3RseVJlZHVjZVJ1bGUoaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCBsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMsIHJ1bGVNYXApO1xuXG4gIGNvbnN0IGRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zID0gcmV3cml0ZURpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zKGRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sIGxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucylcblxuICAvLyBjb25zdCBkZWZpbml0aW9ucyA9IHJ1bGUuZ2V0RGVmaW5pdGlvbnMoKSxcbiAgLy8gICAgICAgZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMgPSBmaW5kRGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMoZGVmaW5pdGlvbnMpO1xuICAvL1xuICAvLyBsZXQgaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyA9IGZpbmRJbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zKGRlZmluaXRpb25zKTtcbiAgLy9cbiAgLy8gY29uc3QgcmVtb3ZlZExlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyA9IFtcbiAgLy8gICAuLi5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyxcbiAgLy8gICAuLi5pbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zXG4gIC8vIF07XG4gIC8vXG4gIC8vIGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMgPSBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zLm1hcCgoaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uKSA9PiB7XG4gIC8vICAgaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uID0gSW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLmZyb21JbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25BbmREaXJlY3RseVJlcGVhdGVkUnVsZU5hbWUoaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCBkaXJlY3RseVJlcGVhdGVkUnVsZU5hbWUpOyAgLy8vXG4gIC8vXG4gIC8vICAgcmV0dXJuIGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbjtcbiAgLy8gfSk7XG4gIC8vXG4gIC8vIGxldCByZXBsYWNlbWVudERlZmluaXRpb25zID0gW1xuICAvLyAgIC4uLmluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnNcbiAgLy8gXTtcbiAgLy9cbiAgLy8gaWYgKGRpcmVjdGx5UmVkdWNlZFJ1bGVOYW1lICE9PSBudWxsKSB7XG4gIC8vICAgY29uc3QgbGVmdFJlY3Vyc2l2ZURlZmluaXRpb24gPSBMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbi5mcm9tRGlyZWN0bHlSZWR1Y2VkUnVsZU5hbWVBbmREaXJlY3RseVJlcGVhdGVkUnVsZU5hbWUoZGlyZWN0bHlSZWR1Y2VkUnVsZU5hbWUsIGRpcmVjdGx5UmVwZWF0ZWRSdWxlTmFtZSk7XG4gIC8vXG4gIC8vICAgcmVwbGFjZW1lbnREZWZpbml0aW9ucyA9IFtcbiAgLy8gICAgIC4uLnJlcGxhY2VtZW50RGVmaW5pdGlvbnMsXG4gIC8vICAgICBsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvblxuICAvLyAgIF07XG4gIC8vIH1cbiAgLy9cbiAgLy8gcnVsZS5yZXBsYWNlQWxsRGVmaW5pdGlvbnMoLi4ucmVwbGFjZW1lbnREZWZpbml0aW9ucyk7XG4gIC8vXG4gIC8vIGNvbnN0IGFkZGVkTGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zID0gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uczsgLy8vXG4gIC8vXG4gIC8vIGFtZW5kTGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zKGxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucywgcmVtb3ZlZExlZnRSZWN1cnNpdmVEZWZpbml0aW9ucywgLi4uYWRkZWRMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMpO1xufVxuXG5mdW5jdGlvbiByZXdyaXRlSW5kaXJlY3RMZWZ0UmVjdXJzaW9uKGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiwgbGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zLCBydWxlTWFwKSB7XG4gIGNvbnN0IGxlZnRSZWN1cnNpdmVEZWZpbml0aW9uID0gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLmdldExlZnRSZWN1cnNpdmVEZWZpbml0aW9uKCk7XG5cbiAgaW5kaXJlY3RseVJlZHVjZVJ1bGUoaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCBsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMsIHJ1bGVNYXApO1xuXG4gIGNvbnN0IGluZGlyZWN0bHlSZXBlYXRlZFJ1bGUgPSBpbmRpcmVjdGx5UmVwZWF0UnVsZShpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sIGxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucywgcnVsZU1hcCksXG4gICAgICAgIGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMgPSByZXdyaXRlSW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyhpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sIGxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyksXG4gICAgICAgIGFkZGVkTGVmdFJlY3Vyc2l2ZURlZmluaXRpb24gPSByZXdyaXRlTGVmdFJlY3Vyc2l2ZURlZmluaXRpb24oaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCBpbmRpcmVjdGx5UmVwZWF0ZWRSdWxlKSwgLy8vXG4gICAgICAgIHJlbW92ZWRMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMgPSBbXG4gICAgICAgICAgbGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sXG4gICAgICAgICAgLi4uaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uc1xuICAgICAgICBdO1xuXG4gIGFtZW5kTGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zKGxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucywgcmVtb3ZlZExlZnRSZWN1cnNpdmVEZWZpbml0aW9ucywgYWRkZWRMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbik7XG59XG5cbmZ1bmN0aW9uIGRpcmVjdGx5UmVkdWNlUnVsZShpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sIGxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucywgcnVsZU1hcCkge1xuICBjb25zdCBydWxlID0gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLmdldFJ1bGUoKSxcbiAgICAgICAgZGlzYWxsb3dJc29sYXRlZCA9IGZhbHNlLFxuICAgICAgICBkaXJlY3RseVJlZHVjZWRSdWxlID0gRGlyZWN0bHlSZWR1Y2VkUnVsZS5mcm9tUnVsZUFuZExlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyhydWxlLCBsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMsIGRpc2FsbG93SXNvbGF0ZWQpO1xuXG4gIGlmIChkaXJlY3RseVJlZHVjZWRSdWxlICE9PSBudWxsKSB7XG4gICAgY29uc3QgZGlyZWN0bHlSZWR1Y2VkUnVsZU5hbWUgPSBkaXJlY3RseVJlZHVjZWRSdWxlLmdldE5hbWUoKTtcblxuICAgIHJ1bGVNYXBbZGlyZWN0bHlSZWR1Y2VkUnVsZU5hbWVdID0gZGlyZWN0bHlSZWR1Y2VkUnVsZTtcbiAgfVxufVxuXG5mdW5jdGlvbiBkaXJlY3RseVJlcGVhdFJ1bGUoZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiwgbGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zLCBydWxlTWFwKSB7XG4gIGNvbnN0IHJ1bGUgPSBkaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLmdldFJ1bGUoKSxcbiAgICAgICAgZGlyZWN0bHlSZXBlYXRlZFJ1bGUgPSBEaXJlY3RseVJlcGVhdGVkUnVsZS5mcm9tUnVsZUFuZExlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyhydWxlLCBsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMpLFxuICAgICAgICBkaXJlY3RseVJlcGVhdGVkUnVsZU5hbWUgPSBkaXJlY3RseVJlcGVhdGVkUnVsZS5nZXROYW1lKCk7XG5cbiAgcnVsZU1hcFtkaXJlY3RseVJlcGVhdGVkUnVsZU5hbWVdID0gZGlyZWN0bHlSZXBlYXRlZFJ1bGU7XG59XG5cbmZ1bmN0aW9uIGluZGlyZWN0bHlSZWR1Y2VSdWxlKGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiwgbGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zLCBydWxlTWFwKSB7XG4gIGNvbnN0IHJ1bGUgPSBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24uZ2V0UnVsZSgpLFxuICAgICAgICBydWxlTmFtZSA9IHJ1bGUuZ2V0TmFtZSgpLFxuICAgICAgICBpbmRpcmVjdGx5UmVkdWNlZFJ1bGVOYW1lID0gaW5kaXJlY3RseVJlZHVjZWRSdWxlTmFtZUZyb21SdWxlTmFtZShydWxlTmFtZSksXG4gICAgICAgIGluZGlyZWN0bHlSZWR1Y2VkUnVsZSA9IHJ1bGVNYXBbaW5kaXJlY3RseVJlZHVjZWRSdWxlTmFtZV0gfHwgSW5kaXJlY3RseVJlZHVjZWRSdWxlLmZyb21SdWxlQW5kTGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zKHJ1bGUsIGxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyk7ICAvLy9cblxuICBpZiAoaW5kaXJlY3RseVJlZHVjZWRSdWxlICE9PSBudWxsKSB7XG4gICAgY29uc3QgcmVwbGFjZW1lbnREZWZpbml0aW9uID0gUmVwbGFjZW1lbnREZWZpbml0aW9uLmZyb21JbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25BbmRJbmRpcmVjdGx5UmVkdWNlZFJ1bGUoaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCBpbmRpcmVjdGx5UmVkdWNlZFJ1bGUpLFxuICAgICAgICAgIGxlZnRSZWN1cnNpdmVEZWZpbml0aW9uID0gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLmdldExlZnRSZWN1cnNpdmVEZWZpbml0aW9uKCksXG4gICAgICAgICAgcnVsZSA9IGxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLmdldFJ1bGUoKSxcbiAgICAgICAgICBkZWZpbml0aW9uID0gcmVwbGFjZW1lbnREZWZpbml0aW9uOyAvLy9cblxuICAgIHJ1bGVNYXBbaW5kaXJlY3RseVJlZHVjZWRSdWxlTmFtZV0gPSBpbmRpcmVjdGx5UmVkdWNlZFJ1bGU7XG5cbiAgICBydWxlLmFkZERlZmluaXRpb24oZGVmaW5pdGlvbik7XG4gIH1cbn1cblxuZnVuY3Rpb24gaW5kaXJlY3RseVJlcGVhdFJ1bGUoaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCBsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMsIHJ1bGVNYXApIHtcbiAgY29uc3QgcnVsZSA9IGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbi5nZXRSdWxlKCksXG4gICAgICAgIGxlZnRSZWN1cnNpdmVSdWxlTmFtZSA9IGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbi5nZXRMZWZ0UmVjdXJzaXZlUnVsZU5hbWUoKSxcbiAgICAgICAgaW5kaXJlY3RseVJlcGVhdGVkUnVsZSA9IEluZGlyZWN0bHlSZXBlYXRlZFJ1bGUuZnJvbVJ1bGVMZWZ0UmVjdXJzaXZlUnVsZU5hbWVBbmRMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMocnVsZSwgbGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lLCBsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMpLFxuICAgICAgICBpbmRpcmVjdGx5UmVwZWF0ZWRSdWxlTmFtZSA9IGluZGlyZWN0bHlSZXBlYXRlZFJ1bGUuZ2V0TmFtZSgpO1xuXG4gIHJ1bGVNYXBbaW5kaXJlY3RseVJlcGVhdGVkUnVsZU5hbWVdID0gaW5kaXJlY3RseVJlcGVhdGVkUnVsZTtcblxuICByZXR1cm4gaW5kaXJlY3RseVJlcGVhdGVkUnVsZTtcbn1cblxuZnVuY3Rpb24gYW1lbmRMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMobGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zLCByZW1vdmVkTGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zLCAuLi5hZGRlZExlZnRSZWN1cnNpdmVEZWZpbml0aW9ucykge1xuICBmaWx0ZXIobGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zLCAobGVmdFJlY3Vyc2l2ZURlZmluaXRpb24pID0+IHtcbiAgICBjb25zdCByZW1vdmVkTGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zSW5jbHVkZXNMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiA9IHJlbW92ZWRMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMuaW5jbHVkZXMobGVmdFJlY3Vyc2l2ZURlZmluaXRpb24pO1xuXG4gICAgaWYgKCFyZW1vdmVkTGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zSW5jbHVkZXNMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbikge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9KTtcblxuICBwdXNoKGxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucywgYWRkZWRMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMpO1xufVxuXG5mdW5jdGlvbiByZXdyaXRlTGVmdFJlY3Vyc2l2ZURlZmluaXRpb24oaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCBpbmRpcmVjdGx5UmVwZWF0ZWRSdWxlKSB7XG4gIGxldCBsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiA9IGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbi5nZXRMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbigpO1xuXG4gIGNvbnN0IGxlYXN0ID0gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLmlzTGVhc3QoKSxcbiAgICAgICAgcmVwbGFjZWREZWZpbml0aW9uID0gbGVmdFJlY3Vyc2l2ZURlZmluaXRpb24uZ2V0RGVmaW5pdGlvbigpLCAvLy9cbiAgICAgICAgcmVwbGFjZW1lbnREZWZpbml0aW9uID0gUmVwbGFjZW1lbnREZWZpbml0aW9uLmZyb21JbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25BbmRJbmRpcmVjdGx5UmVwZWF0ZWRSdWxlKGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiwgaW5kaXJlY3RseVJlcGVhdGVkUnVsZSksXG4gICAgICAgIHJ1bGUgPSBsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbi5nZXRSdWxlKCksXG4gICAgICAgIGRlZmluaXRpb24gPSByZXBsYWNlbWVudERlZmluaXRpb247IC8vL1xuXG4gIGxlZnRSZWN1cnNpdmVEZWZpbml0aW9uID0gbGVhc3QgP1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbi5mcm9tUnVsZUFuZERlZmluaXRpb24ocnVsZSwgZGVmaW5pdGlvbikgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24uZnJvbUluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbkFuZERlZmluaXRpb24oaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCBkZWZpbml0aW9uKTtcblxuICBjb25zdCBkZWZpbml0aW9ucyA9IHJ1bGUuZ2V0RGVmaW5pdGlvbnMoKSxcbiAgICAgICAgZGVmaW5pdGlvbnNJbmNsdWRlc1JlcGxhY2VkRGVmaW5pdGlvbiA9IGRlZmluaXRpb25zLmluY2x1ZGVzKHJlcGxhY2VkRGVmaW5pdGlvbik7XG5cbiAgZGVmaW5pdGlvbnNJbmNsdWRlc1JlcGxhY2VkRGVmaW5pdGlvbiA/XG4gICAgcnVsZS5yZXBsYWNlRGVmaW5pdGlvbihyZXBsYWNlZERlZmluaXRpb24sIHJlcGxhY2VtZW50RGVmaW5pdGlvbikgOlxuICAgICAgcnVsZS5hZGREZWZpbml0aW9uKGRlZmluaXRpb24pO1xuXG4gIHJldHVybiBsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbjtcbn1cblxuZnVuY3Rpb24gZmluZERpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24ocnVsZSwgbGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zKSB7XG4gIGNvbnN0IGRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zID0gbGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zLmZpbmQoKGxlZnRSZWN1cnNpdmVEZWZpbml0aW9uKSA9PiB7XG4gICAgY29uc3QgbGVmdFJlY3Vyc2l2ZURlZmluaXRpb25SdWxlID0gbGVmdFJlY3Vyc2l2ZURlZmluaXRpb24uZ2V0UnVsZSgpO1xuXG4gICAgaWYgKGxlZnRSZWN1cnNpdmVEZWZpbml0aW9uUnVsZSA9PT0gcnVsZSkge1xuICAgICAgY29uc3QgbGVmdFJlY3Vyc2l2ZURlZmluaXRpb25EaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uID0gKGxlZnRSZWN1cnNpdmVEZWZpbml0aW9uIGluc3RhbmNlb2YgRGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbik7XG5cbiAgICAgIGlmIChsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbkRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24pIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgfVxuICB9KSB8fCBudWxsO1xuXG4gIHJldHVybiBkaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucztcbn1cblxuZnVuY3Rpb24gZmluZERpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zKHJ1bGUsIGxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucykge1xuICBjb25zdCBkaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyA9IGZpbmQobGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zLCAobGVmdFJlY3Vyc2l2ZURlZmluaXRpb24pID0+IHtcbiAgICBjb25zdCBsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvblJ1bGUgPSBsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbi5nZXRSdWxlKCk7XG5cbiAgICBpZiAobGVmdFJlY3Vyc2l2ZURlZmluaXRpb25SdWxlID09PSBydWxlKSB7XG4gICAgICBjb25zdCBsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbkRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24gPSAobGVmdFJlY3Vyc2l2ZURlZmluaXRpb24gaW5zdGFuY2VvZiBEaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uKTtcblxuICAgICAgaWYgKGxlZnRSZWN1cnNpdmVEZWZpbml0aW9uRGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbikge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBkaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucztcbn1cblxuZnVuY3Rpb24gZmluZEluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMocnVsZSwgbGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zLCBsZWZ0UmVjdXJzaXZlUnVsZU5hbWUgPSBudWxsKSB7XG4gIGNvbnN0IGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMgPSBmaW5kKGxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucywgKGxlZnRSZWN1cnNpdmVEZWZpbml0aW9uKSA9PiB7XG4gICAgY29uc3QgbGVmdFJlY3Vyc2l2ZURlZmluaXRpb25SdWxlID0gbGVmdFJlY3Vyc2l2ZURlZmluaXRpb24uZ2V0UnVsZSgpO1xuXG4gICAgaWYgKGxlZnRSZWN1cnNpdmVEZWZpbml0aW9uUnVsZSA9PT0gcnVsZSkge1xuICAgICAgY29uc3QgbGVmdFJlY3Vyc2l2ZURlZmluaXRpb25JbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24gPSAobGVmdFJlY3Vyc2l2ZURlZmluaXRpb24gaW5zdGFuY2VvZiBJbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24pO1xuXG4gICAgICBpZiAobGVmdFJlY3Vyc2l2ZURlZmluaXRpb25JbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24pIHtcbiAgICAgICAgaWYgKGxlZnRSZWN1cnNpdmVSdWxlTmFtZSA9PT0gbnVsbCkge1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uID0gbGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sICAvLy9cbiAgICAgICAgICAgICAgaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uTGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lID0gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLmdldExlZnRSZWN1cnNpdmVSdWxlTmFtZSgpO1xuXG4gICAgICAgIGlmIChpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25MZWZ0UmVjdXJzaXZlUnVsZU5hbWUgPT09IGxlZnRSZWN1cnNpdmVSdWxlTmFtZSkge1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucztcbn1cblxuZnVuY3Rpb24gcmV3cml0ZURpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zKGRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sIGxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucykge1xuICBjb25zdCBydWxlID0gZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbi5nZXRSdWxlKCksXG4gICAgICAgIGRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zID0gZmluZERpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zKHJ1bGUsIGxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyksXG4gICAgICAgIGRlZmluaXRpb25zID0gZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMubWFwKChkaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uKSA9PiB7XG4gICAgICAgICAgY29uc3QgZGVmaW5pdGlvbiA9IGRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24uZ2V0RGVmaW5pdGlvbigpO1xuXG4gICAgICAgICAgcmV0dXJuIGRlZmluaXRpb247XG4gICAgICAgIH0pO1xuXG4gIHJ1bGUucmVtb3ZlRGVmaW5pdGlvbnMoZGVmaW5pdGlvbnMpO1xuXG4gIHJldHVybiBkaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucztcbn1cblxuZnVuY3Rpb24gcmV3cml0ZUluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMoaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCBsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMpIHtcbiAgY29uc3QgcnVsZSA9IGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbi5nZXRSdWxlKCksXG4gICAgICAgIHJlcGxhY2VkRGVmaW5pdGlvbiA9IGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbi5nZXREZWZpbml0aW9uKCksIC8vL1xuICAgICAgICBsZWZ0UmVjdXJzaXZlUnVsZU5hbWUgPSBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24uZ2V0TGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lKCksXG4gICAgICAgIGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMgPSBmaW5kSW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyhydWxlLCBsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMsIGxlZnRSZWN1cnNpdmVSdWxlTmFtZSksXG4gICAgICAgIGRlZmluaXRpb25zID0gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucy5tYXAoKGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbikgPT4ge1xuICAgICAgICAgIGNvbnN0IGRlZmluaXRpb24gPSBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24uZ2V0RGVmaW5pdGlvbigpO1xuXG4gICAgICAgICAgcmV0dXJuIGRlZmluaXRpb247XG4gICAgICAgIH0pLFxuICAgICAgICByZXBsYWNlbWVudERlZmluaXRpb24gPSBSZXBsYWNlbWVudERlZmluaXRpb24uZnJvbUluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbihpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sIGxlZnRSZWN1cnNpdmVSdWxlTmFtZSk7ICAvLy9cblxuICBydWxlLnJlcGxhY2VEZWZpbml0aW9uKHJlcGxhY2VkRGVmaW5pdGlvbiwgcmVwbGFjZW1lbnREZWZpbml0aW9uKTtcblxuICBydWxlLnJlbW92ZURlZmluaXRpb25zKGRlZmluaXRpb25zKTtcblxuICByZXR1cm4gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucztcbn1cblxuZnVuY3Rpb24gcmV0cmlldmVHcmVhdGVzdEluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbihsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMpIHtcbiAgbGV0IGdyZWF0ZXN0SW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uID0gbnVsbDtcblxuICBjb25zdCBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zID0gZmluZChsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMsIChsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbikgPT4ge1xuICAgIGNvbnN0IGxlZnRSZWN1cnNpdmVEZWZpbml0aW9uSW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uID0gKGxlZnRSZWN1cnNpdmVEZWZpbml0aW9uIGluc3RhbmNlb2YgSW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uKTtcblxuICAgIGlmIChsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbkluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbikge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9KTtcblxuICBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zLmZvckVhY2goKGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbikgPT4ge1xuICAgIGlmIChncmVhdGVzdEluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiA9PT0gbnVsbCkge1xuICAgICAgZ3JlYXRlc3RJbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24gPSBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb247IC8vL1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25HcmVhdGVyVGhhbkdyZWF0ZXN0SW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uID0gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLmlzR3JlYXRlclRoYW4oZ3JlYXRlc3RJbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24pO1xuXG4gICAgICBpZiAoaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uR3JlYXRlclRoYW5HcmVhdGVzdEluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbikge1xuICAgICAgICBncmVhdGVzdEluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiA9IGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbjsgLy8vXG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gZ3JlYXRlc3RJbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb247XG59XG4iXSwibmFtZXMiOlsiZWxpbWluYXRlSW5kaXJlY3RMZWZ0UmVjdXJzaW9uIiwiZmluZCIsImFycmF5VXRpbGl0aWVzIiwicHVzaCIsImZpbHRlciIsImNvdW50IiwibGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zIiwicnVsZU1hcCIsImdyZWF0ZXN0SW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uIiwicmV0cmlldmVHcmVhdGVzdEluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiIsImluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiIsInJ1bGUiLCJnZXRSdWxlIiwiZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiIsImZpbmREaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uIiwicmV3cml0ZURpcmVjdExlZnRSZWN1cnNpb24iLCJyZXdyaXRlSW5kaXJlY3RMZWZ0UmVjdXJzaW9uIiwiSW5maW5pdHkiLCJkaXJlY3RseVJlcGVhdFJ1bGUiLCJkaXJlY3RseVJlZHVjZVJ1bGUiLCJkaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyIsInJld3JpdGVEaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyIsImxlZnRSZWN1cnNpdmVEZWZpbml0aW9uIiwiZ2V0TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24iLCJpbmRpcmVjdGx5UmVkdWNlUnVsZSIsImluZGlyZWN0bHlSZXBlYXRlZFJ1bGUiLCJpbmRpcmVjdGx5UmVwZWF0UnVsZSIsImluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMiLCJyZXdyaXRlSW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyIsImFkZGVkTGVmdFJlY3Vyc2l2ZURlZmluaXRpb24iLCJyZXdyaXRlTGVmdFJlY3Vyc2l2ZURlZmluaXRpb24iLCJyZW1vdmVkTGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zIiwiYW1lbmRMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMiLCJkaXNhbGxvd0lzb2xhdGVkIiwiZGlyZWN0bHlSZWR1Y2VkUnVsZSIsIkRpcmVjdGx5UmVkdWNlZFJ1bGUiLCJmcm9tUnVsZUFuZExlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyIsImRpcmVjdGx5UmVkdWNlZFJ1bGVOYW1lIiwiZ2V0TmFtZSIsImRpcmVjdGx5UmVwZWF0ZWRSdWxlIiwiRGlyZWN0bHlSZXBlYXRlZFJ1bGUiLCJkaXJlY3RseVJlcGVhdGVkUnVsZU5hbWUiLCJydWxlTmFtZSIsImluZGlyZWN0bHlSZWR1Y2VkUnVsZU5hbWUiLCJpbmRpcmVjdGx5UmVkdWNlZFJ1bGVOYW1lRnJvbVJ1bGVOYW1lIiwiaW5kaXJlY3RseVJlZHVjZWRSdWxlIiwiSW5kaXJlY3RseVJlZHVjZWRSdWxlIiwicmVwbGFjZW1lbnREZWZpbml0aW9uIiwiUmVwbGFjZW1lbnREZWZpbml0aW9uIiwiZnJvbUluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbkFuZEluZGlyZWN0bHlSZWR1Y2VkUnVsZSIsImRlZmluaXRpb24iLCJhZGREZWZpbml0aW9uIiwibGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lIiwiZ2V0TGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lIiwiSW5kaXJlY3RseVJlcGVhdGVkUnVsZSIsImZyb21SdWxlTGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lQW5kTGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zIiwiaW5kaXJlY3RseVJlcGVhdGVkUnVsZU5hbWUiLCJhZGRlZExlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyIsInJlbW92ZWRMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnNJbmNsdWRlc0xlZnRSZWN1cnNpdmVEZWZpbml0aW9uIiwiaW5jbHVkZXMiLCJsZWFzdCIsImlzTGVhc3QiLCJyZXBsYWNlZERlZmluaXRpb24iLCJnZXREZWZpbml0aW9uIiwiZnJvbUluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbkFuZEluZGlyZWN0bHlSZXBlYXRlZFJ1bGUiLCJEaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uIiwiZnJvbVJ1bGVBbmREZWZpbml0aW9uIiwiSW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uIiwiZnJvbUluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbkFuZERlZmluaXRpb24iLCJkZWZpbml0aW9ucyIsImdldERlZmluaXRpb25zIiwiZGVmaW5pdGlvbnNJbmNsdWRlc1JlcGxhY2VkRGVmaW5pdGlvbiIsInJlcGxhY2VEZWZpbml0aW9uIiwibGVmdFJlY3Vyc2l2ZURlZmluaXRpb25SdWxlIiwibGVmdFJlY3Vyc2l2ZURlZmluaXRpb25EaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uIiwiZmluZERpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zIiwiZmluZEluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMiLCJsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbkluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiIsImluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbkxlZnRSZWN1cnNpdmVSdWxlTmFtZSIsIm1hcCIsInJlbW92ZURlZmluaXRpb25zIiwiZnJvbUluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiIsImZvckVhY2giLCJpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25HcmVhdGVyVGhhbkdyZWF0ZXN0SW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uIiwiaXNHcmVhdGVyVGhhbiJdLCJtYXBwaW5ncyI6IkFBQUEsWUFBWSxDQUFDOzs7OytCQWtCYixTQWNDOzs7ZUFkdUJBLDhCQUE4Qjs7O3lCQWhCdkIsV0FBVzs2REFFVix5QkFBeUI7OERBQ3hCLDBCQUEwQjswRUFDekIseUJBQXlCOytEQUN6QiwyQkFBMkI7Z0VBQzFCLDRCQUE0Qjs4REFDbkIscUNBQXFDO2dFQUNuQyx1Q0FBdUM7d0JBRS9CLHNCQUFzQjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFNUUsSUFBUUMsSUFBSSxHQUFtQkMsVUFBYyxlQUFBLENBQXJD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