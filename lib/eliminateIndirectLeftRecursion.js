"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "default", {
    enumerable: true,
    get: function() {
        return eliminateIndirectLeftRecursion;
    }
});
var _necessary = require("necessary");
var _definition = /*#__PURE__*/ _interopRequireDefault(require("./definition"));
var _directly = /*#__PURE__*/ _interopRequireDefault(require("./rule/reduced/directly"));
var _directly1 = /*#__PURE__*/ _interopRequireDefault(require("./rule/repeated/directly"));
var _indirectly = /*#__PURE__*/ _interopRequireDefault(require("./rule/reduced/indirectly"));
var _indirectly1 = /*#__PURE__*/ _interopRequireDefault(require("./rule/repeated/indirectly"));
var _left = /*#__PURE__*/ _interopRequireDefault(require("./recursiveDefinition/left"));
var _directly2 = /*#__PURE__*/ _interopRequireDefault(require("./recursiveDefinition/left/directly"));
var _indirectly2 = /*#__PURE__*/ _interopRequireDefault(require("./recursiveDefinition/left/indirectly"));
var _ruleName = require("./utilities/ruleName");
function _arrayLikeToArray(arr, len) {
    if (len == null || len > arr.length) len = arr.length;
    for(var i = 0, arr2 = new Array(len); i < len; i++)arr2[i] = arr[i];
    return arr2;
}
function _arrayWithoutHoles(arr) {
    if (Array.isArray(arr)) return _arrayLikeToArray(arr);
}
function _instanceof(left, right) {
    if (right != null && typeof Symbol !== "undefined" && right[Symbol.hasInstance]) {
        return !!right[Symbol.hasInstance](left);
    } else {
        return left instanceof right;
    }
}
function _interopRequireDefault(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
function _iterableToArray(iter) {
    if (typeof Symbol !== "undefined" && iter[Symbol.iterator] != null || iter["@@iterator"] != null) return Array.from(iter);
}
function _nonIterableSpread() {
    throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
}
function _toConsumableArray(arr) {
    return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();
}
function _unsupportedIterableToArray(o, minLen) {
    if (!o) return;
    if (typeof o === "string") return _arrayLikeToArray(o, minLen);
    var n = Object.prototype.toString.call(o).slice(8, -1);
    if (n === "Object" && o.constructor) n = o.constructor.name;
    if (n === "Map" || n === "Set") return Array.from(n);
    if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);
}
var find = _necessary.arrayUtilities.find, push = _necessary.arrayUtilities.push, first = _necessary.arrayUtilities.first, filter = _necessary.arrayUtilities.filter;
var count = 0;
function eliminateIndirectLeftRecursion(leftRecursiveDefinitions, ruleMap) {
    var greatestIndirectlyLeftRecursiveDefinition = retrieveGreatestIndirectlyLeftRecursiveDefinition(leftRecursiveDefinitions);
    while(greatestIndirectlyLeftRecursiveDefinition !== null){
        var indirectlyLeftRecursiveDefinition = greatestIndirectlyLeftRecursiveDefinition, rule = indirectlyLeftRecursiveDefinition.getRule(), directlyLeftRecursiveDefinition = findDirectlyLeftRecursiveDefinition(rule, leftRecursiveDefinitions);
        directlyLeftRecursiveDefinition !== null ? rewriteDirectLeftRecursion(directlyLeftRecursiveDefinition, indirectlyLeftRecursiveDefinition, leftRecursiveDefinitions, ruleMap) : rewriteIndirectLeftRecursion(indirectlyLeftRecursiveDefinition, leftRecursiveDefinitions, ruleMap);
        greatestIndirectlyLeftRecursiveDefinition = ++count > Infinity ? null : retrieveGreatestIndirectlyLeftRecursiveDefinition(leftRecursiveDefinitions);
    }
}
function rewriteDirectLeftRecursion(directlyLeftRecursiveDefinition, indirectlyLeftRecursiveDefinition, leftRecursiveDefinitions, ruleMap) {
    var _rule;
    var ruleName = indirectlyLeftRecursiveDefinition.getRuleName(), rule = ruleMap[ruleName];
    var disallowIsolated = false, directlyReducedRule = _directly.default.fromRule(rule, disallowIsolated);
    var directlyReducedRuleName = null;
    if (directlyReducedRule !== null) {
        directlyReducedRuleName = directlyReducedRule.getName();
        ruleMap[directlyReducedRuleName] = directlyReducedRule;
    }
    var directlyRepeatedRule = _directly1.default.fromRule(rule), directlyRepeatedRuleName = directlyRepeatedRule.getName();
    ruleMap[directlyRepeatedRuleName] = directlyRepeatedRule;
    var definitions = rule.getDefinitions(), directlyLeftRecursiveDefinitions = findDirectlyLeftRecursiveDefinitions(definitions);
    var indirectlyLeftRecursiveDefinitions = findIndirectlyLeftRecursiveDefinitions(definitions);
    var removedLeftRecursiveDefinitions = _toConsumableArray(directlyLeftRecursiveDefinitions).concat(_toConsumableArray(indirectlyLeftRecursiveDefinitions));
    indirectlyLeftRecursiveDefinitions = indirectlyLeftRecursiveDefinitions.map(function(indirectlyLeftRecursiveDefinition) {
        indirectlyLeftRecursiveDefinition = _indirectly2.default.fromIndirectlyLeftRecursiveDefinitionAndDirectlyRepeatedRuleName(indirectlyLeftRecursiveDefinition, directlyRepeatedRuleName); ///
        return indirectlyLeftRecursiveDefinition;
    });
    var replacementDefinitions = _toConsumableArray(indirectlyLeftRecursiveDefinitions);
    if (directlyReducedRuleName !== null) {
        var leftRecursiveDefinition = _left.default.fromDirectlyReducedRuleNameAndDirectlyRepeatedRuleName(directlyReducedRuleName, directlyRepeatedRuleName);
        replacementDefinitions = _toConsumableArray(replacementDefinitions).concat([
            leftRecursiveDefinition
        ]);
    }
    (_rule = rule).replaceAllDefinitions.apply(_rule, _toConsumableArray(replacementDefinitions));
    var addedLeftRecursiveDefinitions = indirectlyLeftRecursiveDefinitions; ///
    amendLeftRecursiveDefinitions.apply(void 0, [
        leftRecursiveDefinitions,
        removedLeftRecursiveDefinitions
    ].concat(_toConsumableArray(addedLeftRecursiveDefinitions)));
}
function rewriteIndirectLeftRecursion(indirectlyLeftRecursiveDefinition, leftRecursiveDefinitions, ruleMap) {
    var leftRecursiveDefinition = indirectlyLeftRecursiveDefinition.getLeftRecursiveDefinition();
    indirectlyReduceRule(indirectlyLeftRecursiveDefinition, leftRecursiveDefinitions, ruleMap);
    var indirectlyRepeatedRule = indirectlyRepeatRule(indirectlyLeftRecursiveDefinition, leftRecursiveDefinitions, ruleMap), indirectlyLeftRecursiveDefinitions = rewriteIndirectlyLeftRecursiveDefinitions(indirectlyLeftRecursiveDefinition, leftRecursiveDefinitions), addedLeftRecursiveDefinition = rewriteLeftRecursiveDefinition(indirectlyLeftRecursiveDefinition, indirectlyRepeatedRule), removedLeftRecursiveDefinitions = [
        leftRecursiveDefinition
    ].concat(_toConsumableArray(indirectlyLeftRecursiveDefinitions));
    amendLeftRecursiveDefinitions(leftRecursiveDefinitions, removedLeftRecursiveDefinitions, addedLeftRecursiveDefinition);
// const directLeftRecursiveReplacementDefinition = least ?  ///
//                                                    DirectlyLeftRecursiveReplacementDefinition.fromIndirectlyLeftRecursiveDefinitionLeftRecursiveDefinitionAndIndirectlyRepeatedRuleName(indirectlyLeftRecursiveDefinition, leftRecursiveDefinition, indirectlyRepeatedRuleName) :  ///
//                                                      null;  ///IndirectlyLeftRecursiveDefinition.fromIndirectlyLeftRecursiveDefinitionLeftRecursiveDefinitionAndIndirectlyRepeatedRuleName(indirectlyLeftRecursiveDefinition, leftRecursiveDefinition, indirectlyRepeatedRuleName),  ///
//
// const leftRecursiveDefinitionRule = leftRecursiveDefinition.getRule();
//
// leftRecursiveDefinitionRule.addDefinition(directLeftRecursiveReplacementDefinition);
//
// definition = leftRecursiveDefinition.getDefinition();
//
// leftRecursiveDefinitionRule.removeDefinition(definition);
//
// if (secondReplacementDefinition !== null) {
//   leftRecursiveDefinitionRule.addDefinition(secondReplacementDefinition);
// }
}
function indirectlyReduceRule(indirectlyLeftRecursiveDefinition, leftRecursiveDefinitions, ruleMap) {
    var rule = indirectlyLeftRecursiveDefinition.getRule(), ruleName = rule.getName(), indirectlyReducedRuleName = (0, _ruleName.indirectlyReducedRuleNameFromRuleName)(ruleName), indirectlyReducedRule = ruleMap[indirectlyReducedRuleName] || _indirectly.default.fromRuleAndLeftRecursiveDefinitions(rule, leftRecursiveDefinitions); ///
    if (indirectlyReducedRule !== null) {
        var leftRecursiveDefinition = indirectlyLeftRecursiveDefinition.getLeftRecursiveDefinition(), rule1 = leftRecursiveDefinition.getRule(), definition = _definition.default.fromIndirectlyLeftRecursiveDefinitionAndIndirectlyReducedRule(indirectlyLeftRecursiveDefinition, indirectlyReducedRule);
        ruleMap[indirectlyReducedRuleName] = indirectlyReducedRule;
        rule1.addDefinition(definition);
    }
}
function indirectlyRepeatRule(indirectlyLeftRecursiveDefinition, leftRecursiveDefinitions, ruleMap) {
    var rule = indirectlyLeftRecursiveDefinition.getRule(), leftRecursiveRuleName = indirectlyLeftRecursiveDefinition.getLeftRecursiveRuleName(), indirectlyRepeatedRule = _indirectly1.default.fromRuleLeftRecursiveRuleNameAndLeftRecursiveDefinitions(rule, leftRecursiveRuleName, leftRecursiveDefinitions), indirectlyRepeatedRuleName = indirectlyRepeatedRule.getName();
    ruleMap[indirectlyRepeatedRuleName] = indirectlyRepeatedRule;
    return indirectlyRepeatedRule;
}
function amendLeftRecursiveDefinitions(leftRecursiveDefinitions, removedLeftRecursiveDefinitions) {
    for(var _len = arguments.length, addedLeftRecursiveDefinitions = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++){
        addedLeftRecursiveDefinitions[_key - 2] = arguments[_key];
    }
    filter(leftRecursiveDefinitions, function(leftRecursiveDefinition) {
        var removedLeftRecursiveDefinitionsIncludesLeftRecursiveDefinition = removedLeftRecursiveDefinitions.includes(leftRecursiveDefinition);
        if (!removedLeftRecursiveDefinitionsIncludesLeftRecursiveDefinition) {
            return true;
        }
    });
    push(leftRecursiveDefinitions, addedLeftRecursiveDefinitions);
}
function rewriteLeftRecursiveDefinition(indirectlyLeftRecursiveDefinition, indirectlyRepeatedRule) {
    var leftRecursiveDefinition = indirectlyLeftRecursiveDefinition.getLeftRecursiveDefinition();
    var least = indirectlyLeftRecursiveDefinition.isLeast(), rule = leftRecursiveDefinition.getRule(), definition = _definition.default.fromIndirectlyLeftRecursiveDefinitionAndIndirectlyRepeatedRule(indirectlyLeftRecursiveDefinition, indirectlyRepeatedRule), replacedDefinition = leftRecursiveDefinition.getDefinition(), replacementDefinition = definition; ///
    leftRecursiveDefinition = least ? _directly2.default.fromRuleAndDefinition(rule, definition) : _indirectly2.default.fromIndirectlyLeftRecursiveDefinitionAndDefinition(indirectlyLeftRecursiveDefinition, definition);
    rule.replaceDefinition(replacedDefinition, replacementDefinition);
    return leftRecursiveDefinition;
}
function findDirectlyLeftRecursiveDefinition(rule, leftRecursiveDefinitions) {
    var directlyLeftRecursiveDefinitions = leftRecursiveDefinitions.find(function(leftRecursiveDefinition) {
        var leftRecursiveDefinitionRule = leftRecursiveDefinition.getRule();
        if (leftRecursiveDefinitionRule === rule) {
            var leftRecursiveDefinitionDirectlyLeftRecursiveDefinition = _instanceof(leftRecursiveDefinition, _directly2.default);
            if (leftRecursiveDefinitionDirectlyLeftRecursiveDefinition) {
                return true;
            }
        }
    }) || null;
    return directlyLeftRecursiveDefinitions;
}
function findDirectlyLeftRecursiveDefinitions(rule, leftRecursiveDefinitions) {
    var directlyLeftRecursiveDefinitions = find(leftRecursiveDefinitions, function(leftRecursiveDefinition) {
        var leftRecursiveDefinitionRule = leftRecursiveDefinition.getRule();
        if (leftRecursiveDefinitionRule === rule) {
            var leftRecursiveDefinitionDirectlyLeftRecursiveDefinition = _instanceof(leftRecursiveDefinition, _directly2.default);
            if (leftRecursiveDefinitionDirectlyLeftRecursiveDefinition) {
                return true;
            }
        }
    });
    return directlyLeftRecursiveDefinitions;
}
function findIndirectlyLeftRecursiveDefinitions(rule, leftRecursiveDefinitions) {
    var leftRecursiveRuleName = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : null;
    var indirectlyLeftRecursiveDefinitions = find(leftRecursiveDefinitions, function(leftRecursiveDefinition) {
        var leftRecursiveDefinitionRule = leftRecursiveDefinition.getRule();
        if (leftRecursiveDefinitionRule === rule) {
            var leftRecursiveDefinitionIndirectlyLeftRecursiveDefinition = _instanceof(leftRecursiveDefinition, _indirectly2.default);
            if (leftRecursiveDefinitionIndirectlyLeftRecursiveDefinition) {
                if (leftRecursiveRuleName === null) {
                    return true;
                }
                var indirectlyLeftRecursiveDefinition = leftRecursiveDefinition, indirectlyLeftRecursiveDefinitionLeftRecursiveRuleName = indirectlyLeftRecursiveDefinition.getLeftRecursiveRuleName();
                if (indirectlyLeftRecursiveDefinitionLeftRecursiveRuleName === leftRecursiveRuleName) {
                    return true;
                }
            }
        }
    });
    return indirectlyLeftRecursiveDefinitions;
}
function rewriteIndirectlyLeftRecursiveDefinitions(indirectlyLeftRecursiveDefinition, leftRecursiveDefinitions) {
    var rule = indirectlyLeftRecursiveDefinition.getRule(), replacedDefinition = indirectlyLeftRecursiveDefinition.getDefinition(), leftRecursiveRuleName = indirectlyLeftRecursiveDefinition.getLeftRecursiveRuleName(), indirectlyLeftRecursiveDefinitions = findIndirectlyLeftRecursiveDefinitions(rule, leftRecursiveDefinitions, leftRecursiveRuleName), definitions = indirectlyLeftRecursiveDefinitions.map(function(indirectlyLeftRecursiveDefinition) {
        var definition = indirectlyLeftRecursiveDefinition.getDefinition();
        return definition;
    }), replacementDefinition = _definition.default.fromIndirectlyLeftRecursiveDefinition(indirectlyLeftRecursiveDefinition, leftRecursiveRuleName); ///
    rule.replaceDefinition(replacedDefinition, replacementDefinition);
    rule.removeDefinitions(definitions);
    return indirectlyLeftRecursiveDefinitions;
}
function retrieveGreatestIndirectlyLeftRecursiveDefinition(leftRecursiveDefinitions) {
    var greatestIndirectlyLeftRecursiveDefinition = null;
    var indirectlyLeftRecursiveDefinitions = find(leftRecursiveDefinitions, function(leftRecursiveDefinition) {
        var leftRecursiveDefinitionIndirectlyLeftRecursiveDefinition = _instanceof(leftRecursiveDefinition, _indirectly2.default);
        if (leftRecursiveDefinitionIndirectlyLeftRecursiveDefinition) {
            return true;
        }
    });
    indirectlyLeftRecursiveDefinitions.forEach(function(indirectlyLeftRecursiveDefinition) {
        if (greatestIndirectlyLeftRecursiveDefinition === null) {
            greatestIndirectlyLeftRecursiveDefinition = indirectlyLeftRecursiveDefinition; ///
        } else {
            var indirectlyLeftRecursiveDefinitionGreaterThanGreatestIndirectlyLeftRecursiveDefinition = indirectlyLeftRecursiveDefinition.isGreaterThan(greatestIndirectlyLeftRecursiveDefinition);
            if (indirectlyLeftRecursiveDefinitionGreaterThanGreatestIndirectlyLeftRecursiveDefinition) {
                greatestIndirectlyLeftRecursiveDefinition = indirectlyLeftRecursiveDefinition; ///
            }
        }
    });
    return greatestIndirectlyLeftRecursiveDefinition;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9lbGltaW5hdGVJbmRpcmVjdExlZnRSZWN1cnNpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbmltcG9ydCB7IGFycmF5VXRpbGl0aWVzIH0gZnJvbSBcIm5lY2Vzc2FyeVwiO1xuXG5pbXBvcnQgRGVmaW5pdGlvbiBmcm9tIFwiLi9kZWZpbml0aW9uXCI7XG5pbXBvcnQgRGlyZWN0bHlSZWR1Y2VkUnVsZSBmcm9tIFwiLi9ydWxlL3JlZHVjZWQvZGlyZWN0bHlcIjtcbmltcG9ydCBEaXJlY3RseVJlcGVhdGVkUnVsZSBmcm9tIFwiLi9ydWxlL3JlcGVhdGVkL2RpcmVjdGx5XCI7XG5pbXBvcnQgSW5kaXJlY3RseVJlZHVjZWRSdWxlIGZyb20gXCIuL3J1bGUvcmVkdWNlZC9pbmRpcmVjdGx5XCI7XG5pbXBvcnQgSW5kaXJlY3RseVJlcGVhdGVkUnVsZSBmcm9tIFwiLi9ydWxlL3JlcGVhdGVkL2luZGlyZWN0bHlcIjtcbmltcG9ydCBMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiBmcm9tIFwiLi9yZWN1cnNpdmVEZWZpbml0aW9uL2xlZnRcIjtcbmltcG9ydCBEaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uIGZyb20gXCIuL3JlY3Vyc2l2ZURlZmluaXRpb24vbGVmdC9kaXJlY3RseVwiO1xuaW1wb3J0IEluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiBmcm9tIFwiLi9yZWN1cnNpdmVEZWZpbml0aW9uL2xlZnQvaW5kaXJlY3RseVwiO1xuXG5pbXBvcnQgeyBpbmRpcmVjdGx5UmVkdWNlZFJ1bGVOYW1lRnJvbVJ1bGVOYW1lIH0gZnJvbSBcIi4vdXRpbGl0aWVzL3J1bGVOYW1lXCI7XG5cbmNvbnN0IHsgZmluZCwgcHVzaCwgZmlyc3QsIGZpbHRlciB9ID0gYXJyYXlVdGlsaXRpZXM7XG5cbmxldCBjb3VudCA9IDA7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGVsaW1pbmF0ZUluZGlyZWN0TGVmdFJlY3Vyc2lvbihsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMsIHJ1bGVNYXApIHtcbiAgbGV0IGdyZWF0ZXN0SW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uID0gcmV0cmlldmVHcmVhdGVzdEluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbihsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMpO1xuXG4gIHdoaWxlIChncmVhdGVzdEluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiAhPT0gbnVsbCkge1xuICAgIGNvbnN0IGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiA9IGdyZWF0ZXN0SW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCAvLy9cbiAgICAgICAgICBydWxlID0gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLmdldFJ1bGUoKSxcbiAgICAgICAgICBkaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uID0gZmluZERpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24ocnVsZSwgbGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zKTtcblxuICAgIChkaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uICE9PSBudWxsKSA/XG4gICAgICByZXdyaXRlRGlyZWN0TGVmdFJlY3Vyc2lvbihkaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sIGxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucywgcnVsZU1hcCkgOlxuICAgICAgICByZXdyaXRlSW5kaXJlY3RMZWZ0UmVjdXJzaW9uKGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiwgbGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zLCBydWxlTWFwKTtcblxuICAgIGdyZWF0ZXN0SW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uID0gKytjb3VudCA+IEluZmluaXR5ID8gbnVsbCA6IHJldHJpZXZlR3JlYXRlc3RJbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24obGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zKTtcbiAgfVxufVxuXG5mdW5jdGlvbiByZXdyaXRlRGlyZWN0TGVmdFJlY3Vyc2lvbihkaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sIGxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucywgcnVsZU1hcCkge1xuICBjb25zdCBydWxlTmFtZSA9IGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbi5nZXRSdWxlTmFtZSgpLFxuICAgICAgICBydWxlID0gcnVsZU1hcFtydWxlTmFtZV07XG5cbiAgY29uc3QgZGlzYWxsb3dJc29sYXRlZCA9IGZhbHNlLFxuICAgICAgICBkaXJlY3RseVJlZHVjZWRSdWxlID0gRGlyZWN0bHlSZWR1Y2VkUnVsZS5mcm9tUnVsZShydWxlLCBkaXNhbGxvd0lzb2xhdGVkKTtcblxuICBsZXQgZGlyZWN0bHlSZWR1Y2VkUnVsZU5hbWUgPSBudWxsO1xuXG4gIGlmIChkaXJlY3RseVJlZHVjZWRSdWxlICE9PSBudWxsKSB7XG4gICAgZGlyZWN0bHlSZWR1Y2VkUnVsZU5hbWUgPSBkaXJlY3RseVJlZHVjZWRSdWxlLmdldE5hbWUoKTtcblxuICAgIHJ1bGVNYXBbZGlyZWN0bHlSZWR1Y2VkUnVsZU5hbWVdID0gZGlyZWN0bHlSZWR1Y2VkUnVsZTtcbiAgfVxuXG4gIGNvbnN0IGRpcmVjdGx5UmVwZWF0ZWRSdWxlID0gRGlyZWN0bHlSZXBlYXRlZFJ1bGUuZnJvbVJ1bGUocnVsZSksXG4gICAgICAgIGRpcmVjdGx5UmVwZWF0ZWRSdWxlTmFtZSA9IGRpcmVjdGx5UmVwZWF0ZWRSdWxlLmdldE5hbWUoKTtcblxuICBydWxlTWFwW2RpcmVjdGx5UmVwZWF0ZWRSdWxlTmFtZV0gPSBkaXJlY3RseVJlcGVhdGVkUnVsZTtcblxuICBjb25zdCBkZWZpbml0aW9ucyA9IHJ1bGUuZ2V0RGVmaW5pdGlvbnMoKSxcbiAgICAgICAgZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMgPSBmaW5kRGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMoZGVmaW5pdGlvbnMpO1xuXG4gIGxldCBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zID0gZmluZEluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMoZGVmaW5pdGlvbnMpO1xuXG4gIGNvbnN0IHJlbW92ZWRMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMgPSBbXG4gICAgLi4uZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMsXG4gICAgLi4uaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uc1xuICBdO1xuXG4gIGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMgPSBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zLm1hcCgoaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uKSA9PiB7XG4gICAgaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uID0gSW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLmZyb21JbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25BbmREaXJlY3RseVJlcGVhdGVkUnVsZU5hbWUoaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCBkaXJlY3RseVJlcGVhdGVkUnVsZU5hbWUpOyAgLy8vXG5cbiAgICByZXR1cm4gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uO1xuICB9KTtcblxuICBsZXQgcmVwbGFjZW1lbnREZWZpbml0aW9ucyA9IFtcbiAgICAuLi5pbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zXG4gIF07XG5cbiAgaWYgKGRpcmVjdGx5UmVkdWNlZFJ1bGVOYW1lICE9PSBudWxsKSB7XG4gICAgY29uc3QgbGVmdFJlY3Vyc2l2ZURlZmluaXRpb24gPSBMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbi5mcm9tRGlyZWN0bHlSZWR1Y2VkUnVsZU5hbWVBbmREaXJlY3RseVJlcGVhdGVkUnVsZU5hbWUoZGlyZWN0bHlSZWR1Y2VkUnVsZU5hbWUsIGRpcmVjdGx5UmVwZWF0ZWRSdWxlTmFtZSk7XG5cbiAgICByZXBsYWNlbWVudERlZmluaXRpb25zID0gW1xuICAgICAgLi4ucmVwbGFjZW1lbnREZWZpbml0aW9ucyxcbiAgICAgIGxlZnRSZWN1cnNpdmVEZWZpbml0aW9uXG4gICAgXTtcbiAgfVxuXG4gIHJ1bGUucmVwbGFjZUFsbERlZmluaXRpb25zKC4uLnJlcGxhY2VtZW50RGVmaW5pdGlvbnMpO1xuXG4gIGNvbnN0IGFkZGVkTGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zID0gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uczsgLy8vXG5cbiAgYW1lbmRMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMobGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zLCByZW1vdmVkTGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zLCAuLi5hZGRlZExlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyk7XG59XG5cbmZ1bmN0aW9uIHJld3JpdGVJbmRpcmVjdExlZnRSZWN1cnNpb24oaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCBsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMsIHJ1bGVNYXApIHtcbiAgY29uc3QgbGVmdFJlY3Vyc2l2ZURlZmluaXRpb24gPSBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24uZ2V0TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24oKTtcblxuICBpbmRpcmVjdGx5UmVkdWNlUnVsZShpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sIGxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucywgcnVsZU1hcCk7XG5cbiAgY29uc3QgaW5kaXJlY3RseVJlcGVhdGVkUnVsZSA9IGluZGlyZWN0bHlSZXBlYXRSdWxlKGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiwgbGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zLCBydWxlTWFwKSxcbiAgICAgICAgaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyA9IHJld3JpdGVJbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zKGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiwgbGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zKSxcbiAgICAgICAgYWRkZWRMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiA9IHJld3JpdGVMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbihpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sIGluZGlyZWN0bHlSZXBlYXRlZFJ1bGUpLCAvLy9cbiAgICAgICAgcmVtb3ZlZExlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyA9IFtcbiAgICAgICAgICBsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbixcbiAgICAgICAgICAuLi5pbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zXG4gICAgICAgIF07XG5cbiAgYW1lbmRMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMobGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zLCByZW1vdmVkTGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zLCBhZGRlZExlZnRSZWN1cnNpdmVEZWZpbml0aW9uKTtcblxuICAvLyBjb25zdCBkaXJlY3RMZWZ0UmVjdXJzaXZlUmVwbGFjZW1lbnREZWZpbml0aW9uID0gbGVhc3QgPyAgLy8vXG4gIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERpcmVjdGx5TGVmdFJlY3Vyc2l2ZVJlcGxhY2VtZW50RGVmaW5pdGlvbi5mcm9tSW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uTGVmdFJlY3Vyc2l2ZURlZmluaXRpb25BbmRJbmRpcmVjdGx5UmVwZWF0ZWRSdWxlTmFtZShpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sIGxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCBpbmRpcmVjdGx5UmVwZWF0ZWRSdWxlTmFtZSkgOiAgLy8vXG4gIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVsbDsgIC8vL0luZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbi5mcm9tSW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uTGVmdFJlY3Vyc2l2ZURlZmluaXRpb25BbmRJbmRpcmVjdGx5UmVwZWF0ZWRSdWxlTmFtZShpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sIGxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCBpbmRpcmVjdGx5UmVwZWF0ZWRSdWxlTmFtZSksICAvLy9cbiAgLy9cbiAgLy8gY29uc3QgbGVmdFJlY3Vyc2l2ZURlZmluaXRpb25SdWxlID0gbGVmdFJlY3Vyc2l2ZURlZmluaXRpb24uZ2V0UnVsZSgpO1xuICAvL1xuICAvLyBsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvblJ1bGUuYWRkRGVmaW5pdGlvbihkaXJlY3RMZWZ0UmVjdXJzaXZlUmVwbGFjZW1lbnREZWZpbml0aW9uKTtcbiAgLy9cbiAgLy8gZGVmaW5pdGlvbiA9IGxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLmdldERlZmluaXRpb24oKTtcbiAgLy9cbiAgLy8gbGVmdFJlY3Vyc2l2ZURlZmluaXRpb25SdWxlLnJlbW92ZURlZmluaXRpb24oZGVmaW5pdGlvbik7XG4gIC8vXG4gIC8vIGlmIChzZWNvbmRSZXBsYWNlbWVudERlZmluaXRpb24gIT09IG51bGwpIHtcbiAgLy8gICBsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvblJ1bGUuYWRkRGVmaW5pdGlvbihzZWNvbmRSZXBsYWNlbWVudERlZmluaXRpb24pO1xuICAvLyB9XG59XG5cbmZ1bmN0aW9uIGluZGlyZWN0bHlSZWR1Y2VSdWxlKGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiwgbGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zLCBydWxlTWFwKSB7XG4gIGNvbnN0IHJ1bGUgPSBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24uZ2V0UnVsZSgpLFxuICAgICAgICBydWxlTmFtZSA9IHJ1bGUuZ2V0TmFtZSgpLFxuICAgICAgICBpbmRpcmVjdGx5UmVkdWNlZFJ1bGVOYW1lID0gaW5kaXJlY3RseVJlZHVjZWRSdWxlTmFtZUZyb21SdWxlTmFtZShydWxlTmFtZSksXG4gICAgICAgIGluZGlyZWN0bHlSZWR1Y2VkUnVsZSA9IHJ1bGVNYXBbaW5kaXJlY3RseVJlZHVjZWRSdWxlTmFtZV0gfHwgSW5kaXJlY3RseVJlZHVjZWRSdWxlLmZyb21SdWxlQW5kTGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zKHJ1bGUsIGxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyk7ICAvLy9cblxuICBpZiAoaW5kaXJlY3RseVJlZHVjZWRSdWxlICE9PSBudWxsKSB7XG4gICAgY29uc3QgbGVmdFJlY3Vyc2l2ZURlZmluaXRpb24gPSBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24uZ2V0TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24oKSxcbiAgICAgICAgICBydWxlID0gbGVmdFJlY3Vyc2l2ZURlZmluaXRpb24uZ2V0UnVsZSgpLFxuICAgICAgICAgIGRlZmluaXRpb24gPSBEZWZpbml0aW9uLmZyb21JbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25BbmRJbmRpcmVjdGx5UmVkdWNlZFJ1bGUoaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCBpbmRpcmVjdGx5UmVkdWNlZFJ1bGUpO1xuXG4gICAgcnVsZU1hcFtpbmRpcmVjdGx5UmVkdWNlZFJ1bGVOYW1lXSA9IGluZGlyZWN0bHlSZWR1Y2VkUnVsZTtcblxuICAgIHJ1bGUuYWRkRGVmaW5pdGlvbihkZWZpbml0aW9uKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBpbmRpcmVjdGx5UmVwZWF0UnVsZShpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sIGxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucywgcnVsZU1hcCkge1xuICBjb25zdCBydWxlID0gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLmdldFJ1bGUoKSxcbiAgICAgICAgbGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lID0gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLmdldExlZnRSZWN1cnNpdmVSdWxlTmFtZSgpLFxuICAgICAgICBpbmRpcmVjdGx5UmVwZWF0ZWRSdWxlID0gSW5kaXJlY3RseVJlcGVhdGVkUnVsZS5mcm9tUnVsZUxlZnRSZWN1cnNpdmVSdWxlTmFtZUFuZExlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyhydWxlLCBsZWZ0UmVjdXJzaXZlUnVsZU5hbWUsIGxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyksXG4gICAgICAgIGluZGlyZWN0bHlSZXBlYXRlZFJ1bGVOYW1lID0gaW5kaXJlY3RseVJlcGVhdGVkUnVsZS5nZXROYW1lKCk7XG5cbiAgcnVsZU1hcFtpbmRpcmVjdGx5UmVwZWF0ZWRSdWxlTmFtZV0gPSBpbmRpcmVjdGx5UmVwZWF0ZWRSdWxlO1xuXG4gIHJldHVybiBpbmRpcmVjdGx5UmVwZWF0ZWRSdWxlO1xufVxuXG5mdW5jdGlvbiBhbWVuZExlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyhsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMsIHJlbW92ZWRMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMsIC4uLmFkZGVkTGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zKSB7XG4gIGZpbHRlcihsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMsIChsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbikgPT4ge1xuICAgIGNvbnN0IHJlbW92ZWRMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnNJbmNsdWRlc0xlZnRSZWN1cnNpdmVEZWZpbml0aW9uID0gcmVtb3ZlZExlZnRSZWN1cnNpdmVEZWZpbml0aW9ucy5pbmNsdWRlcyhsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbik7XG5cbiAgICBpZiAoIXJlbW92ZWRMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnNJbmNsdWRlc0xlZnRSZWN1cnNpdmVEZWZpbml0aW9uKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH0pO1xuXG4gIHB1c2gobGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zLCBhZGRlZExlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyk7XG59XG5cbmZ1bmN0aW9uIHJld3JpdGVMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbihpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sIGluZGlyZWN0bHlSZXBlYXRlZFJ1bGUpIHtcbiAgbGV0IGxlZnRSZWN1cnNpdmVEZWZpbml0aW9uID0gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLmdldExlZnRSZWN1cnNpdmVEZWZpbml0aW9uKCk7XG5cbiAgY29uc3QgbGVhc3QgPSBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24uaXNMZWFzdCgpLFxuICAgICAgICBydWxlID0gbGVmdFJlY3Vyc2l2ZURlZmluaXRpb24uZ2V0UnVsZSgpLFxuICAgICAgICBkZWZpbml0aW9uID0gRGVmaW5pdGlvbi5mcm9tSW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uQW5kSW5kaXJlY3RseVJlcGVhdGVkUnVsZShpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sIGluZGlyZWN0bHlSZXBlYXRlZFJ1bGUpLCAvLy9cbiAgICAgICAgcmVwbGFjZWREZWZpbml0aW9uID0gbGVmdFJlY3Vyc2l2ZURlZmluaXRpb24uZ2V0RGVmaW5pdGlvbigpLCAvLy9cbiAgICAgICAgcmVwbGFjZW1lbnREZWZpbml0aW9uID0gZGVmaW5pdGlvbjsgLy8vXG5cbiAgbGVmdFJlY3Vyc2l2ZURlZmluaXRpb24gPSBsZWFzdCA/XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLmZyb21SdWxlQW5kRGVmaW5pdGlvbihydWxlLCBkZWZpbml0aW9uKSA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbi5mcm9tSW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uQW5kRGVmaW5pdGlvbihpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sIGRlZmluaXRpb24pO1xuXG4gIHJ1bGUucmVwbGFjZURlZmluaXRpb24ocmVwbGFjZWREZWZpbml0aW9uLCByZXBsYWNlbWVudERlZmluaXRpb24pO1xuXG4gIHJldHVybiBsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbjtcbn1cblxuZnVuY3Rpb24gZmluZERpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24ocnVsZSwgbGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zKSB7XG4gIGNvbnN0IGRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zID0gbGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zLmZpbmQoKGxlZnRSZWN1cnNpdmVEZWZpbml0aW9uKSA9PiB7XG4gICAgY29uc3QgbGVmdFJlY3Vyc2l2ZURlZmluaXRpb25SdWxlID0gbGVmdFJlY3Vyc2l2ZURlZmluaXRpb24uZ2V0UnVsZSgpO1xuXG4gICAgaWYgKGxlZnRSZWN1cnNpdmVEZWZpbml0aW9uUnVsZSA9PT0gcnVsZSkge1xuICAgICAgY29uc3QgbGVmdFJlY3Vyc2l2ZURlZmluaXRpb25EaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uID0gKGxlZnRSZWN1cnNpdmVEZWZpbml0aW9uIGluc3RhbmNlb2YgRGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbik7XG5cbiAgICAgIGlmIChsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbkRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24pIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgfVxuICB9KSB8fCBudWxsO1xuXG4gIHJldHVybiBkaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucztcbn1cblxuZnVuY3Rpb24gZmluZERpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zKHJ1bGUsIGxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucykge1xuICBjb25zdCBkaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyA9IGZpbmQobGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zLCAobGVmdFJlY3Vyc2l2ZURlZmluaXRpb24pID0+IHtcbiAgICBjb25zdCBsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvblJ1bGUgPSBsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbi5nZXRSdWxlKCk7XG5cbiAgICBpZiAobGVmdFJlY3Vyc2l2ZURlZmluaXRpb25SdWxlID09PSBydWxlKSB7XG4gICAgICBjb25zdCBsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbkRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24gPSAobGVmdFJlY3Vyc2l2ZURlZmluaXRpb24gaW5zdGFuY2VvZiBEaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uKTtcblxuICAgICAgaWYgKGxlZnRSZWN1cnNpdmVEZWZpbml0aW9uRGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbikge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBkaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucztcbn1cblxuZnVuY3Rpb24gZmluZEluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMocnVsZSwgbGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zLCBsZWZ0UmVjdXJzaXZlUnVsZU5hbWUgPSBudWxsKSB7XG4gIGNvbnN0IGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMgPSBmaW5kKGxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucywgKGxlZnRSZWN1cnNpdmVEZWZpbml0aW9uKSA9PiB7XG4gICAgY29uc3QgbGVmdFJlY3Vyc2l2ZURlZmluaXRpb25SdWxlID0gbGVmdFJlY3Vyc2l2ZURlZmluaXRpb24uZ2V0UnVsZSgpO1xuXG4gICAgaWYgKGxlZnRSZWN1cnNpdmVEZWZpbml0aW9uUnVsZSA9PT0gcnVsZSkge1xuICAgICAgY29uc3QgbGVmdFJlY3Vyc2l2ZURlZmluaXRpb25JbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24gPSAobGVmdFJlY3Vyc2l2ZURlZmluaXRpb24gaW5zdGFuY2VvZiBJbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24pO1xuXG4gICAgICBpZiAobGVmdFJlY3Vyc2l2ZURlZmluaXRpb25JbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24pIHtcbiAgICAgICAgaWYgKGxlZnRSZWN1cnNpdmVSdWxlTmFtZSA9PT0gbnVsbCkge1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uID0gbGVmdFJlY3Vyc2l2ZURlZmluaXRpb24sICAvLy9cbiAgICAgICAgICAgICAgaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uTGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lID0gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLmdldExlZnRSZWN1cnNpdmVSdWxlTmFtZSgpO1xuXG4gICAgICAgIGlmIChpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25MZWZ0UmVjdXJzaXZlUnVsZU5hbWUgPT09IGxlZnRSZWN1cnNpdmVSdWxlTmFtZSkge1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucztcbn1cblxuZnVuY3Rpb24gcmV3cml0ZUluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMoaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCBsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMpIHtcbiAgY29uc3QgcnVsZSA9IGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbi5nZXRSdWxlKCksXG4gICAgICAgIHJlcGxhY2VkRGVmaW5pdGlvbiA9IGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbi5nZXREZWZpbml0aW9uKCksIC8vL1xuICAgICAgICBsZWZ0UmVjdXJzaXZlUnVsZU5hbWUgPSBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24uZ2V0TGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lKCksXG4gICAgICAgIGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMgPSBmaW5kSW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyhydWxlLCBsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMsIGxlZnRSZWN1cnNpdmVSdWxlTmFtZSksXG4gICAgICAgIGRlZmluaXRpb25zID0gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucy5tYXAoKGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbikgPT4ge1xuICAgICAgICAgIGNvbnN0IGRlZmluaXRpb24gPSBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24uZ2V0RGVmaW5pdGlvbigpO1xuXG4gICAgICAgICAgcmV0dXJuIGRlZmluaXRpb247XG4gICAgICAgIH0pLFxuICAgICAgICByZXBsYWNlbWVudERlZmluaXRpb24gPSBEZWZpbml0aW9uLmZyb21JbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24oaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uLCBsZWZ0UmVjdXJzaXZlUnVsZU5hbWUpOyAgLy8vXG5cbiAgcnVsZS5yZXBsYWNlRGVmaW5pdGlvbihyZXBsYWNlZERlZmluaXRpb24sIHJlcGxhY2VtZW50RGVmaW5pdGlvbik7XG5cbiAgcnVsZS5yZW1vdmVEZWZpbml0aW9ucyhkZWZpbml0aW9ucyk7XG5cbiAgcmV0dXJuIGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnM7XG59XG5cbmZ1bmN0aW9uIHJldHJpZXZlR3JlYXRlc3RJbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24obGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zKSB7XG4gIGxldCBncmVhdGVzdEluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiA9IG51bGw7XG5cbiAgY29uc3QgaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyA9IGZpbmQobGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zLCAobGVmdFJlY3Vyc2l2ZURlZmluaXRpb24pID0+IHtcbiAgICBjb25zdCBsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbkluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiA9IChsZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiBpbnN0YW5jZW9mIEluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbik7XG5cbiAgICBpZiAobGVmdFJlY3Vyc2l2ZURlZmluaXRpb25JbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24pIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfSk7XG5cbiAgaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucy5mb3JFYWNoKChpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24pID0+IHtcbiAgICBpZiAoZ3JlYXRlc3RJbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24gPT09IG51bGwpIHtcbiAgICAgIGdyZWF0ZXN0SW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uID0gaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uOyAvLy9cbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uR3JlYXRlclRoYW5HcmVhdGVzdEluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiA9IGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbi5pc0dyZWF0ZXJUaGFuKGdyZWF0ZXN0SW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uKTtcblxuICAgICAgaWYgKGluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbkdyZWF0ZXJUaGFuR3JlYXRlc3RJbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24pIHtcbiAgICAgICAgZ3JlYXRlc3RJbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24gPSBpbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb247IC8vL1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIGdyZWF0ZXN0SW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uO1xufVxuIl0sIm5hbWVzIjpbImVsaW1pbmF0ZUluZGlyZWN0TGVmdFJlY3Vyc2lvbiIsImZpbmQiLCJhcnJheVV0aWxpdGllcyIsInB1c2giLCJmaXJzdCIsImZpbHRlciIsImNvdW50IiwibGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zIiwicnVsZU1hcCIsImdyZWF0ZXN0SW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uIiwicmV0cmlldmVHcmVhdGVzdEluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiIsImluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiIsInJ1bGUiLCJnZXRSdWxlIiwiZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiIsImZpbmREaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uIiwicmV3cml0ZURpcmVjdExlZnRSZWN1cnNpb24iLCJyZXdyaXRlSW5kaXJlY3RMZWZ0UmVjdXJzaW9uIiwiSW5maW5pdHkiLCJydWxlTmFtZSIsImdldFJ1bGVOYW1lIiwiZGlzYWxsb3dJc29sYXRlZCIsImRpcmVjdGx5UmVkdWNlZFJ1bGUiLCJEaXJlY3RseVJlZHVjZWRSdWxlIiwiZnJvbVJ1bGUiLCJkaXJlY3RseVJlZHVjZWRSdWxlTmFtZSIsImdldE5hbWUiLCJkaXJlY3RseVJlcGVhdGVkUnVsZSIsIkRpcmVjdGx5UmVwZWF0ZWRSdWxlIiwiZGlyZWN0bHlSZXBlYXRlZFJ1bGVOYW1lIiwiZGVmaW5pdGlvbnMiLCJnZXREZWZpbml0aW9ucyIsImRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zIiwiZmluZERpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zIiwiaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyIsImZpbmRJbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zIiwicmVtb3ZlZExlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyIsIm1hcCIsIkluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiIsImZyb21JbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb25BbmREaXJlY3RseVJlcGVhdGVkUnVsZU5hbWUiLCJyZXBsYWNlbWVudERlZmluaXRpb25zIiwibGVmdFJlY3Vyc2l2ZURlZmluaXRpb24iLCJMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiIsImZyb21EaXJlY3RseVJlZHVjZWRSdWxlTmFtZUFuZERpcmVjdGx5UmVwZWF0ZWRSdWxlTmFtZSIsInJlcGxhY2VBbGxEZWZpbml0aW9ucyIsImFkZGVkTGVmdFJlY3Vyc2l2ZURlZmluaXRpb25zIiwiYW1lbmRMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMiLCJnZXRMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiIsImluZGlyZWN0bHlSZWR1Y2VSdWxlIiwiaW5kaXJlY3RseVJlcGVhdGVkUnVsZSIsImluZGlyZWN0bHlSZXBlYXRSdWxlIiwicmV3cml0ZUluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMiLCJhZGRlZExlZnRSZWN1cnNpdmVEZWZpbml0aW9uIiwicmV3cml0ZUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uIiwiaW5kaXJlY3RseVJlZHVjZWRSdWxlTmFtZSIsImluZGlyZWN0bHlSZWR1Y2VkUnVsZU5hbWVGcm9tUnVsZU5hbWUiLCJpbmRpcmVjdGx5UmVkdWNlZFJ1bGUiLCJJbmRpcmVjdGx5UmVkdWNlZFJ1bGUiLCJmcm9tUnVsZUFuZExlZnRSZWN1cnNpdmVEZWZpbml0aW9ucyIsImRlZmluaXRpb24iLCJEZWZpbml0aW9uIiwiZnJvbUluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbkFuZEluZGlyZWN0bHlSZWR1Y2VkUnVsZSIsImFkZERlZmluaXRpb24iLCJsZWZ0UmVjdXJzaXZlUnVsZU5hbWUiLCJnZXRMZWZ0UmVjdXJzaXZlUnVsZU5hbWUiLCJJbmRpcmVjdGx5UmVwZWF0ZWRSdWxlIiwiZnJvbVJ1bGVMZWZ0UmVjdXJzaXZlUnVsZU5hbWVBbmRMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnMiLCJpbmRpcmVjdGx5UmVwZWF0ZWRSdWxlTmFtZSIsInJlbW92ZWRMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbnNJbmNsdWRlc0xlZnRSZWN1cnNpdmVEZWZpbml0aW9uIiwiaW5jbHVkZXMiLCJsZWFzdCIsImlzTGVhc3QiLCJmcm9tSW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uQW5kSW5kaXJlY3RseVJlcGVhdGVkUnVsZSIsInJlcGxhY2VkRGVmaW5pdGlvbiIsImdldERlZmluaXRpb24iLCJyZXBsYWNlbWVudERlZmluaXRpb24iLCJEaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uIiwiZnJvbVJ1bGVBbmREZWZpbml0aW9uIiwiZnJvbUluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbkFuZERlZmluaXRpb24iLCJyZXBsYWNlRGVmaW5pdGlvbiIsImxlZnRSZWN1cnNpdmVEZWZpbml0aW9uUnVsZSIsImxlZnRSZWN1cnNpdmVEZWZpbml0aW9uRGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiIsImxlZnRSZWN1cnNpdmVEZWZpbml0aW9uSW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uIiwiaW5kaXJlY3RseUxlZnRSZWN1cnNpdmVEZWZpbml0aW9uTGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lIiwiZnJvbUluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbiIsInJlbW92ZURlZmluaXRpb25zIiwiZm9yRWFjaCIsImluZGlyZWN0bHlMZWZ0UmVjdXJzaXZlRGVmaW5pdGlvbkdyZWF0ZXJUaGFuR3JlYXRlc3RJbmRpcmVjdGx5TGVmdFJlY3Vyc2l2ZURlZmluaXRpb24iLCJpc0dyZWF0ZXJUaGFuIl0sIm1hcHBpbmdzIjoiQUFBQSxZQUFZLENBQUM7Ozs7K0JBbUJiLFNBY0M7OztlQWR1QkEsOEJBQThCOzs7eUJBakJ2QixXQUFXOytEQUVuQixjQUFjOzZEQUNMLHlCQUF5Qjs4REFDeEIsMEJBQTBCOytEQUN6QiwyQkFBMkI7Z0VBQzFCLDRCQUE0Qjt5REFDM0IsNEJBQTRCOzhEQUNwQixxQ0FBcUM7Z0VBQ25DLHVDQUF1Qzt3QkFFL0Isc0JBQXNCOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUU1RSxJQUFRQyxJQUFJLEdBQTBCQyxVQUFjLGVBQUEsQ0FBNUNELElBQUksRUFBRUUsSUFBSSxHQUFvQkQsVUFBYyxlQUFBLENBQXRDQyxJQUFJLEVBQUVDLEtBQUssR0FBYUYsVUFBYyxlQUFBLENBQWhDRSxLQUFLLEVBQUVDLE1BQU0sR0FBS0gsVUFBYyxlQUFBLENBQXpCRyxNQUFNLEFBQW9CO0FBRXJELElBQUlDLEtBQUssR0FBRyxDQUFDLEFBQUM7QUFFQyxTQUFTTiw4QkFBOEIsQ0FBQ08sd0JBQXdCLEVBQUVDLE9BQU8sRUFBRTtJQUN4RixJQUFJQyx5Q0FBeUMsR0FBR0MsaURBQWlELENBQUNILHdCQUF3QixDQUFDLEFBQUM7SUFFNUgsTUFBT0UseUNBQXlDLEtBQUssSUFBSSxDQUFFO1FBQ3pELElBQU1FLGlDQUFpQyxHQUFHRix5Q0FBeUMsRUFDN0VHLElBQUksR0FBR0QsaUNBQWlDLENBQUNFLE9BQU8sRUFBRSxFQUNsREMsK0JBQStCLEdBQUdDLG1DQUFt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