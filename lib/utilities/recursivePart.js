"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.recursiveRuleNamesFromPart = recursiveRuleNamesFromPart;
exports.leftRecursiveRuleNamesFromPart = leftRecursiveRuleNamesFromPart;

var _occamParsers = require("occam-parsers");

var _necessary = require("necessary");

var first = _necessary.arrayUtilities.first,
    RuleNamePartType = _occamParsers.partTypes.RuleNamePartType,
    OptionalPartPartType = _occamParsers.partTypes.OptionalPartPartType,
    GroupOfPartsPartType = _occamParsers.partTypes.GroupOfPartsPartType,
    ChoiceOfPartsPartType = _occamParsers.partTypes.ChoiceOfPartsPartType,
    OneOrMorePartsPartType = _occamParsers.partTypes.OneOrMorePartsPartType,
    ZeroOrMorePartsPartType = _occamParsers.partTypes.ZeroOrMorePartsPartType;

function recursiveRuleNamesFromPart(part, recursiveRuleNames) {
  var partNonTerminalPart = part.isNonTerminalPart();

  if (partNonTerminalPart) {
    var type = part.getType();

    switch (type) {
      case RuleNamePartType:
        {
          var ruleNamePart = part,
              ///
          ruleName = ruleNamePart.getRuleName(),
              recursiveRuleNamesIncludesRuleName = recursiveRuleNames.includes(ruleName);

          if (!recursiveRuleNamesIncludesRuleName) {
            var recursiveRuleName = ruleName; ///

            recursiveRuleNames.push(recursiveRuleName);
          }
        }
        break;

      case OptionalPartPartType:
        {
          var optionalPartPart = part; ///

          part = optionalPartPart.getPart();
          recursiveRuleNamesFromPart(part, recursiveRuleNames);
        }
        break;

      case OneOrMorePartsPartType:
        {
          var oneOrMorePartsPart = part; ///

          part = oneOrMorePartsPart.getPart();
          recursiveRuleNamesFromPart(part, recursiveRuleNames);
        }
        break;

      case ZeroOrMorePartsPartType:
        {
          var zeroOrMorePartsPart = part; ///

          part = zeroOrMorePartsPart.getPart(); ///

          recursiveRuleNamesFromPart(part, recursiveRuleNames);
        }
        break;

      case GroupOfPartsPartType:
        {
          var groupOfPartsPart = part,
              ///
          parts = groupOfPartsPart.getParts();
          parts.forEach(function (part) {
            return recursiveRuleNamesFromPart(part, recursiveRuleNames);
          });
        }
        break;

      case ChoiceOfPartsPartType:
        {
          var choiceOfPartsPart = part,
              ///
          _parts = choiceOfPartsPart.getParts();

          _parts.forEach(function (part) {
            return recursiveRuleNamesFromPart(part, recursiveRuleNames);
          });
        }
        break;
    }
  }
}

function leftRecursiveRuleNamesFromPart(part, leftRecursiveRuleNames) {
  var partNonTerminalPart = part.isNonTerminalPart();

  if (partNonTerminalPart) {
    var type = part.getType();

    switch (type) {
      case RuleNamePartType:
        {
          var ruleNamePart = part,
              ///
          ruleName = ruleNamePart.getRuleName(),
              leftRecursiveRuleNamesIncludesRuleName = leftRecursiveRuleNames.includes(ruleName);

          if (!leftRecursiveRuleNamesIncludesRuleName) {
            var leftRecursiveRuleName = ruleName; ///

            leftRecursiveRuleNames.push(leftRecursiveRuleName);
          }
        }
        break;

      case OptionalPartPartType:
        {
          var optionalPartPart = part; ///

          part = optionalPartPart.getPart();
          leftRecursiveRuleNamesFromPart(part, leftRecursiveRuleNames);
        }
        break;

      case OneOrMorePartsPartType:
        {
          var oneOrMorePartsPart = part; ///

          part = oneOrMorePartsPart.getPart();
          leftRecursiveRuleNamesFromPart(part, leftRecursiveRuleNames);
        }
        break;

      case ZeroOrMorePartsPartType:
        {
          var zeroOrMorePartsPart = part; ///

          part = zeroOrMorePartsPart.getPart();
          leftRecursiveRuleNamesFromPart(part, leftRecursiveRuleNames);
        }
        break;

      case GroupOfPartsPartType:
        {
          var groupOfPartsPart = part,
              ///
          parts = groupOfPartsPart.getParts(),
              firstPart = first(parts);
          part = firstPart; ///

          leftRecursiveRuleNamesFromPart(part, leftRecursiveRuleNames);
        }
        break;

      case ChoiceOfPartsPartType:
        {
          var choiceOfPartsPart = part,
              ///
          _parts2 = choiceOfPartsPart.getParts();

          _parts2.forEach(function (part) {
            return leftRecursiveRuleNamesFromPart(part, leftRecursiveRuleNames);
          });
        }
        break;
    }
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlY3Vyc2l2ZVBhcnQuanMiXSwibmFtZXMiOlsiZmlyc3QiLCJhcnJheVV0aWxpdGllcyIsIlJ1bGVOYW1lUGFydFR5cGUiLCJwYXJ0VHlwZXMiLCJPcHRpb25hbFBhcnRQYXJ0VHlwZSIsIkdyb3VwT2ZQYXJ0c1BhcnRUeXBlIiwiQ2hvaWNlT2ZQYXJ0c1BhcnRUeXBlIiwiT25lT3JNb3JlUGFydHNQYXJ0VHlwZSIsIlplcm9Pck1vcmVQYXJ0c1BhcnRUeXBlIiwicmVjdXJzaXZlUnVsZU5hbWVzRnJvbVBhcnQiLCJwYXJ0IiwicmVjdXJzaXZlUnVsZU5hbWVzIiwicGFydE5vblRlcm1pbmFsUGFydCIsImlzTm9uVGVybWluYWxQYXJ0IiwidHlwZSIsImdldFR5cGUiLCJydWxlTmFtZVBhcnQiLCJydWxlTmFtZSIsImdldFJ1bGVOYW1lIiwicmVjdXJzaXZlUnVsZU5hbWVzSW5jbHVkZXNSdWxlTmFtZSIsImluY2x1ZGVzIiwicmVjdXJzaXZlUnVsZU5hbWUiLCJwdXNoIiwib3B0aW9uYWxQYXJ0UGFydCIsImdldFBhcnQiLCJvbmVPck1vcmVQYXJ0c1BhcnQiLCJ6ZXJvT3JNb3JlUGFydHNQYXJ0IiwiZ3JvdXBPZlBhcnRzUGFydCIsInBhcnRzIiwiZ2V0UGFydHMiLCJmb3JFYWNoIiwiY2hvaWNlT2ZQYXJ0c1BhcnQiLCJsZWZ0UmVjdXJzaXZlUnVsZU5hbWVzRnJvbVBhcnQiLCJsZWZ0UmVjdXJzaXZlUnVsZU5hbWVzIiwibGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lc0luY2x1ZGVzUnVsZU5hbWUiLCJsZWZ0UmVjdXJzaXZlUnVsZU5hbWUiLCJmaXJzdFBhcnQiXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7OztBQUVBOztBQUNBOztBQUVNLElBQUVBLEtBQUYsR0FBWUMseUJBQVosQ0FBRUQsS0FBRjtBQUFBLElBQ0VFLGdCQURGLEdBTThCQyx1QkFOOUIsQ0FDRUQsZ0JBREY7QUFBQSxJQUVFRSxvQkFGRixHQU04QkQsdUJBTjlCLENBRUVDLG9CQUZGO0FB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QUFDRDs7QUFFRixXQUFLNUIsb0JBQUw7QUFBNEI7QUFDeEIsY0FBTXNCLGdCQUFnQixHQUFHakIsSUFBekI7QUFBQSxjQUFnQztBQUMxQmtCLFVBQUFBLEtBQUssR0FBR0QsZ0JBQWdCLENBQUNFLFFBQWpCLEVBRGQ7QUFBQSxjQUVNTyxTQUFTLEdBQUdwQyxLQUFLLENBQUM0QixLQUFELENBRnZCO0FBSUFsQixVQUFBQSxJQUFJLEdBQUcwQixTQUFQLENBTHdCLENBS047O0FBRWxCSixVQUFBQSw4QkFBOEIsQ0FBQ3RCLElBQUQsRUFBT3VCLHNCQUFQLENBQTlCO0FBQ0Q7QUFDRDs7QUFFRixXQUFLM0IscUJBQUw7QUFBNkI7QUFDekIsY0FBTXlCLGlCQUFpQixHQUFHckIsSUFBMUI7QUFBQSxjQUFnQztBQUMxQmtCLFVBQUFBLE9BQUssR0FBR0csaUJBQWlCLENBQUNGLFFBQWxCLEVBRGQ7O0FBR0FELFVBQUFBLE9BQUssQ0FBQ0UsT0FBTixDQUFjLFVBQUNwQixJQUFEO0FBQUEsbUJBQVVzQiw4QkFBOEIsQ0FBQ3RCLElBQUQsRUFBT3VCLHNCQUFQLENBQXhDO0FBQUEsV0FBZDtBQUNEO0FBQ0Q7QUExREo7QUE0REQ7QUFDRiIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG5pbXBvcnQgeyBwYXJ0VHlwZXMgfSBmcm9tIFwib2NjYW0tcGFyc2Vyc1wiO1xuaW1wb3J0IHsgYXJyYXlVdGlsaXRpZXMgfSBmcm9tIFwibmVjZXNzYXJ5XCI7XG5cbmNvbnN0IHsgZmlyc3QgfSA9IGFycmF5VXRpbGl0aWVzLFxuICAgICAgeyBSdWxlTmFtZVBhcnRUeXBlLFxuICAgICAgICBPcHRpb25hbFBhcnRQYXJ0VHlwZSxcbiAgICAgICAgR3JvdXBPZlBhcnRzUGFydFR5cGUsXG4gICAgICAgIENob2ljZU9mUGFydHNQYXJ0VHlwZSxcbiAgICAgICAgT25lT3JNb3JlUGFydHNQYXJ0VHlwZSxcbiAgICAgICAgWmVyb09yTW9yZVBhcnRzUGFydFR5cGUgfSA9IHBhcnRUeXBlcztcblxuZXhwb3J0IGZ1bmN0aW9uIHJlY3Vyc2l2ZVJ1bGVOYW1lc0Zyb21QYXJ0KHBhcnQsIHJlY3Vyc2l2ZVJ1bGVOYW1lcykge1xuICBjb25zdCBwYXJ0Tm9uVGVybWluYWxQYXJ0ID0gcGFydC5pc05vblRlcm1pbmFsUGFydCgpO1xuXG4gIGlmIChwYXJ0Tm9uVGVybWluYWxQYXJ0KSB7XG4gICAgY29uc3QgdHlwZSA9IHBhcnQuZ2V0VHlwZSgpO1xuXG4gICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICBjYXNlIFJ1bGVOYW1lUGFydFR5cGUgOiB7XG4gICAgICAgICAgY29uc3QgcnVsZU5hbWVQYXJ0ID0gcGFydCwgIC8vL1xuICAgICAgICAgICAgICAgIHJ1bGVOYW1lID0gcnVsZU5hbWVQYXJ0LmdldFJ1bGVOYW1lKCksXG4gICAgICAgICAgICAgICAgcmVjdXJzaXZlUnVsZU5hbWVzSW5jbHVkZXNSdWxlTmFtZSA9IHJlY3Vyc2l2ZVJ1bGVOYW1lcy5pbmNsdWRlcyhydWxlTmFtZSk7XG5cbiAgICAgICAgICBpZiAoIXJlY3Vyc2l2ZVJ1bGVOYW1lc0luY2x1ZGVzUnVsZU5hbWUpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlY3Vyc2l2ZVJ1bGVOYW1lID0gcnVsZU5hbWU7IC8vL1xuXG4gICAgICAgICAgICByZWN1cnNpdmVSdWxlTmFtZXMucHVzaChyZWN1cnNpdmVSdWxlTmFtZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIE9wdGlvbmFsUGFydFBhcnRUeXBlIDoge1xuICAgICAgICAgIGNvbnN0IG9wdGlvbmFsUGFydFBhcnQgPSBwYXJ0OyAgLy8vXG5cbiAgICAgICAgICBwYXJ0ID0gb3B0aW9uYWxQYXJ0UGFydC5nZXRQYXJ0KCk7XG5cbiAgICAgICAgICByZWN1cnNpdmVSdWxlTmFtZXNGcm9tUGFydChwYXJ0LCByZWN1cnNpdmVSdWxlTmFtZXMpO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIE9uZU9yTW9yZVBhcnRzUGFydFR5cGUgOiB7XG4gICAgICAgICAgY29uc3Qgb25lT3JNb3JlUGFydHNQYXJ0ID0gcGFydDsgIC8vL1xuXG4gICAgICAgICAgcGFydCA9IG9uZU9yTW9yZVBhcnRzUGFydC5nZXRQYXJ0KCk7XG5cbiAgICAgICAgICByZWN1cnNpdmVSdWxlTmFtZXNGcm9tUGFydChwYXJ0LCByZWN1cnNpdmVSdWxlTmFtZXMpO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIFplcm9Pck1vcmVQYXJ0c1BhcnRUeXBlIDoge1xuICAgICAgICAgIGNvbnN0IHplcm9Pck1vcmVQYXJ0c1BhcnQgPSBwYXJ0OyAvLy9cblxuICAgICAgICAgIHBhcnQgPSB6ZXJvT3JNb3JlUGFydHNQYXJ0LmdldFBhcnQoKTsgIC8vL1xuXG4gICAgICAgICAgcmVjdXJzaXZlUnVsZU5hbWVzRnJvbVBhcnQocGFydCwgcmVjdXJzaXZlUnVsZU5hbWVzKTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSBHcm91cE9mUGFydHNQYXJ0VHlwZSA6IHtcbiAgICAgICAgY29uc3QgZ3JvdXBPZlBhcnRzUGFydCA9IHBhcnQsICAvLy9cbiAgICAgICAgICAgICAgcGFydHMgPSBncm91cE9mUGFydHNQYXJ0LmdldFBhcnRzKCk7XG5cbiAgICAgICAgICBwYXJ0cy5mb3JFYWNoKChwYXJ0KSA9PiByZWN1cnNpdmVSdWxlTmFtZXNGcm9tUGFydChwYXJ0LCByZWN1cnNpdmVSdWxlTmFtZXMpKTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSBDaG9pY2VPZlBhcnRzUGFydFR5cGUgOiB7XG4gICAgICAgIGNvbnN0IGNob2ljZU9mUGFydHNQYXJ0ID0gcGFydCwgLy8vXG4gICAgICAgICAgICAgIHBhcnRzID0gY2hvaWNlT2ZQYXJ0c1BhcnQuZ2V0UGFydHMoKTtcblxuICAgICAgICAgIHBhcnRzLmZvckVhY2goKHBhcnQpID0+IHJlY3Vyc2l2ZVJ1bGVOYW1lc0Zyb21QYXJ0KHBhcnQsIHJlY3Vyc2l2ZVJ1bGVOYW1lcykpO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gbGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lc0Zyb21QYXJ0KHBhcnQsIGxlZnRSZWN1cnNpdmVSdWxlTmFtZXMpIHtcbiAgY29uc3QgcGFydE5vblRlcm1pbmFsUGFydCA9IHBhcnQuaXNOb25UZXJtaW5hbFBhcnQoKTtcblxuICBpZiAocGFydE5vblRlcm1pbmFsUGFydCkge1xuICAgIGNvbnN0IHR5cGUgPSBwYXJ0LmdldFR5cGUoKTtcblxuICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgY2FzZSBSdWxlTmFtZVBhcnRUeXBlIDoge1xuICAgICAgICAgIGNvbnN0IHJ1bGVOYW1lUGFydCA9IHBhcnQsICAvLy9cbiAgICAgICAgICAgICAgICBydWxlTmFtZSA9IHJ1bGVOYW1lUGFydC5nZXRSdWxlTmFtZSgpLFxuICAgICAgICAgICAgICAgIGxlZnRSZWN1cnNpdmVSdWxlTmFtZXNJbmNsdWRlc1J1bGVOYW1lID0gbGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lcy5pbmNsdWRlcyhydWxlTmFtZSk7XG5cbiAgICAgICAgICBpZiAoIWxlZnRSZWN1cnNpdmVSdWxlTmFtZXNJbmNsdWRlc1J1bGVOYW1lKSB7XG4gICAgICAgICAgICBjb25zdCBsZWZ0UmVjdXJzaXZlUnVsZU5hbWUgPSBydWxlTmFtZTsgLy8vXG5cbiAgICAgICAgICAgIGxlZnRSZWN1cnNpdmVSdWxlTmFtZXMucHVzaChsZWZ0UmVjdXJzaXZlUnVsZU5hbWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSBPcHRpb25hbFBhcnRQYXJ0VHlwZSA6IHtcbiAgICAgICAgICBjb25zdCBvcHRpb25hbFBhcnRQYXJ0ID0gcGFydDsgLy8vXG5cbiAgICAgICAgICBwYXJ0ID0gb3B0aW9uYWxQYXJ0UGFydC5nZXRQYXJ0KCk7XG5cbiAgICAgICAgICBsZWZ0UmVjdXJzaXZlUnVsZU5hbWVzRnJvbVBhcnQocGFydCwgbGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lcyk7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgT25lT3JNb3JlUGFydHNQYXJ0VHlwZSA6IHtcbiAgICAgICAgICBjb25zdCBvbmVPck1vcmVQYXJ0c1BhcnQgPSBwYXJ0OyAgLy8vXG5cbiAgICAgICAgICBwYXJ0ID0gb25lT3JNb3JlUGFydHNQYXJ0LmdldFBhcnQoKTtcblxuICAgICAgICAgIGxlZnRSZWN1cnNpdmVSdWxlTmFtZXNGcm9tUGFydChwYXJ0LCBsZWZ0UmVjdXJzaXZlUnVsZU5hbWVzKTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSBaZXJvT3JNb3JlUGFydHNQYXJ0VHlwZSA6IHtcbiAgICAgICAgICBjb25zdCB6ZXJvT3JNb3JlUGFydHNQYXJ0ID0gcGFydDsgLy8vXG5cbiAgICAgICAgICBwYXJ0ID0gemVyb09yTW9yZVBhcnRzUGFydC5nZXRQYXJ0KCk7XG5cbiAgICAgICAgICBsZWZ0UmVjdXJzaXZlUnVsZU5hbWVzRnJvbVBhcnQocGFydCwgbGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lcyk7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgR3JvdXBPZlBhcnRzUGFydFR5cGUgOiB7XG4gICAgICAgICAgY29uc3QgZ3JvdXBPZlBhcnRzUGFydCA9IHBhcnQsICAvLy9cbiAgICAgICAgICAgICAgICBwYXJ0cyA9IGdyb3VwT2ZQYXJ0c1BhcnQuZ2V0UGFydHMoKSxcbiAgICAgICAgICAgICAgICBmaXJzdFBhcnQgPSBmaXJzdChwYXJ0cyk7XG5cbiAgICAgICAgICBwYXJ0ID0gZmlyc3RQYXJ0OyAvLy9cblxuICAgICAgICAgIGxlZnRSZWN1cnNpdmVSdWxlTmFtZXNGcm9tUGFydChwYXJ0LCBsZWZ0UmVjdXJzaXZlUnVsZU5hbWVzKTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSBDaG9pY2VPZlBhcnRzUGFydFR5cGUgOiB7XG4gICAgICAgICAgY29uc3QgY2hvaWNlT2ZQYXJ0c1BhcnQgPSBwYXJ0LCAvLy9cbiAgICAgICAgICAgICAgICBwYXJ0cyA9IGNob2ljZU9mUGFydHNQYXJ0LmdldFBhcnRzKCk7XG5cbiAgICAgICAgICBwYXJ0cy5mb3JFYWNoKChwYXJ0KSA9PiBsZWZ0UmVjdXJzaXZlUnVsZU5hbWVzRnJvbVBhcnQocGFydCwgbGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lcykpO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxufVxuIl19