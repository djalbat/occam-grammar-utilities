'use strict';

var parsers = require('occam-parsers'),
    necessary = require('necessary');

var arrayUtilities = necessary.arrayUtilities,
    first = arrayUtilities.first;
var partTypes = parsers.partTypes,
    RuleNamePartType = partTypes.RuleNamePartType,
    OptionalPartPartType = partTypes.OptionalPartPartType,
    GroupOfPartsPartType = partTypes.GroupOfPartsPartType,
    ChoiceOfPartsPartType = partTypes.ChoiceOfPartsPartType,
    OneOrMorePartsPartType = partTypes.OneOrMorePartsPartType,
    ZeroOrMorePartsPartType = partTypes.ZeroOrMorePartsPartType;

function recursiveRuleNamesFromPart(part, recursiveRuleNames) {
  var partNonTerminalPart = part.isNonTerminalPart();

  if (partNonTerminalPart) {
    var type = part.getType();

    switch (type) {
      case RuleNamePartType:
        {
          var ruleNamePart = part,
              ///
          ruleName = ruleNamePart.getRuleName(),
              recursiveRuleNamesIncludesRuleName = recursiveRuleNames.includes(ruleName);

          if (!recursiveRuleNamesIncludesRuleName) {
            var recursiveRuleName = ruleName; ///

            recursiveRuleNames.push(recursiveRuleName);
          }
        }
        break;

      case OptionalPartPartType:
        {
          var optionalPartPart = part; ///

          part = optionalPartPart.getPart();
          recursiveRuleNamesFromPart(part, recursiveRuleNames);
        }
        break;

      case OneOrMorePartsPartType:
        {
          var oneOrMorePartsPart = part; ///

          part = oneOrMorePartsPart.getPart();
          recursiveRuleNamesFromPart(part, recursiveRuleNames);
        }
        break;

      case ZeroOrMorePartsPartType:
        {
          var zeroOrMorePartsPart = part; ///

          part = zeroOrMorePartsPart.getPart(); ///

          recursiveRuleNamesFromPart(part, recursiveRuleNames);
        }
        break;

      case GroupOfPartsPartType:
        {
          var groupOfPartsPart = part,
              ///
          parts = groupOfPartsPart.getParts();
          parts.forEach(function (part) {
            return recursiveRuleNamesFromPart(part, recursiveRuleNames);
          });
        }
        break;

      case ChoiceOfPartsPartType:
        {
          var choiceOfPartsPart = part,
              ///
          _parts = choiceOfPartsPart.getParts();

          _parts.forEach(function (part) {
            return recursiveRuleNamesFromPart(part, recursiveRuleNames);
          });
        }
        break;
    }
  }
}

function leftRecursiveRuleNamesFromPart(part, leftRecursiveRuleNames) {
  var partNonTerminalPart = part.isNonTerminalPart();

  if (partNonTerminalPart) {
    var type = part.getType();

    switch (type) {
      case RuleNamePartType:
        {
          var ruleNamePart = part,
              ///
          ruleName = ruleNamePart.getRuleName(),
              leftRecursiveRuleNamesIncludesRuleName = leftRecursiveRuleNames.includes(ruleName);

          if (!leftRecursiveRuleNamesIncludesRuleName) {
            var leftRecursiveRuleName = ruleName; ///

            leftRecursiveRuleNames.push(leftRecursiveRuleName);
          }
        }
        break;

      case OptionalPartPartType:
        {
          var optionalPartPart = part; ///

          part = optionalPartPart.getPart();
          leftRecursiveRuleNamesFromPart(part, leftRecursiveRuleNames);
        }
        break;

      case OneOrMorePartsPartType:
        {
          var oneOrMorePartsPart = part; ///

          part = oneOrMorePartsPart.getPart();
          leftRecursiveRuleNamesFromPart(part, leftRecursiveRuleNames);
        }
        break;

      case ZeroOrMorePartsPartType:
        {
          var zeroOrMorePartsPart = part; ///

          part = zeroOrMorePartsPart.getPart();
          leftRecursiveRuleNamesFromPart(part, leftRecursiveRuleNames);
        }
        break;

      case GroupOfPartsPartType:
        {
          var groupOfPartsPart = part,
              ///
          parts = groupOfPartsPart.getParts(),
              firstPart = first(parts);
          part = firstPart; ///

          leftRecursiveRuleNamesFromPart(part, leftRecursiveRuleNames);
        }
        break;

      case ChoiceOfPartsPartType:
        {
          var choiceOfPartsPart = part,
              ///
          _parts2 = choiceOfPartsPart.getParts();

          _parts2.forEach(function (part) {
            return leftRecursiveRuleNamesFromPart(part, leftRecursiveRuleNames);
          });
        }
        break;
    }
  }
}

module.exports = {
  recursiveRuleNamesFromPart: recursiveRuleNamesFromPart,
  leftRecursiveRuleNamesFromPart: leftRecursiveRuleNamesFromPart
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlY3Vyc2l2ZVBhcnQuanMiXSwibmFtZXMiOlsicGFyc2VycyIsInJlcXVpcmUiLCJuZWNlc3NhcnkiLCJhcnJheVV0aWxpdGllcyIsImZpcnN0IiwicGFydFR5cGVzIiwiUnVsZU5hbWVQYXJ0VHlwZSIsIk9wdGlvbmFsUGFydFBhcnRUeXBlIiwiR3JvdXBPZlBhcnRzUGFydFR5cGUiLCJDaG9pY2VPZlBhcnRzUGFydFR5cGUiLCJPbmVPck1vcmVQYXJ0c1BhcnRUeXBlIiwiWmVyb09yTW9yZVBhcnRzUGFydFR5cGUiLCJyZWN1cnNpdmVSdWxlTmFtZXNGcm9tUGFydCIsInBhcnQiLCJyZWN1cnNpdmVSdWxlTmFtZXMiLCJwYXJ0Tm9uVGVybWluYWxQYXJ0IiwiaXNOb25UZXJtaW5hbFBhcnQiLCJ0eXBlIiwiZ2V0VHlwZSIsInJ1bGVOYW1lUGFydCIsInJ1bGVOYW1lIiwiZ2V0UnVsZU5hbWUiLCJyZWN1cnNpdmVSdWxlTmFtZXNJbmNsdWRlc1J1bGVOYW1lIiwiaW5jbHVkZXMiLCJyZWN1cnNpdmVSdWxlTmFtZSIsInB1c2giLCJvcHRpb25hbFBhcnRQYXJ0IiwiZ2V0UGFydCIsIm9uZU9yTW9yZVBhcnRzUGFydCIsInplcm9Pck1vcmVQYXJ0c1BhcnQiLCJncm91cE9mUGFydHNQYXJ0IiwicGFydHMiLCJnZXRQYXJ0cyIsImZvckVhY2giLCJjaG9pY2VPZlBhcnRzUGFydCIsImxlZnRSZWN1cnNpdmVSdWxlTmFtZXNGcm9tUGFydCIsImxlZnRSZWN1cnNpdmVSdWxlTmFtZXMiLCJsZWZ0UmVjdXJzaXZlUnVsZU5hbWVzSW5jbHVkZXNSdWxlTmFtZSIsImxlZnRSZWN1cnNpdmVSdWxlTmFtZSIsImZpcnN0UGFydCIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBLElBQU1BLE9BQU8sR0FBR0MsT0FBTyxDQUFDLGVBQUQsQ0FBdkI7QUFBQSxJQUNNQyxTQUFTLEdBQUdELE9BQU8sQ0FBQyxXQUFELENBRHpCOztBQUdNLElB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QVAsQ0FBOUI7QUFDRDtBQUNEOztBQUVGLFdBQUt6Qix1QkFBTDtBQUErQjtBQUMzQixjQUFNa0IsbUJBQW1CLEdBQUdoQixJQUE1QixDQUQyQixDQUNPOztBQUVsQ0EsVUFBQUEsSUFBSSxHQUFHZ0IsbUJBQW1CLENBQUNGLE9BQXBCLEVBQVA7QUFFQVEsVUFBQUEsOEJBQThCLENBQUN0QixJQUFELEVBQU91QixzQkFBUCxDQUE5QjtBQUNEO0FBQ0Q7O0FBRUYsV0FBSzVCLG9CQUFMO0FBQTRCO0FBQ3hCLGNBQU1zQixnQkFBZ0IsR0FBR2pCLElBQXpCO0FBQUEsY0FBZ0M7QUFDMUJrQixVQUFBQSxLQUFLLEdBQUdELGdCQUFnQixDQUFDRSxRQUFqQixFQURkO0FBQUEsY0FFTU8sU0FBUyxHQUFHbkMsS0FBSyxDQUFDMkIsS0FBRCxDQUZ2QjtBQUlBbEIsVUFBQUEsSUFBSSxHQUFHMEIsU0FBUCxDQUx3QixDQUtOOztBQUVsQkosVUFBQUEsOEJBQThCLENBQUN0QixJQUFELEVBQU91QixzQkFBUCxDQUE5QjtBQUNEO0FBQ0Q7O0FBRUYsV0FBSzNCLHFCQUFMO0FBQTZCO0FBQ3pCLGNBQU15QixpQkFBaUIsR0FBR3JCLElBQTFCO0FBQUEsY0FBZ0M7QUFDMUJrQixVQUFBQSxPQUFLLEdBQUdHLGlCQUFpQixDQUFDRixRQUFsQixFQURkOztBQUdBRCxVQUFBQSxPQUFLLENBQUNFLE9BQU4sQ0FBYyxVQUFDcEIsSUFBRDtBQUFBLG1CQUFVc0IsOEJBQThCLENBQUN0QixJQUFELEVBQU91QixzQkFBUCxDQUF4QztBQUFBLFdBQWQ7QUFDRDtBQUNEO0FBMURKO0FBNEREO0FBQ0Y7O0FBRURJLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQjtBQUNmN0IsRUFBQUEsMEJBQTBCLEVBQTFCQSwwQkFEZTtBQUVmdUIsRUFBQUEsOEJBQThCLEVBQTlCQTtBQUZlLENBQWpCIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5jb25zdCBwYXJzZXJzID0gcmVxdWlyZSgnb2NjYW0tcGFyc2VycycpLFxuICAgICAgbmVjZXNzYXJ5ID0gcmVxdWlyZSgnbmVjZXNzYXJ5Jyk7XG5cbmNvbnN0IHsgYXJyYXlVdGlsaXRpZXMgfSA9IG5lY2Vzc2FyeSxcbiAgICAgIHsgZmlyc3QgfSA9IGFycmF5VXRpbGl0aWVzO1xuXG5jb25zdCB7IHBhcnRUeXBlcyB9ID0gcGFyc2VycyxcbiAgICAgIHsgUnVsZU5hbWVQYXJ0VHlwZSxcbiAgICAgICAgT3B0aW9uYWxQYXJ0UGFydFR5cGUsXG4gICAgICAgIEdyb3VwT2ZQYXJ0c1BhcnRUeXBlLFxuICAgICAgICBDaG9pY2VPZlBhcnRzUGFydFR5cGUsXG4gICAgICAgIE9uZU9yTW9yZVBhcnRzUGFydFR5cGUsXG4gICAgICAgIFplcm9Pck1vcmVQYXJ0c1BhcnRUeXBlIH0gPSBwYXJ0VHlwZXM7XG5cbmZ1bmN0aW9uIHJlY3Vyc2l2ZVJ1bGVOYW1lc0Zyb21QYXJ0KHBhcnQsIHJlY3Vyc2l2ZVJ1bGVOYW1lcykge1xuICBjb25zdCBwYXJ0Tm9uVGVybWluYWxQYXJ0ID0gcGFydC5pc05vblRlcm1pbmFsUGFydCgpO1xuXG4gIGlmIChwYXJ0Tm9uVGVybWluYWxQYXJ0KSB7XG4gICAgY29uc3QgdHlwZSA9IHBhcnQuZ2V0VHlwZSgpO1xuXG4gICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICBjYXNlIFJ1bGVOYW1lUGFydFR5cGUgOiB7XG4gICAgICAgICAgY29uc3QgcnVsZU5hbWVQYXJ0ID0gcGFydCwgIC8vL1xuICAgICAgICAgICAgICAgIHJ1bGVOYW1lID0gcnVsZU5hbWVQYXJ0LmdldFJ1bGVOYW1lKCksXG4gICAgICAgICAgICAgICAgcmVjdXJzaXZlUnVsZU5hbWVzSW5jbHVkZXNSdWxlTmFtZSA9IHJlY3Vyc2l2ZVJ1bGVOYW1lcy5pbmNsdWRlcyhydWxlTmFtZSk7XG5cbiAgICAgICAgICBpZiAoIXJlY3Vyc2l2ZVJ1bGVOYW1lc0luY2x1ZGVzUnVsZU5hbWUpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlY3Vyc2l2ZVJ1bGVOYW1lID0gcnVsZU5hbWU7IC8vL1xuXG4gICAgICAgICAgICByZWN1cnNpdmVSdWxlTmFtZXMucHVzaChyZWN1cnNpdmVSdWxlTmFtZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIE9wdGlvbmFsUGFydFBhcnRUeXBlIDoge1xuICAgICAgICAgIGNvbnN0IG9wdGlvbmFsUGFydFBhcnQgPSBwYXJ0OyAgLy8vXG5cbiAgICAgICAgICBwYXJ0ID0gb3B0aW9uYWxQYXJ0UGFydC5nZXRQYXJ0KCk7XG5cbiAgICAgICAgICByZWN1cnNpdmVSdWxlTmFtZXNGcm9tUGFydChwYXJ0LCByZWN1cnNpdmVSdWxlTmFtZXMpO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIE9uZU9yTW9yZVBhcnRzUGFydFR5cGUgOiB7XG4gICAgICAgICAgY29uc3Qgb25lT3JNb3JlUGFydHNQYXJ0ID0gcGFydDsgIC8vL1xuXG4gICAgICAgICAgcGFydCA9IG9uZU9yTW9yZVBhcnRzUGFydC5nZXRQYXJ0KCk7XG5cbiAgICAgICAgICByZWN1cnNpdmVSdWxlTmFtZXNGcm9tUGFydChwYXJ0LCByZWN1cnNpdmVSdWxlTmFtZXMpO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIFplcm9Pck1vcmVQYXJ0c1BhcnRUeXBlIDoge1xuICAgICAgICAgIGNvbnN0IHplcm9Pck1vcmVQYXJ0c1BhcnQgPSBwYXJ0OyAvLy9cblxuICAgICAgICAgIHBhcnQgPSB6ZXJvT3JNb3JlUGFydHNQYXJ0LmdldFBhcnQoKTsgIC8vL1xuXG4gICAgICAgICAgcmVjdXJzaXZlUnVsZU5hbWVzRnJvbVBhcnQocGFydCwgcmVjdXJzaXZlUnVsZU5hbWVzKTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSBHcm91cE9mUGFydHNQYXJ0VHlwZSA6IHtcbiAgICAgICAgY29uc3QgZ3JvdXBPZlBhcnRzUGFydCA9IHBhcnQsICAvLy9cbiAgICAgICAgICAgICAgcGFydHMgPSBncm91cE9mUGFydHNQYXJ0LmdldFBhcnRzKCk7XG5cbiAgICAgICAgICBwYXJ0cy5mb3JFYWNoKChwYXJ0KSA9PiByZWN1cnNpdmVSdWxlTmFtZXNGcm9tUGFydChwYXJ0LCByZWN1cnNpdmVSdWxlTmFtZXMpKTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSBDaG9pY2VPZlBhcnRzUGFydFR5cGUgOiB7XG4gICAgICAgIGNvbnN0IGNob2ljZU9mUGFydHNQYXJ0ID0gcGFydCwgLy8vXG4gICAgICAgICAgICAgIHBhcnRzID0gY2hvaWNlT2ZQYXJ0c1BhcnQuZ2V0UGFydHMoKTtcblxuICAgICAgICAgIHBhcnRzLmZvckVhY2goKHBhcnQpID0+IHJlY3Vyc2l2ZVJ1bGVOYW1lc0Zyb21QYXJ0KHBhcnQsIHJlY3Vyc2l2ZVJ1bGVOYW1lcykpO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBsZWZ0UmVjdXJzaXZlUnVsZU5hbWVzRnJvbVBhcnQocGFydCwgbGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lcykge1xuICBjb25zdCBwYXJ0Tm9uVGVybWluYWxQYXJ0ID0gcGFydC5pc05vblRlcm1pbmFsUGFydCgpO1xuXG4gIGlmIChwYXJ0Tm9uVGVybWluYWxQYXJ0KSB7XG4gICAgY29uc3QgdHlwZSA9IHBhcnQuZ2V0VHlwZSgpO1xuXG4gICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICBjYXNlIFJ1bGVOYW1lUGFydFR5cGUgOiB7XG4gICAgICAgICAgY29uc3QgcnVsZU5hbWVQYXJ0ID0gcGFydCwgIC8vL1xuICAgICAgICAgICAgICAgIHJ1bGVOYW1lID0gcnVsZU5hbWVQYXJ0LmdldFJ1bGVOYW1lKCksXG4gICAgICAgICAgICAgICAgbGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lc0luY2x1ZGVzUnVsZU5hbWUgPSBsZWZ0UmVjdXJzaXZlUnVsZU5hbWVzLmluY2x1ZGVzKHJ1bGVOYW1lKTtcblxuICAgICAgICAgIGlmICghbGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lc0luY2x1ZGVzUnVsZU5hbWUpIHtcbiAgICAgICAgICAgIGNvbnN0IGxlZnRSZWN1cnNpdmVSdWxlTmFtZSA9IHJ1bGVOYW1lOyAvLy9cblxuICAgICAgICAgICAgbGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lcy5wdXNoKGxlZnRSZWN1cnNpdmVSdWxlTmFtZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIE9wdGlvbmFsUGFydFBhcnRUeXBlIDoge1xuICAgICAgICAgIGNvbnN0IG9wdGlvbmFsUGFydFBhcnQgPSBwYXJ0OyAvLy9cblxuICAgICAgICAgIHBhcnQgPSBvcHRpb25hbFBhcnRQYXJ0LmdldFBhcnQoKTtcblxuICAgICAgICAgIGxlZnRSZWN1cnNpdmVSdWxlTmFtZXNGcm9tUGFydChwYXJ0LCBsZWZ0UmVjdXJzaXZlUnVsZU5hbWVzKTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSBPbmVPck1vcmVQYXJ0c1BhcnRUeXBlIDoge1xuICAgICAgICAgIGNvbnN0IG9uZU9yTW9yZVBhcnRzUGFydCA9IHBhcnQ7ICAvLy9cblxuICAgICAgICAgIHBhcnQgPSBvbmVPck1vcmVQYXJ0c1BhcnQuZ2V0UGFydCgpO1xuXG4gICAgICAgICAgbGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lc0Zyb21QYXJ0KHBhcnQsIGxlZnRSZWN1cnNpdmVSdWxlTmFtZXMpO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIFplcm9Pck1vcmVQYXJ0c1BhcnRUeXBlIDoge1xuICAgICAgICAgIGNvbnN0IHplcm9Pck1vcmVQYXJ0c1BhcnQgPSBwYXJ0OyAvLy9cblxuICAgICAgICAgIHBhcnQgPSB6ZXJvT3JNb3JlUGFydHNQYXJ0LmdldFBhcnQoKTtcblxuICAgICAgICAgIGxlZnRSZWN1cnNpdmVSdWxlTmFtZXNGcm9tUGFydChwYXJ0LCBsZWZ0UmVjdXJzaXZlUnVsZU5hbWVzKTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSBHcm91cE9mUGFydHNQYXJ0VHlwZSA6IHtcbiAgICAgICAgICBjb25zdCBncm91cE9mUGFydHNQYXJ0ID0gcGFydCwgIC8vL1xuICAgICAgICAgICAgICAgIHBhcnRzID0gZ3JvdXBPZlBhcnRzUGFydC5nZXRQYXJ0cygpLFxuICAgICAgICAgICAgICAgIGZpcnN0UGFydCA9IGZpcnN0KHBhcnRzKTtcblxuICAgICAgICAgIHBhcnQgPSBmaXJzdFBhcnQ7IC8vL1xuXG4gICAgICAgICAgbGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lc0Zyb21QYXJ0KHBhcnQsIGxlZnRSZWN1cnNpdmVSdWxlTmFtZXMpO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIENob2ljZU9mUGFydHNQYXJ0VHlwZSA6IHtcbiAgICAgICAgICBjb25zdCBjaG9pY2VPZlBhcnRzUGFydCA9IHBhcnQsIC8vL1xuICAgICAgICAgICAgICAgIHBhcnRzID0gY2hvaWNlT2ZQYXJ0c1BhcnQuZ2V0UGFydHMoKTtcblxuICAgICAgICAgIHBhcnRzLmZvckVhY2goKHBhcnQpID0+IGxlZnRSZWN1cnNpdmVSdWxlTmFtZXNGcm9tUGFydChwYXJ0LCBsZWZ0UmVjdXJzaXZlUnVsZU5hbWVzKSk7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICByZWN1cnNpdmVSdWxlTmFtZXNGcm9tUGFydCxcbiAgbGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lc0Zyb21QYXJ0XG59O1xuIl19