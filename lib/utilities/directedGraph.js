"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: Object.getOwnPropertyDescriptor(all, name).get
    });
}
_export(exports, {
    get edgeFromRuleNameAndLeftRecursiveRuleName () {
        return edgeFromRuleNameAndLeftRecursiveRuleName;
    },
    get edgesFromRuleNames () {
        return edgesFromRuleNames;
    },
    get edgesFromStartRule () {
        return edgesFromStartRule;
    }
});
const _edge = /*#__PURE__*/ _interop_require_default(require("../edge"));
const _directedGraph = require("../directedGraph");
const _recursive = require("../utilities/recursive");
const _labels = require("../labels");
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
function edgesFromRuleNames(ruleNames) {
    const length = ruleNames.length, edges = ruleNames.map((ruleName, index)=>{
        const nextIndex = (index + 1) % length, nextRuleName = ruleNames[nextIndex], leftRecursiveRuleName = nextRuleName, edge = edgeFromRuleNameAndLeftRecursiveRuleName(ruleName, leftRecursiveRuleName);
        return edge;
    });
    return edges;
}
function edgesFromStartRule(startRule, ruleMap, ruleNamesMap) {
    const rule = startRule, edges = [], vertexes = [];
    edgesFromRule(rule, edges, vertexes, ruleMap, ruleNamesMap);
    return edges;
}
function edgeFromRuleNameAndLeftRecursiveRuleName(ruleName, leftRecursiveRuleName) {
    const label = _labels.LEFT_RECURSIVE_LABEL, sourceVertex = ruleName, targetVertex = leftRecursiveRuleName, edge = _edge.default.fromLabelSourceVertexAndTargetVertex(label, sourceVertex, targetVertex);
    return edge;
}
function edgesFromRule(rule, edges, vertexes, ruleMap, ruleNamesMap) {
    const ruleName = rule.getName(), vertex = ruleName, vertexesIncludesVertex = vertexes.includes(vertex);
    if (vertexesIncludesVertex) {
        return;
    }
    vertexes = [
        ...vertexes,
        vertex
    ];
    const ruleNames = ruleNamesMap[ruleName], recursiveRuleNames = (0, _recursive.recursiveRuleNamesFromRule)(rule), leftRecursiveRuleNames = ruleNames; ///
    recursiveRuleNames.forEach((recursiveRuleName)=>{
        const leftRecursiveRuleNamesIncludesRecursiveRuleName = leftRecursiveRuleNames.includes(recursiveRuleName), leftRecursiveRuleName = recursiveRuleName, label = leftRecursiveRuleNamesIncludesRecursiveRuleName ? _labels.LEFT_RECURSIVE_LABEL : _labels.RECURSIVE_LABEL, sourceVertex = ruleName, targetVertex = leftRecursiveRuleName, edge = _edge.default.fromLabelSourceVertexAndTargetVertex(label, sourceVertex, targetVertex), matches = (0, _directedGraph.edgesMatchEdge)(edges, edge);
        if (!matches) {
            edges.push(edge);
        }
        const recursiveRule = ruleMap[recursiveRuleName] || null;
        if (recursiveRule !== null) {
            const rule = recursiveRule; ///
            edgesFromRule(rule, edges, vertexes, ruleMap, ruleNamesMap);
        }
    });
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlsaXRpZXMvZGlyZWN0ZWRHcmFwaC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuaW1wb3J0IEVkZ2UgZnJvbSBcIi4uL2VkZ2VcIjtcblxuaW1wb3J0IHsgZWRnZXNNYXRjaEVkZ2UgfSBmcm9tIFwiLi4vZGlyZWN0ZWRHcmFwaFwiO1xuaW1wb3J0IHsgcmVjdXJzaXZlUnVsZU5hbWVzRnJvbVJ1bGUgfSBmcm9tIFwiLi4vdXRpbGl0aWVzL3JlY3Vyc2l2ZVwiO1xuaW1wb3J0IHsgUkVDVVJTSVZFX0xBQkVMLCBMRUZUX1JFQ1VSU0lWRV9MQUJFTCB9IGZyb20gXCIuLi9sYWJlbHNcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIGVkZ2VzRnJvbVJ1bGVOYW1lcyhydWxlTmFtZXMpIHtcbiAgY29uc3QgbGVuZ3RoID0gcnVsZU5hbWVzLmxlbmd0aCxcbiAgICAgICAgZWRnZXMgPSBydWxlTmFtZXMubWFwKChydWxlTmFtZSwgaW5kZXgpID0+IHtcbiAgICAgICAgICBjb25zdCBuZXh0SW5kZXggPSAoaW5kZXggKyAxKSAlIGxlbmd0aCxcbiAgICAgICAgICAgICAgICBuZXh0UnVsZU5hbWUgPSBydWxlTmFtZXNbbmV4dEluZGV4XSxcbiAgICAgICAgICAgICAgICBsZWZ0UmVjdXJzaXZlUnVsZU5hbWUgPSBuZXh0UnVsZU5hbWUsIC8vL1xuICAgICAgICAgICAgICAgIGVkZ2UgPSBlZGdlRnJvbVJ1bGVOYW1lQW5kTGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lKHJ1bGVOYW1lLCBsZWZ0UmVjdXJzaXZlUnVsZU5hbWUpO1xuXG4gICAgICAgICAgcmV0dXJuIGVkZ2U7XG4gICAgICAgIH0pO1xuXG4gIHJldHVybiBlZGdlcztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGVkZ2VzRnJvbVN0YXJ0UnVsZShzdGFydFJ1bGUsIHJ1bGVNYXAsIHJ1bGVOYW1lc01hcCkge1xuICBjb25zdCBydWxlID0gc3RhcnRSdWxlLCAvLy9cbiAgICAgICAgZWRnZXMgPSBbXSxcbiAgICAgICAgdmVydGV4ZXMgPSBbXTtcblxuICBlZGdlc0Zyb21SdWxlKHJ1bGUsIGVkZ2VzLCB2ZXJ0ZXhlcywgcnVsZU1hcCwgcnVsZU5hbWVzTWFwKTtcblxuICByZXR1cm4gZWRnZXM7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBlZGdlRnJvbVJ1bGVOYW1lQW5kTGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lKHJ1bGVOYW1lLCBsZWZ0UmVjdXJzaXZlUnVsZU5hbWUpIHtcbiAgY29uc3QgbGFiZWwgPSBMRUZUX1JFQ1VSU0lWRV9MQUJFTCxcbiAgICAgICAgc291cmNlVmVydGV4ID0gcnVsZU5hbWUsICAvLy9cbiAgICAgICAgdGFyZ2V0VmVydGV4ID0gbGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lLCAvLy9cbiAgICAgICAgZWRnZSA9IEVkZ2UuZnJvbUxhYmVsU291cmNlVmVydGV4QW5kVGFyZ2V0VmVydGV4KGxhYmVsLCBzb3VyY2VWZXJ0ZXgsIHRhcmdldFZlcnRleCk7XG5cbiAgcmV0dXJuIGVkZ2U7XG59XG5cbmZ1bmN0aW9uIGVkZ2VzRnJvbVJ1bGUocnVsZSwgZWRnZXMsIHZlcnRleGVzLCBydWxlTWFwLCBydWxlTmFtZXNNYXApIHtcbiAgY29uc3QgcnVsZU5hbWUgPSBydWxlLmdldE5hbWUoKSxcbiAgICAgICAgdmVydGV4ID0gcnVsZU5hbWUsICAvLy9cbiAgICAgICAgdmVydGV4ZXNJbmNsdWRlc1ZlcnRleCA9IHZlcnRleGVzLmluY2x1ZGVzKHZlcnRleCk7XG5cbiAgaWYgKHZlcnRleGVzSW5jbHVkZXNWZXJ0ZXgpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2ZXJ0ZXhlcyA9IFtcbiAgICAuLi52ZXJ0ZXhlcyxcbiAgICB2ZXJ0ZXhcbiAgXTtcblxuICBjb25zdCBydWxlTmFtZXMgPSBydWxlTmFtZXNNYXBbcnVsZU5hbWVdLFxuICAgICAgICByZWN1cnNpdmVSdWxlTmFtZXMgPSByZWN1cnNpdmVSdWxlTmFtZXNGcm9tUnVsZShydWxlKSxcbiAgICAgICAgbGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lcyA9IHJ1bGVOYW1lczsgLy8vXG5cbiAgcmVjdXJzaXZlUnVsZU5hbWVzLmZvckVhY2goKHJlY3Vyc2l2ZVJ1bGVOYW1lKSA9PiB7XG4gICAgY29uc3QgbGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lc0luY2x1ZGVzUmVjdXJzaXZlUnVsZU5hbWUgPSBsZWZ0UmVjdXJzaXZlUnVsZU5hbWVzLmluY2x1ZGVzKHJlY3Vyc2l2ZVJ1bGVOYW1lKSxcbiAgICAgICAgICBsZWZ0UmVjdXJzaXZlUnVsZU5hbWUgPSByZWN1cnNpdmVSdWxlTmFtZSwgIC8vL1xuICAgICAgICAgIGxhYmVsID0gbGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lc0luY2x1ZGVzUmVjdXJzaXZlUnVsZU5hbWUgP1xuICAgICAgICAgICAgICAgICAgICBMRUZUX1JFQ1VSU0lWRV9MQUJFTCA6XG4gICAgICAgICAgICAgICAgICAgICAgUkVDVVJTSVZFX0xBQkVMLFxuICAgICAgICAgIHNvdXJjZVZlcnRleCA9IHJ1bGVOYW1lLCAgLy8vXG4gICAgICAgICAgdGFyZ2V0VmVydGV4ID0gbGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lLCAvLy9cbiAgICAgICAgICBlZGdlID0gRWRnZS5mcm9tTGFiZWxTb3VyY2VWZXJ0ZXhBbmRUYXJnZXRWZXJ0ZXgobGFiZWwsIHNvdXJjZVZlcnRleCwgdGFyZ2V0VmVydGV4KSxcbiAgICAgICAgICBtYXRjaGVzID0gZWRnZXNNYXRjaEVkZ2UoZWRnZXMsIGVkZ2UpO1xuXG4gICAgaWYgKCFtYXRjaGVzKSB7XG4gICAgICBlZGdlcy5wdXNoKGVkZ2UpO1xuICAgIH1cblxuICAgIGNvbnN0IHJlY3Vyc2l2ZVJ1bGUgPSBydWxlTWFwW3JlY3Vyc2l2ZVJ1bGVOYW1lXSB8fCBudWxsO1xuXG4gICAgaWYgKHJlY3Vyc2l2ZVJ1bGUgIT09IG51bGwpIHtcbiAgICAgIGNvbnN0IHJ1bGUgPSByZWN1cnNpdmVSdWxlOyAvLy9cblxuICAgICAgZWRnZXNGcm9tUnVsZShydWxlLCBlZGdlcywgdmVydGV4ZXMsIHJ1bGVNYXAsIHJ1bGVOYW1lc01hcCk7XG4gICAgfVxuICB9KTtcbn1cblxuIl0sIm5hbWVzIjpbImVkZ2VGcm9tUnVsZU5hbWVBbmRMZWZ0UmVjdXJzaXZlUnVsZU5hbWUiLCJlZGdlc0Zyb21SdWxlTmFtZXMiLCJlZGdlc0Zyb21TdGFydFJ1bGUiLCJydWxlTmFtZXMiLCJsZW5ndGgiLCJlZGdlcyIsIm1hcCIsInJ1bGVOYW1lIiwiaW5kZXgiLCJuZXh0SW5kZXgiLCJuZXh0UnVsZU5hbWUiLCJsZWZ0UmVjdXJzaXZlUnVsZU5hbWUiLCJlZGdlIiwic3RhcnRSdWxlIiwicnVsZU1hcCIsInJ1bGVOYW1lc01hcCIsInJ1bGUiLCJ2ZXJ0ZXhlcyIsImVkZ2VzRnJvbVJ1bGUiLCJsYWJlbCIsIkxFRlRfUkVDVVJTSVZFX0xBQkVMIiwic291cmNlVmVydGV4IiwidGFyZ2V0VmVydGV4IiwiRWRnZSIsImZyb21MYWJlbFNvdXJjZVZlcnRleEFuZFRhcmdldFZlcnRleCIsImdldE5hbWUiLCJ2ZXJ0ZXgiLCJ2ZXJ0ZXhlc0luY2x1ZGVzVmVydGV4IiwiaW5jbHVkZXMiLCJyZWN1cnNpdmVSdWxlTmFtZXMiLCJyZWN1cnNpdmVSdWxlTmFtZXNGcm9tUnVsZSIsImxlZnRSZWN1cnNpdmVSdWxlTmFtZXMiLCJmb3JFYWNoIiwicmVjdXJzaXZlUnVsZU5hbWUiLCJsZWZ0UmVjdXJzaXZlUnVsZU5hbWVzSW5jbHVkZXNSZWN1cnNpdmVSdWxlTmFtZSIsIlJFQ1VSU0lWRV9MQUJFTCIsIm1hdGNoZXMiLCJlZGdlc01hdGNoRWRnZSIsInB1c2giLCJyZWN1cnNpdmVSdWxlIl0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Ozs7UUFnQ2dCQTtlQUFBQTs7UUF4QkFDO2VBQUFBOztRQWNBQztlQUFBQTs7OzZEQXBCQzsrQkFFYzsyQkFDWTt3QkFDVzs7Ozs7O0FBRS9DLFNBQVNELG1CQUFtQkUsU0FBUztJQUMxQyxNQUFNQyxTQUFTRCxVQUFVQyxNQUFNLEVBQ3pCQyxRQUFRRixVQUFVRyxHQUFHLENBQUMsQ0FBQ0MsVUFBVUM7UUFDL0IsTUFBTUMsWUFBWSxBQUFDRCxDQUFBQSxRQUFRLENBQUEsSUFBS0osUUFDMUJNLGVBQWVQLFNBQVMsQ0FBQ00sVUFBVSxFQUNuQ0Usd0JBQXdCRCxjQUN4QkUsT0FBT1oseUNBQXlDTyxVQUFVSTtRQUVoRSxPQUFPQztJQUNUO0lBRU4sT0FBT1A7QUFDVDtBQUVPLFNBQVNILG1CQUFtQlcsU0FBUyxFQUFFQyxPQUFPLEVBQUVDLFlBQVk7SUFDakUsTUFBTUMsT0FBT0gsV0FDUFIsUUFBUSxFQUFFLEVBQ1ZZLFdBQVcsRUFBRTtJQUVuQkMsY0FBY0YsTUFBTVgsT0FBT1ksVUFBVUgsU0FBU0M7SUFFOUMsT0FBT1Y7QUFDVDtBQUVPLFNBQVNMLHlDQUF5Q08sUUFBUSxFQUFFSSxxQkFBcUI7SUFDdEYsTUFBTVEsUUFBUUMsNEJBQW9CLEVBQzVCQyxlQUFlZCxVQUNmZSxlQUFlWCx1QkFDZkMsT0FBT1csYUFBSSxDQUFDQyxvQ0FBb0MsQ0FBQ0wsT0FBT0UsY0FBY0M7SUFFNUUsT0FBT1Y7QUFDVDtBQUVBLFNBQVNNLGNBQWNGLElBQUksRUFBRVgsS0FBSyxFQUFFWSxRQUFRLEVBQUVILE9BQU8sRUFBRUMsWUFBWTtJQUNqRSxNQUFNUixXQUFXUyxLQUFLUyxPQUFPLElBQ3ZCQyxTQUFTbkIsVUFDVG9CLHlCQUF5QlYsU0FBU1csUUFBUSxDQUFDRjtJQUVqRCxJQUFJQyx3QkFBd0I7UUFDMUI7SUFDRjtJQUVBVixXQUFXO1dBQ05BO1FBQ0hTO0tBQ0Q7SUFFRCxNQUFNdkIsWUFBWVksWUFBWSxDQUFDUixTQUFTLEVBQ2xDc0IscUJBQXFCQyxJQUFBQSxxQ0FBMEIsRUFBQ2QsT0FDaERlLHlCQUF5QjVCLFdBQVcsR0FBRztJQUU3QzBCLG1CQUFtQkcsT0FBTyxDQUFDLENBQUNDO1FBQzFCLE1BQU1DLGtEQUFrREgsdUJBQXVCSCxRQUFRLENBQUNLLG9CQUNsRnRCLHdCQUF3QnNCLG1CQUN4QmQsUUFBUWUsa0RBQ0VkLDRCQUFvQixHQUNsQmUsdUJBQWUsRUFDM0JkLGVBQWVkLFVBQ2ZlLGVBQWVYLHVCQUNmQyxPQUFPVyxhQUFJLENBQUNDLG9DQUFvQyxDQUFDTCxPQUFPRSxjQUFjQyxlQUN0RWMsVUFBVUMsSUFBQUEsNkJBQWMsRUFBQ2hDLE9BQU9PO1FBRXRDLElBQUksQ0FBQ3dCLFNBQVM7WUFDWi9CLE1BQU1pQyxJQUFJLENBQUMxQjtRQUNiO1FBRUEsTUFBTTJCLGdCQUFnQnpCLE9BQU8sQ0FBQ21CLGtCQUFrQixJQUFJO1FBRXBELElBQUlNLGtCQUFrQixNQUFNO1lBQzFCLE1BQU12QixPQUFPdUIsZUFBZSxHQUFHO1lBRS9CckIsY0FBY0YsTUFBTVgsT0FBT1ksVUFBVUgsU0FBU0M7UUFDaEQ7SUFDRjtBQUNGIn0=