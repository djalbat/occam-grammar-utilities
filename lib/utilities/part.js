'use strict';

var parsers = require('occam-parsers');

var arrayUtilities = require('../utilities/array');

var first = arrayUtilities.first;
var partTypes = parsers.partTypes,
    RuleNamePartType = partTypes.RuleNamePartType,
    OptionalPartPartType = partTypes.OptionalPartPartType,
    GroupOfPartsPartType = partTypes.GroupOfPartsPartType,
    ChoiceOfPartsPartType = partTypes.ChoiceOfPartsPartType,
    OneOrMorePartsPartType = partTypes.OneOrMorePartsPartType,
    ZeroOrMorePartsPartType = partTypes.ZeroOrMorePartsPartType;


function isPartRecursive(part) {
  var ruleNames = rulesNamesFromPart(part),
      ruleNamesLength = ruleNames.length,
      partRecursive = ruleNamesLength > 0;

  return partRecursive;
}

function ruleNamesFromPart(part) {
  var ruleNames = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];

  var partRecursive = false;

  var partNonTerminalPart = part.isNonTerminalPart();

  if (partNonTerminalPart) {
    var type = part.getType();

    switch (type) {
      case RuleNamePartType:
        var ruleNamePart = part,
            ///
        ruleName = ruleNamePart.getRuleName(),
            ruleNamesIncludesRuleName = ruleNames.includes(ruleName);

        if (!ruleNamesIncludesRuleName) {
          ruleNames.push(ruleName);
        }
        break;

      case OptionalPartPartType:
      case OneOrMorePartsPartType:
      case ZeroOrMorePartsPartType:
        part = part.getPart(); ///

        ruleNamesFromPart(part, ruleNames);
        break;

      case GroupOfPartsPartType:
      case ChoiceOfPartsPartType:
        {
          var parts = part.getParts();

          partRecursive = parts.some(function (part) {
            ruleNamesFromPart(part, ruleNames);
          });
        }
        break;
    }
  }

  return partRecursive;
}

function isPartLeftRecursive(part) {
  var leftRecursiveRuleName = leftRecursiveRuleNameFromPart(part),
      partLeftRecursive = leftRecursiveRuleName !== null;

  return partLeftRecursive;
}

function leftRecursiveRuleNameFromPart(part) {
  var leftRecursiveRuleName = null;

  var partNonTerminalPart = part.isNonTerminalPart();

  if (partNonTerminalPart) {
    var type = part.getType();

    switch (type) {
      case RuleNamePartType:
        var ruleNamePart = part,
            ///
        ruleName = ruleNamePart.getRuleName();

        leftRecursiveRuleName = ruleName; ///
        break;

      case OptionalPartPartType:
      case OneOrMorePartsPartType:
      case ZeroOrMorePartsPartType:
        part = part.getPart(); ///

        leftRecursiveRuleName = leftRecursiveRuleNameFromPart(part);
        break;

      case GroupOfPartsPartType:
        {
          var parts = _part.getParts(),
              firstPart = first(parts),
              _part = firstPart; ///

          leftRecursiveRuleName = leftRecursiveRuleNameFromPart(_part);
        }
        break;

      case ChoiceOfPartsPartType:
        {
          var _parts = part.getParts();

          _parts.some(function (part) {
            leftRecursiveRuleName = leftRecursiveRuleNameFromPart(part);

            if (leftRecursiveRuleName !== null) {
              return true;
            }
          });
        }
        break;
    }
  }

  return leftRecursiveRuleName;
}

module.exports = {
  isPartRecursive: isPartRecursive,
  ruleNamesFromPart: ruleNamesFromPart,
  isPartLeftRecursive: isPartLeftRecursive,
  leftRecursiveRuleNameFromPart: leftRecursiveRuleNameFromPart
};

// function ruleNamePartFromRuleName(ruleName, noWhitespace = false, lookAhead = false) {
//   const ruleNamePart = new RuleNamePart(ruleName, noWhitespace, lookAhead);
//
//   return ruleNamePart;
// }
//
// function optionalRuleNamePartPartFromRuleName(ruleName) {
//   const ruleNamePart = ruleNamePartFromRuleName(ruleName),
//       optionalRuleNamePartPart = new OptionalPartPart(ruleNamePart);
//
//   return optionalRuleNamePartPart;
// }
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2VzNi91dGlsaXRpZXMvcGFydC5qcyJdLCJuYW1lcyI6WyJwYXJzZXJzIiwicmVxdWlyZSIsImFycmF5VXRpbGl0aWVzIiwiZmlyc3QiLCJwYXJ0VHlwZXMiLCJSdWxlTmFtZVBhcnRUeXBlIiwiT3B0aW9uYWxQYXJ0UGFydFR5cGUiLCJHcm91cE9mUGFydHNQYXJ0VHlwZSIsIkNob2ljZU9mUGFydHNQYXJ0VHlwZSIsIk9uZU9yTW9yZVBhcnRzUGFydFR5cGUiLCJaZXJvT3JNb3JlUGFydHNQYXJ0VHlwZSIsImlzUGFydFJlY3Vyc2l2ZSIsInBhcnQiLCJydWxlTmFtZXMiLCJydWxlc05hbWVzRnJvbVBhcnQiLCJydWxlTmFtZXNMZW5ndGgiLCJsZW5ndGgiLCJwYXJ0UmVjdXJzaXZlIiwicnVsZU5hbWVzRnJvbVBhcnQiLCJwYXJ0Tm9uVGVybWluYWxQYXJ0IiwiaXNOb25UZXJtaW5hbFBhcnQiLCJ0eXBlIiwiZ2V0VHlwZSIsInJ1bGVOYW1lUGFydCIsInJ1bGVOYW1lIiwiZ2V0UnVsZU5hbWUiLCJydWxlTmFtZXNJbmNsdWRlc1J1bGVOYW1lIiwiaW5jbHVkZXMiLCJwdXNoIiwiZ2V0UGFydCIsInBhcnRzIiwiZ2V0UGFydHMiLCJzb21lIiwiaXNQYXJ0TGVmdFJlY3Vyc2l2ZSIsImxlZnRSZWN1cnNpdmVSdWxlTmFtZSIsImxlZnRSZWN1cnNpdmVSdWxlTmFtZUZyb21QYXJ0IiwicGFydExlZnRSZWN1cnNpdmUiLCJmaXJzdFBhcnQiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQSxJQUFNQSxVQUFVQyxRQUFRLGVBQVIsQ0FBaEI7O0FBRUEsSUFBTUMsaUJBQWlCRCxRQUFRLG9CQUFSLENBQXZCOztJQUVRRSxLLEdBQVVELGMsQ0FBVkMsSztBQUVGLElBQUVDLFNBQUYsR0FBZ0JKLE9BQWhCLENBQUVJLFNBQUY7QUFBQSxJQUNFQyxnQkFERixHQU04QkQsU0FOOUIsQ0FDRUMsZ0JBREY7QUFBQSxJQUVFQyxv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QU95QixTQUZiLENBRHdCLENBR0E7O0FBRXhCSCxrQ0FBd0JDLDhCQUE4QnZCLEtBQTlCLENBQXhCO0FBQ0Q7QUFDRDs7QUFFRixXQUFLSixxQkFBTDtBQUE2QjtBQUN6QixjQUFNc0IsU0FBUWxCLEtBQUttQixRQUFMLEVBQWQ7O0FBRUFELGlCQUFNRSxJQUFOLENBQVcsVUFBQ3BCLElBQUQsRUFBVTtBQUNuQnNCLG9DQUF3QkMsOEJBQThCdkIsSUFBOUIsQ0FBeEI7O0FBRUEsZ0JBQUlzQiwwQkFBMEIsSUFBOUIsRUFBb0M7QUFDbEMscUJBQU8sSUFBUDtBQUNEO0FBQ0YsV0FORDtBQU9EO0FBQ0Q7QUFwQ0o7QUFzQ0Q7O0FBRUQsU0FBT0EscUJBQVA7QUFDRDs7QUFFREksT0FBT0MsT0FBUCxHQUFpQjtBQUNmNUIsa0NBRGU7QUFFZk8sc0NBRmU7QUFHZmUsMENBSGU7QUFJZkU7QUFKZSxDQUFqQjs7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoicGFydC5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuY29uc3QgcGFyc2VycyA9IHJlcXVpcmUoJ29jY2FtLXBhcnNlcnMnKTtcblxuY29uc3QgYXJyYXlVdGlsaXRpZXMgPSByZXF1aXJlKCcuLi91dGlsaXRpZXMvYXJyYXknKTtcblxuY29uc3QgeyBmaXJzdCB9ID0gYXJyYXlVdGlsaXRpZXM7XG5cbmNvbnN0IHsgcGFydFR5cGVzIH0gPSBwYXJzZXJzLFxuICAgICAgeyBSdWxlTmFtZVBhcnRUeXBlLFxuICAgICAgICBPcHRpb25hbFBhcnRQYXJ0VHlwZSxcbiAgICAgICAgR3JvdXBPZlBhcnRzUGFydFR5cGUsXG4gICAgICAgIENob2ljZU9mUGFydHNQYXJ0VHlwZSxcbiAgICAgICAgT25lT3JNb3JlUGFydHNQYXJ0VHlwZSxcbiAgICAgICAgWmVyb09yTW9yZVBhcnRzUGFydFR5cGUgfSA9IHBhcnRUeXBlcztcblxuZnVuY3Rpb24gaXNQYXJ0UmVjdXJzaXZlKHBhcnQpIHtcbiAgY29uc3QgcnVsZU5hbWVzID0gcnVsZXNOYW1lc0Zyb21QYXJ0KHBhcnQpLFxuICAgICAgICBydWxlTmFtZXNMZW5ndGggPSBydWxlTmFtZXMubGVuZ3RoLFxuICAgICAgICBwYXJ0UmVjdXJzaXZlID0gKHJ1bGVOYW1lc0xlbmd0aCA+IDApO1xuXG4gIHJldHVybiBwYXJ0UmVjdXJzaXZlO1xufVxuXG5mdW5jdGlvbiBydWxlTmFtZXNGcm9tUGFydChwYXJ0LCBydWxlTmFtZXMgPSBbXSkge1xuICBsZXQgcGFydFJlY3Vyc2l2ZSA9IGZhbHNlO1xuXG4gIGNvbnN0IHBhcnROb25UZXJtaW5hbFBhcnQgPSBwYXJ0LmlzTm9uVGVybWluYWxQYXJ0KCk7XG5cbiAgaWYgKHBhcnROb25UZXJtaW5hbFBhcnQpIHtcbiAgICBjb25zdCB0eXBlID0gcGFydC5nZXRUeXBlKCk7XG5cbiAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgIGNhc2UgUnVsZU5hbWVQYXJ0VHlwZSA6XG4gICAgICAgIGNvbnN0IHJ1bGVOYW1lUGFydCA9IHBhcnQsICAvLy9cbiAgICAgICAgICAgICAgcnVsZU5hbWUgPSBydWxlTmFtZVBhcnQuZ2V0UnVsZU5hbWUoKSxcbiAgICAgICAgICAgICAgcnVsZU5hbWVzSW5jbHVkZXNSdWxlTmFtZSA9IHJ1bGVOYW1lcy5pbmNsdWRlcyhydWxlTmFtZSk7XG5cbiAgICAgICAgaWYgKCFydWxlTmFtZXNJbmNsdWRlc1J1bGVOYW1lKSB7XG4gICAgICAgICAgcnVsZU5hbWVzLnB1c2gocnVsZU5hbWUpO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIE9wdGlvbmFsUGFydFBhcnRUeXBlIDpcbiAgICAgIGNhc2UgT25lT3JNb3JlUGFydHNQYXJ0VHlwZSA6XG4gICAgICBjYXNlIFplcm9Pck1vcmVQYXJ0c1BhcnRUeXBlIDpcbiAgICAgICAgcGFydCA9IHBhcnQuZ2V0UGFydCgpOyAgLy8vXG5cbiAgICAgICAgcnVsZU5hbWVzRnJvbVBhcnQocGFydCwgcnVsZU5hbWVzKTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgR3JvdXBPZlBhcnRzUGFydFR5cGUgOlxuICAgICAgY2FzZSBDaG9pY2VPZlBhcnRzUGFydFR5cGUgOiB7XG4gICAgICAgICAgY29uc3QgcGFydHMgPSBwYXJ0LmdldFBhcnRzKCk7XG5cbiAgICAgICAgICBwYXJ0UmVjdXJzaXZlID0gcGFydHMuc29tZSgocGFydCkgPT4ge1xuICAgICAgICAgICAgcnVsZU5hbWVzRnJvbVBhcnQocGFydCwgcnVsZU5hbWVzKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuICByZXR1cm4gcGFydFJlY3Vyc2l2ZTtcbn1cblxuZnVuY3Rpb24gaXNQYXJ0TGVmdFJlY3Vyc2l2ZShwYXJ0KSB7XG4gIGNvbnN0IGxlZnRSZWN1cnNpdmVSdWxlTmFtZSA9IGxlZnRSZWN1cnNpdmVSdWxlTmFtZUZyb21QYXJ0KHBhcnQpLFxuICAgICAgICBwYXJ0TGVmdFJlY3Vyc2l2ZSA9IChsZWZ0UmVjdXJzaXZlUnVsZU5hbWUgIT09IG51bGwpO1xuXG4gIHJldHVybiBwYXJ0TGVmdFJlY3Vyc2l2ZTtcbn1cblxuZnVuY3Rpb24gbGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lRnJvbVBhcnQocGFydCkge1xuICBsZXQgbGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lID0gbnVsbDtcblxuICBjb25zdCBwYXJ0Tm9uVGVybWluYWxQYXJ0ID0gcGFydC5pc05vblRlcm1pbmFsUGFydCgpO1xuXG4gIGlmIChwYXJ0Tm9uVGVybWluYWxQYXJ0KSB7XG4gICAgY29uc3QgdHlwZSA9IHBhcnQuZ2V0VHlwZSgpO1xuXG4gICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICBjYXNlIFJ1bGVOYW1lUGFydFR5cGUgOlxuICAgICAgICBjb25zdCBydWxlTmFtZVBhcnQgPSBwYXJ0LCAgLy8vXG4gICAgICAgICAgICAgIHJ1bGVOYW1lID0gcnVsZU5hbWVQYXJ0LmdldFJ1bGVOYW1lKCk7XG5cbiAgICAgICAgbGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lID0gcnVsZU5hbWU7IC8vL1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSBPcHRpb25hbFBhcnRQYXJ0VHlwZSA6XG4gICAgICBjYXNlIE9uZU9yTW9yZVBhcnRzUGFydFR5cGUgOlxuICAgICAgY2FzZSBaZXJvT3JNb3JlUGFydHNQYXJ0VHlwZSA6XG4gICAgICAgIHBhcnQgPSBwYXJ0LmdldFBhcnQoKTsgIC8vL1xuXG4gICAgICAgIGxlZnRSZWN1cnNpdmVSdWxlTmFtZSA9IGxlZnRSZWN1cnNpdmVSdWxlTmFtZUZyb21QYXJ0KHBhcnQpO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSBHcm91cE9mUGFydHNQYXJ0VHlwZSA6IHtcbiAgICAgICAgICBjb25zdCBwYXJ0cyA9IHBhcnQuZ2V0UGFydHMoKSxcbiAgICAgICAgICAgICAgICBmaXJzdFBhcnQgPSBmaXJzdChwYXJ0cyksXG4gICAgICAgICAgICAgICAgcGFydCA9IGZpcnN0UGFydDsgLy8vXG5cbiAgICAgICAgICBsZWZ0UmVjdXJzaXZlUnVsZU5hbWUgPSBsZWZ0UmVjdXJzaXZlUnVsZU5hbWVGcm9tUGFydChwYXJ0KTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSBDaG9pY2VPZlBhcnRzUGFydFR5cGUgOiB7XG4gICAgICAgICAgY29uc3QgcGFydHMgPSBwYXJ0LmdldFBhcnRzKCk7XG5cbiAgICAgICAgICBwYXJ0cy5zb21lKChwYXJ0KSA9PiB7XG4gICAgICAgICAgICBsZWZ0UmVjdXJzaXZlUnVsZU5hbWUgPSBsZWZ0UmVjdXJzaXZlUnVsZU5hbWVGcm9tUGFydChwYXJ0KTtcblxuICAgICAgICAgICAgaWYgKGxlZnRSZWN1cnNpdmVSdWxlTmFtZSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuICByZXR1cm4gbGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgaXNQYXJ0UmVjdXJzaXZlLFxuICBydWxlTmFtZXNGcm9tUGFydCxcbiAgaXNQYXJ0TGVmdFJlY3Vyc2l2ZSxcbiAgbGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lRnJvbVBhcnRcbn07XG5cbi8vIGZ1bmN0aW9uIHJ1bGVOYW1lUGFydEZyb21SdWxlTmFtZShydWxlTmFtZSwgbm9XaGl0ZXNwYWNlID0gZmFsc2UsIGxvb2tBaGVhZCA9IGZhbHNlKSB7XG4vLyAgIGNvbnN0IHJ1bGVOYW1lUGFydCA9IG5ldyBSdWxlTmFtZVBhcnQocnVsZU5hbWUsIG5vV2hpdGVzcGFjZSwgbG9va0FoZWFkKTtcbi8vXG4vLyAgIHJldHVybiBydWxlTmFtZVBhcnQ7XG4vLyB9XG4vL1xuLy8gZnVuY3Rpb24gb3B0aW9uYWxSdWxlTmFtZVBhcnRQYXJ0RnJvbVJ1bGVOYW1lKHJ1bGVOYW1lKSB7XG4vLyAgIGNvbnN0IHJ1bGVOYW1lUGFydCA9IHJ1bGVOYW1lUGFydEZyb21SdWxlTmFtZShydWxlTmFtZSksXG4vLyAgICAgICBvcHRpb25hbFJ1bGVOYW1lUGFydFBhcnQgPSBuZXcgT3B0aW9uYWxQYXJ0UGFydChydWxlTmFtZVBhcnQpO1xuLy9cbi8vICAgcmV0dXJuIG9wdGlvbmFsUnVsZU5hbWVQYXJ0UGFydDtcbi8vIH1cbiJdfQ==