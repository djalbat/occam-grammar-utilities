'use strict';

var parsers = require('occam-parsers');

var arrayUtilities = require('../utilities/array');

var first = arrayUtilities.first;
var Parts = parsers.Parts,
    partTypes = parsers.partTypes,
    RuleNamePartType = partTypes.RuleNamePartType,
    OptionalPartPartType = partTypes.OptionalPartPartType,
    GroupOfPartsPartType = partTypes.GroupOfPartsPartType,
    ChoiceOfPartsPartType = partTypes.ChoiceOfPartsPartType,
    OneOrMorePartsPartType = partTypes.OneOrMorePartsPartType,
    ZeroOrMorePartsPartType = partTypes.ZeroOrMorePartsPartType,
    OptionalPartPart = Parts.OptionalPartPart,
    RuleNamePart = Parts.RuleNamePart;


function ruleNameFromPart(part) {
  var ruleName = null;

  var partRuleNamePart = isPartRuleNamePart(part);

  if (partRuleNamePart) {
    var ruleNamePart = part; ///

    ruleName = ruleNamePart.getRuleName();
  }

  return ruleName;
}

function isPartRuleNamePart(part) {
  var partRuleNamePart = false;

  var partNonTerminalPart = part.isNonTerminalPart();

  if (partNonTerminalPart) {
    var nonTerminalPart = part,
        ///
    type = nonTerminalPart.getType(),
        typeRuleNamePartType = type === RuleNamePartType,
        nonTerminalPartRuleNamePart = typeRuleNamePartType; ///

    partRuleNamePart = nonTerminalPartRuleNamePart; ///
  }

  return partRuleNamePart;
}

function isPartLeftRecursive(part) {
  var leftRecursiveRuleName = leftRecursiveRuleNameFromPart(part),
      partLeftRecursive = leftRecursiveRuleName !== null;

  return partLeftRecursive;
}

function leftRecursiveRuleNameFromPart(part) {
  var leftRecursiveRuleName = null;

  var partNonTerminalPart = part.isNonTerminalPart();

  if (partNonTerminalPart) {
    var type = part.getType();

    switch (type) {
      case RuleNamePartType:
        var ruleNamePart = part,
            ///
        ruleName = ruleNamePart.getRuleName();

        leftRecursiveRuleName = ruleName; ///
        break;

      case OptionalPartPartType:
      case OneOrMorePartsPartType:
      case ZeroOrMorePartsPartType:
        part = part.getPart(); ///

        leftRecursiveRuleName = leftRecursiveRuleNameFromPart(part);
        break;

      case GroupOfPartsPartType:
      case ChoiceOfPartsPartType:
        var parts = part.getParts(),
            firstPart = first(parts);

        part = firstPart; ///

        leftRecursiveRuleName = leftRecursiveRuleNameFromPart(part);
        break;
    }
  }

  return leftRecursiveRuleName;
}

function ruleNamePartFromRuleName(ruleName) {
  var noWhitespace = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
  var lookAhead = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;

  var ruleNamePart = new RuleNamePart(ruleName, noWhitespace, lookAhead);

  return ruleNamePart;
}

function optionalRuleNamePartPartFromRuleName(ruleName) {
  var ruleNamePart = ruleNamePartFromRuleName(ruleName),
      optionalRuleNamePartPart = new OptionalPartPart(ruleNamePart);

  return optionalRuleNamePartPart;
}

module.exports = {
  ruleNameFromPart: ruleNameFromPart,
  isPartRuleNamePart: isPartRuleNamePart,
  isPartLeftRecursive: isPartLeftRecursive,
  ruleNamePartFromRuleName: ruleNamePartFromRuleName,
  leftRecursiveRuleNameFromPart: leftRecursiveRuleNameFromPart,
  optionalRuleNamePartPartFromRuleName: optionalRuleNamePartPartFromRuleName
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2VzNi91dGlsaXRpZXMvcGFydC5qcyJdLCJuYW1lcyI6WyJwYXJzZXJzIiwicmVxdWlyZSIsImFycmF5VXRpbGl0aWVzIiwiZmlyc3QiLCJQYXJ0cyIsInBhcnRUeXBlcyIsIlJ1bGVOYW1lUGFydFR5cGUiLCJPcHRpb25hbFBhcnRQYXJ0VHlwZSIsIkdyb3VwT2ZQYXJ0c1BhcnRUeXBlIiwiQ2hvaWNlT2ZQYXJ0c1BhcnRUeXBlIiwiT25lT3JNb3JlUGFydHNQYXJ0VHlwZSIsIlplcm9Pck1vcmVQYXJ0c1BhcnRUeXBlIiwiT3B0aW9uYWxQYXJ0UGFydCIsIlJ1bGVOYW1lUGFydCIsInJ1bGVOYW1lRnJvbVBhcnQiLCJwYXJ0IiwicnVsZU5hbWUiLCJwYXJ0UnVsZU5hbWVQYXJ0IiwiaXNQYXJ0UnVsZU5hbWVQYXJ0IiwicnVsZU5hbWVQYXJ0IiwiZ2V0UnVsZU5hbWUiLCJwYXJ0Tm9uVGVybWluYWxQYXJ0IiwiaXNOb25UZXJtaW5hbFBhcnQiLCJub25UZXJtaW5hbFBhcnQiLCJ0eXBlIiwiZ2V0VHlwZSIsInR5cGVSdWxlTmFtZVBhcnRUeXBlIiwibm9uVGVybWluYWxQYXJ0UnVsZU5hbWVQYXJ0IiwiaXNQYXJ0TGVmdFJlY3Vyc2l2ZSIsImxlZnRSZWN1cnNpdmVSdWxlTmFtZSIsImxlZnRSZWN1cnNpdmVSdWxlTmFtZUZyb21QYXJ0IiwicGFydExlZnRSZWN1cnNpdmUiLCJnZXRQYXJ0IiwicGFydHMiLCJnZXRQYXJ0cyIsImZpcnN0UGFydCIsInJ1bGVOYW1lUGFydEZyb21SdWxlTmFtZSIsIm5vV2hpdGVzcGFjZSIsImxvb2tBaGVhZCIsIm9wdGlvbmFsUnVsZU5hbWVQYXJ0UGFydEZyb21SdWxlTmFtZSIsIm9wdGlvbmFsUnVsZU5hbWVQYXJ0UGFydCIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBLElBQU1BLFVBQVVDLFFBQVEsZUFBUixDQUFoQjs7QUFFQSxJQUFNQyxpQkFBaUJELFFBQVEsb0JBQVIsQ0FBdkI7O0lBRVFFLEssR0FBVUQsYyxDQUFWQyxLO0lBRUFDLEssR0FBcUJKLE8sQ0FBckJJLEs7SUFBT0MsUyxHQUFjTCxPLENBQWRLLFM7SUFDUEMsZ0IsR0FLNEJELFMsQ0FMNUJDLGdCO0lBQ0FDLG9CLEdBSTRCRixTLENBSjVCRSxvQjtJQUNBQyxvQixHQUc0QkgsUyxDQUg1Qkcsb0I7SUFDQUMscUIsR0FFNEJKLFMsQ0FGNUJJLHFCO0lBQ0FDLHNCLEdBQzRCTCxTLENBRDVCSyxzQjtJQUNBQyx1QixHQUE0Qk4sUyxDQUE1Qk0sdUI7SUFDQUMsZ0IsR0FBbUNSLEssQ0FBbkNRLGdCO0lBQWtCQyxZLEdBQWlCVCxLLENBQWpCUyxZOzs7QUFFMUIsU0FBU0MsZ0JBQVQsQ0FBMEJDLElBQTFCLEVBQWdDO0FBQzlCLE1BQUlDLFdBQVcsSUFBZjs7QUFFQSxNQUFNQyxtQkFBbUJDLG1CQUFtQkgsSUFBbkIsQ0FBekI7O0FBRUEsTUFBSUUsZ0JBQUosRUFBc0I7QUFDcEIsUUFBTUUsZUFBZUosSUFBckIsQ0FEb0IsQ0FDUTs7QUFFNUJDLGVBQVdHLGFBQWFDLFdBQWIsRUFBWDtBQUNEOztBQUVELFNBQU9KLFFBQVA7QUFDRDs7QUFFRCxTQUFTRSxrQkFBVCxDQUE0QkgsSUFBNUIsRUFBa0M7QUFDaEMsTUFBSUUsbUJBQW1CLEtBQXZCOztBQUVBLE1BQU1JLHNCQUFzQk4sS0FBS08saUJBQUwsRUFBNUI7O0FBRUEsTUFBSUQsbUJBQUosRUFBeUI7QUFDdkIsUUFBTUUsa0JBQWtCUixJQUF4QjtBQUFBLFFBQStCO0FBQ3pCUyxXQUFPRCxnQkFBZ0JFLE9BQWhCLEVBRGI7QUFBQSxRQUVNQyx1QkFBd0JGLFNBQVNsQixnQkFGdkM7QUFBQSxRQUdNcUIsOEJBQThCRCxvQkFIcEMsQ0FEdUIsQ0FJb0M7O0FBRTNEVCx1QkFBbUJVLDJCQUFuQixDQU51QixDQU0wQjtBQUNsRDs7QUFFRCxTQUFPVixnQkFBUDtBQUNEOztBQUVELFNBQVNXLG1CQUFULENBQTZCYixJQUE3QixFQUFtQztBQUNqQyxNQUFNYyx3QkFBd0JDLDhCQUE4QmYsSUFBOUIsQ0FBOUI7QUFBQSxNQUNNZ0Isb0JBQXFCRiwwQkFBMEIsSUFEckQ7O0FBR0EsU0FBT0UsaUJBQVA7QUFDRDs7QUFFRCxTQUFTRCw2QkFBVCxDQUF1Q2YsSUFBdkMsRUFBNkM7QUFDM0MsTUFBSWMsd0JBQXdCLElBQTVCOztBQUVBLE1BQU1SLHNCQUFzQk4sS0FBS08saUJBQUwsRUFBNUI7O0FBRUEsTUFBSUQsbUJBQUosRUFBeUI7QUFDdkIsUUFBTUcsT0FBT1QsS0FBS1UsT0FBTCxFQUFiOztBQUVBLFlBQVFELElBQVI7QUFDRSxXQUFLbEIsZ0JBQUw7QUFDRSxZQUFNYSxlQUFlSixJQUFyQjtBQUFBLFlBQTRCO0FBQ3RCQyxtQkFBV0csYUFBYUMsV0FBYixFQURqQjs7QUFHQVMsZ0NBQXdCYixRQUF4QixDQUpGLENBSW9DO0FBQ2xDOztBQUVGLFdBQUtULG9CQUFMO0FBQ0EsV0FBS0csc0JBQUw7QUFDQSxXQUFLQyx1QkFBTDtBQUNFSSxlQUFPQSxLQUFLaUIsT0FBTCxFQUFQLENBREYsQ0FDMEI7O0FBRXhCSCxnQ0FBd0JDLDhCQUE4QmYsSUFBOUIsQ0FBeEI7QUFDQTs7QUFFRixXQUFLUCxvQkFBTDtBQUNBLFdBQUtDLHFCQUFMO0FBQ0UsWUFBTXdCLFFBQVFsQixLQUFLbUIsUUFBTCxFQUFkO0FBQUEsWUFDTUMsWUFBWWhDLE1BQU04QixLQUFOLENBRGxCOztBQUdBbEIsZUFBT29CLFNBQVAsQ0FKRixDQUlvQjs7QUFFbEJOLGdDQUF3QkMsOEJBQThCZixJQUE5QixDQUF4QjtBQUNBO0FBeEJKO0FBMEJEOztBQUVELFNBQU9jLHFCQUFQO0FBQ0Q7O0FBRUQsU0FBU08sd0JBQVQsQ0FBa0NwQixRQUFsQyxFQUFxRjtBQUFBLE1BQXpDcUIsWUFBeUMsdUVBQTFCLEtBQTBCO0FBQUEsTUFBbkJDLFNBQW1CLHVFQUFQLEtBQU87O0FBQ25GLE1BQU1uQixlQUFlLElBQUlOLFlBQUosQ0FBaUJHLFFBQWpCLEVBQTJCcUIsWUFBM0IsRUFBeUNDLFNBQXpDLENBQXJCOztBQUVBLFNBQU9uQixZQUFQO0FBQ0Q7O0FBRUQsU0FBU29CLG9DQUFULENBQThDdkIsUUFBOUMsRUFBd0Q7QUFDdEQsTUFBTUcsZUFBZWlCLHlCQUF5QnBCLFFBQXpCLENBQXJCO0FBQUEsTUFDTXdCLDJCQUEyQixJQUFJNUIsZ0JBQUosQ0FBcUJPLFlBQXJCLENBRGpDOztBQUdBLFNBQU9xQix3QkFBUDtBQUNEOztBQUVEQyxPQUFPQyxPQUFQLEdBQWlCO0FBQ2Y1QixvQ0FEZTtBQUVmSSx3Q0FGZTtBQUdmVSwwQ0FIZTtBQUlmUSxvREFKZTtBQUtmTiw4REFMZTtBQU1mUztBQU5lLENBQWpCIiwiZmlsZSI6InBhcnQuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbmNvbnN0IHBhcnNlcnMgPSByZXF1aXJlKCdvY2NhbS1wYXJzZXJzJyk7XG5cbmNvbnN0IGFycmF5VXRpbGl0aWVzID0gcmVxdWlyZSgnLi4vdXRpbGl0aWVzL2FycmF5Jyk7XG5cbmNvbnN0IHsgZmlyc3QgfSA9IGFycmF5VXRpbGl0aWVzO1xuXG5jb25zdCB7IFBhcnRzLCBwYXJ0VHlwZXMgfSA9IHBhcnNlcnMsXG4gICAgICB7IFJ1bGVOYW1lUGFydFR5cGUsXG4gICAgICAgIE9wdGlvbmFsUGFydFBhcnRUeXBlLFxuICAgICAgICBHcm91cE9mUGFydHNQYXJ0VHlwZSxcbiAgICAgICAgQ2hvaWNlT2ZQYXJ0c1BhcnRUeXBlLFxuICAgICAgICBPbmVPck1vcmVQYXJ0c1BhcnRUeXBlLFxuICAgICAgICBaZXJvT3JNb3JlUGFydHNQYXJ0VHlwZSB9ID0gcGFydFR5cGVzLFxuICAgICAgeyBPcHRpb25hbFBhcnRQYXJ0LCBSdWxlTmFtZVBhcnQgfSA9IFBhcnRzO1xuXG5mdW5jdGlvbiBydWxlTmFtZUZyb21QYXJ0KHBhcnQpIHtcbiAgbGV0IHJ1bGVOYW1lID0gbnVsbDtcblxuICBjb25zdCBwYXJ0UnVsZU5hbWVQYXJ0ID0gaXNQYXJ0UnVsZU5hbWVQYXJ0KHBhcnQpO1xuXG4gIGlmIChwYXJ0UnVsZU5hbWVQYXJ0KSB7XG4gICAgY29uc3QgcnVsZU5hbWVQYXJ0ID0gcGFydDsgIC8vL1xuXG4gICAgcnVsZU5hbWUgPSBydWxlTmFtZVBhcnQuZ2V0UnVsZU5hbWUoKTtcbiAgfVxuXG4gIHJldHVybiBydWxlTmFtZTtcbn1cblxuZnVuY3Rpb24gaXNQYXJ0UnVsZU5hbWVQYXJ0KHBhcnQpIHtcbiAgbGV0IHBhcnRSdWxlTmFtZVBhcnQgPSBmYWxzZTtcblxuICBjb25zdCBwYXJ0Tm9uVGVybWluYWxQYXJ0ID0gcGFydC5pc05vblRlcm1pbmFsUGFydCgpO1xuXG4gIGlmIChwYXJ0Tm9uVGVybWluYWxQYXJ0KSB7XG4gICAgY29uc3Qgbm9uVGVybWluYWxQYXJ0ID0gcGFydCwgIC8vL1xuICAgICAgICAgIHR5cGUgPSBub25UZXJtaW5hbFBhcnQuZ2V0VHlwZSgpLFxuICAgICAgICAgIHR5cGVSdWxlTmFtZVBhcnRUeXBlID0gKHR5cGUgPT09IFJ1bGVOYW1lUGFydFR5cGUpLFxuICAgICAgICAgIG5vblRlcm1pbmFsUGFydFJ1bGVOYW1lUGFydCA9IHR5cGVSdWxlTmFtZVBhcnRUeXBlOyAgLy8vXG5cbiAgICBwYXJ0UnVsZU5hbWVQYXJ0ID0gbm9uVGVybWluYWxQYXJ0UnVsZU5hbWVQYXJ0OyAgLy8vXG4gIH1cblxuICByZXR1cm4gcGFydFJ1bGVOYW1lUGFydDtcbn1cblxuZnVuY3Rpb24gaXNQYXJ0TGVmdFJlY3Vyc2l2ZShwYXJ0KSB7XG4gIGNvbnN0IGxlZnRSZWN1cnNpdmVSdWxlTmFtZSA9IGxlZnRSZWN1cnNpdmVSdWxlTmFtZUZyb21QYXJ0KHBhcnQpLFxuICAgICAgICBwYXJ0TGVmdFJlY3Vyc2l2ZSA9IChsZWZ0UmVjdXJzaXZlUnVsZU5hbWUgIT09IG51bGwpO1xuXG4gIHJldHVybiBwYXJ0TGVmdFJlY3Vyc2l2ZTtcbn1cblxuZnVuY3Rpb24gbGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lRnJvbVBhcnQocGFydCkge1xuICBsZXQgbGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lID0gbnVsbDtcblxuICBjb25zdCBwYXJ0Tm9uVGVybWluYWxQYXJ0ID0gcGFydC5pc05vblRlcm1pbmFsUGFydCgpO1xuXG4gIGlmIChwYXJ0Tm9uVGVybWluYWxQYXJ0KSB7XG4gICAgY29uc3QgdHlwZSA9IHBhcnQuZ2V0VHlwZSgpO1xuXG4gICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICBjYXNlIFJ1bGVOYW1lUGFydFR5cGUgOlxuICAgICAgICBjb25zdCBydWxlTmFtZVBhcnQgPSBwYXJ0LCAgLy8vXG4gICAgICAgICAgICAgIHJ1bGVOYW1lID0gcnVsZU5hbWVQYXJ0LmdldFJ1bGVOYW1lKCk7XG5cbiAgICAgICAgbGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lID0gcnVsZU5hbWU7IC8vL1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSBPcHRpb25hbFBhcnRQYXJ0VHlwZSA6XG4gICAgICBjYXNlIE9uZU9yTW9yZVBhcnRzUGFydFR5cGUgOlxuICAgICAgY2FzZSBaZXJvT3JNb3JlUGFydHNQYXJ0VHlwZSA6XG4gICAgICAgIHBhcnQgPSBwYXJ0LmdldFBhcnQoKTsgIC8vL1xuXG4gICAgICAgIGxlZnRSZWN1cnNpdmVSdWxlTmFtZSA9IGxlZnRSZWN1cnNpdmVSdWxlTmFtZUZyb21QYXJ0KHBhcnQpO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSBHcm91cE9mUGFydHNQYXJ0VHlwZSA6XG4gICAgICBjYXNlIENob2ljZU9mUGFydHNQYXJ0VHlwZSA6XG4gICAgICAgIGNvbnN0IHBhcnRzID0gcGFydC5nZXRQYXJ0cygpLFxuICAgICAgICAgICAgICBmaXJzdFBhcnQgPSBmaXJzdChwYXJ0cyk7XG5cbiAgICAgICAgcGFydCA9IGZpcnN0UGFydDsgLy8vXG5cbiAgICAgICAgbGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lID0gbGVmdFJlY3Vyc2l2ZVJ1bGVOYW1lRnJvbVBhcnQocGFydCk7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBsZWZ0UmVjdXJzaXZlUnVsZU5hbWU7XG59XG5cbmZ1bmN0aW9uIHJ1bGVOYW1lUGFydEZyb21SdWxlTmFtZShydWxlTmFtZSwgbm9XaGl0ZXNwYWNlID0gZmFsc2UsIGxvb2tBaGVhZCA9IGZhbHNlKSB7XG4gIGNvbnN0IHJ1bGVOYW1lUGFydCA9IG5ldyBSdWxlTmFtZVBhcnQocnVsZU5hbWUsIG5vV2hpdGVzcGFjZSwgbG9va0FoZWFkKTtcblxuICByZXR1cm4gcnVsZU5hbWVQYXJ0O1xufVxuXG5mdW5jdGlvbiBvcHRpb25hbFJ1bGVOYW1lUGFydFBhcnRGcm9tUnVsZU5hbWUocnVsZU5hbWUpIHtcbiAgY29uc3QgcnVsZU5hbWVQYXJ0ID0gcnVsZU5hbWVQYXJ0RnJvbVJ1bGVOYW1lKHJ1bGVOYW1lKSxcbiAgICAgICAgb3B0aW9uYWxSdWxlTmFtZVBhcnRQYXJ0ID0gbmV3IE9wdGlvbmFsUGFydFBhcnQocnVsZU5hbWVQYXJ0KTtcblxuICByZXR1cm4gb3B0aW9uYWxSdWxlTmFtZVBhcnRQYXJ0O1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgcnVsZU5hbWVGcm9tUGFydCxcbiAgaXNQYXJ0UnVsZU5hbWVQYXJ0LFxuICBpc1BhcnRMZWZ0UmVjdXJzaXZlLFxuICBydWxlTmFtZVBhcnRGcm9tUnVsZU5hbWUsXG4gIGxlZnRSZWN1cnNpdmVSdWxlTmFtZUZyb21QYXJ0LFxuICBvcHRpb25hbFJ1bGVOYW1lUGFydFBhcnRGcm9tUnVsZU5hbWVcbn07XG4iXX0=